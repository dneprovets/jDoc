!function(a,b){!function(a,c){"use strict";var d,e,f=(c.userAgent||"").toLowerCase(),g={msie:(/(?:msie\s([0-9a-z,.]+);)/.exec(f)||[])[1]||"",opera:(/(?:version\/([0-9a-z,.]+))$/.exec(f)||[])[1]||"",chrome:(/(?:chrome\/([0-9a-z,.]+)\s)/.exec(f)||[])[1]||"",firefox:(/(?:firefox\/([0-9a-z,.]+))$/.exec(f)||[])[1]||"",safari:(/(?:version\/([0-9a-z,.]+)\s)/.exec(f)||[])[1]||""};for(d in g)g.hasOwnProperty(d)&&(e=g[d].replace(/[^0-9\.,]/,"").split(/[\.,]/),g[d]=+(e.shift()+"."+e.join(""))||0);a.browser={language:(c.systemLanguage||c.language.split("-")[0]).toLowerCase(),localStorage:a.localStorage||a.mozLocalStorage||a.webkitLocalStorage,requestFileSystem:a.requestFileSystem||a.webkitRequestFileSystem||a.mozRequestFileSystem,URL:a.URL||a.webkitURL||a.mozURL,Blob:a.Blob,isSupportHistoryAPI:function(){return!(!a.history.pushState||!a.history.replaceState)},setFieldsType:function(a){a=a||b;var c,d,e=a.getElementsByTagName("input"),f=e?e.length:0;for(d=f-1;d>=0;d--)c=e[d].attributes["data-type"],c&&c.value&&("number"==c.value&&this.isIOSDevice()?e[d].pattern="[0-9]*":e[d].type=c.value);return a},isIPhone:function(){return f.indexOf("iphone")>-1},isIPad:function(){return f.indexOf("ipad")>-1},isIPod:function(){return f.indexOf("ipod")>-1},isIPadWebView:function(){return f.indexOf("applewebkit")>-1&&f.indexOf("mobile")>-1},isIOSDevice:function(){return this.isIPad()||this.isIPod()||this.isIPhone()||this.isIPadWebView()},isAndroidDevice:function(){return f.indexOf("android")>-1},isWindowsMobileDevice:function(){return f.indexOf("windows phone")>-1},isMobileDevice:function(){return this.isIOSDevice()||this.isAndroidDevice()||this.isWindowsMobileDevice()},isOpera:function(){return f.indexOf("opera")>-1},isChrome:function(){return f.indexOf("chrome")>-1},isFireFox:function(){return f.indexOf("firefox")>-1},isMSIE:function(){return f.indexOf("msie")>-1},isSafari:function(){return f.indexOf("safari")>-1}}}(a,a.navigator);var c=Array.prototype,d={Engines:{},currentEngine:null,_errors:{invalidReadFirstArgument:{message:"First argument must be type of File"},invalidFileType:{message:"Invalid file type"},invalidLoadFile:{message:"Can't load the file"},requiredTechnologies:{message:"Not have the required technology"}},_validators:{email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},validateEmail:function(a){return this._validators.email.test(a)},validateURL:function(a){return this._validators.url.test(a)},_supportedFormats:["docx","txt","fb2","odt","csv","tsv"],read:function(a,b){return"object"!=typeof b&&(b={}),"function"==typeof b.start&&b.start(),this.testRequiredTechnologies()?(a instanceof File?this._selectEngine(a,b):("function"==typeof b.error&&b.error(this._errors.invalidReadFirstArgument),"function"==typeof b.complete&&b.complete()),void 0):("function"==typeof b.error&&b.error(this._errors.requiredTechnologies),void 0)},_selectEngine:function(a,b){var c,d;this.currentEngine=null;for(c in this.Engines)if(this.Engines.hasOwnProperty(c)&&(d=new this.Engines[c](a),d.validate())){this.currentEngine=d;break}null===this.currentEngine?("function"==typeof b.error&&b.error(this._errors.invalidFileType),"function"==typeof b.complete&&b.complete()):this.currentEngine.parse({success:function(a){"function"==typeof b.success&&b.success(a)},error:function(a){"function"==typeof b.error&&b.error(a)},complete:function(){"function"==typeof b.complete&&b.complete()}})},getSupportedFormats:function(){return this._supportedFormats},testRequiredTechnologies:function(){var b=a;return!!(b.browser.localStorage&&b.browser.Blob&&b.FileReader&&b.Worker&&b.ArrayBuffer&&b.Uint8Array&&b.DataView&&b.browser.Blob.prototype.slice&&b.browser.URL)},getFileMimeType:function(a){var b=/[A-Za-z]+$/.exec(a),c="";if(b=b?b[0].toLowerCase():null)switch(b){case"png":c="image/png";break;case"jpg":case"jpeg":c="image/jpeg";break;case"gif":c="image/gif"}return c}};d.ParsedFile=function(a){a=a||{},this._data.pages=a.pages||this._data.pages,this._clonedData=d.clone(this._data)},d.ParsedFile.prototype={_data:{pages:[]},options:{language:"",isTextDocument:!1,wordsCount:0,name:"",zoom:100},isTextDocument:function(){return!!this.options.isTextDocument},getLanguage:function(){return this.options.language||""},getWordsCount:function(){return this.options.wordsCount},getName:function(){return this.options.name||""},getZoom:function(){return this.options.zoom||100},_htmlOptions:{},_setHTMLOptions:function(a){this._htmlOptions=d.deepMerge({},a,{units:{font:"px",border:"px",margin:"px",padding:"px",base:"px"}})},_applyCSS:function(a,b,c){var e,f;c=c||{};for(e in b.css)a.style[e]=b.css[e];for(e in b.dimensionCSSRules)f=this._htmlOptions.units.base,"lineHeight"==e||e.indexOf("font")>=0?f=this._htmlOptions.units.font:e.indexOf("border")>=0?f=this._htmlOptions.units.border:e.indexOf("margin")>=0?f=this._htmlOptions.units.margin:e.indexOf("padding")>=0&&(f=this._htmlOptions.units.padding),a.style[e]=d._unitSizeConverter({from:b.dimensionCSSRules[e].units,to:f,value:b.dimensionCSSRules[e].value})+f},_addAttributes:function(a,b,c){var d;c=c||{};for(d in b.attributes)a.setAttribute(d,b.attributes[d])},_addProperties:function(a,b,c){var d;c=c||{};for(d in b.properties)a[d]=b.properties[d]},_buildTablePart:function(a,c){var d,e,f,g,h,i,j,k,l=a.rows.length,m="tbody",n="tr",o="td";for(c=c||{},c.isHeader?(m="thead",o="th"):c.isFooter&&(m="tfoot"),d=b.createElement(m),this._applyCSS(d,a),this._addAttributes(d,a),this._addProperties(d,a),e=0;l>e;e++){for(j=b.createElement(n),this._applyCSS(j,a.rows[e]),this._addAttributes(j,a.rows[e]),this._addProperties(j,a.rows[e]),i=a.rows[e].cells.length,f=0;i>f;f++){for(k=b.createElement(o),this._applyCSS(k,a.rows[e].cells[f]),this._addAttributes(k,a.rows[e].cells[f]),this._addProperties(k,a.rows[e].cells[f]),h=a.rows[e].cells[f].elements.length,g=0;h>g;g++)k.appendChild(this._buildElement(a.rows[e].cells[f].elements[g]));j.appendChild(k)}d.appendChild(j)}return d},_buildTable:function(a){var c=b.createElement("table");return this._applyCSS(c,a),this._addAttributes(c,a),this._addProperties(c,a),a.header&&c.appendChild(this._buildTablePart(a.header,{isHeader:!0})),a.footer&&c.appendChild(this._buildTablePart(a.footer,{isFooter:!0})),a.body&&c.appendChild(this._buildTablePart(a.body)),c},_buildParagraph:function(a){var c,d=b.createElement("p"),e=a.elements.length;for(this._applyCSS(d,a),this._addAttributes(d,a),this._addProperties(d,a),c=0;e>c;c++)d.appendChild(this._buildElement(a.elements[c]));return d},_buildImage:function(a){var c=b.createElement("img");return this._applyCSS(c,a),this._addAttributes(c,a),this._addProperties(c,a),c},_buildEmptyLine:function(a){var c=b.createElement("br");return this._applyCSS(c,a),this._addAttributes(c,a),this._addProperties(c,a),c},_buildList:function(a){var c,d,e,f,g=b.createElement("ul"),h=a.items.length;for(this._applyCSS(g,a),this._addAttributes(g,a),this._addProperties(g,a),d=0;h>d;d++){for(c=b.createElement("li"),this._applyCSS(c,a.items[d]),this._addAttributes(c,a.items[d]),this._addProperties(c,a.items[d]),f=a.items[d].elements.length,e=0;f>e;e++)c.appendChild(this._buildElement(a.items[d].elements[e]));g.appendChild(c)}return g},_buildLink:function(a){var c,d=b.createElement("a"),e=a.elements?a.elements.length:0;for(this._applyCSS(d,a),this._addAttributes(d,a),this._addProperties(d,a),c=0;e>c;c++)d.appendChild(this._buildElement(a.elements[c]));return d},_buildSchema:function(a){var c,d,e,f,g=b.createElement("div"),h=a.parts.length;for(this._applyCSS(g,a),this._addAttributes(g,a),this._addProperties(g,a),d=0;h>d;d++){for(f=b.createElement("div"),this._applyCSS(f,a.parts[d]),this._addAttributes(f,a.parts[d]),this._addProperties(f,a.parts[d]),c=a.parts[d].elements.length,e=0;c>e;e++)f.appendChild(this._buildElement(a.parts[d].elements[e]));g.appendChild(f)}return g},_buildElement:function(a){var c,d,e;if(a.options.isParagraph)return this._buildParagraph(a);if(a.options.isTable)return this._buildTable(a);if(a.options.isList)return this._buildList(a);if(a.options.isImage)return this._buildImage(a);if(a.options.isEmptyLine)return this._buildEmptyLine(a);if(a.options.isSchema)return this._buildSchema(a);if(a.options.isLink)return this._buildLink(a);if(a.elements)for(c=b.createElement("div"),e=a.elements.length,d=0;e>d;d++)c.appendChild(this._buildElement(a.elements[d]));else c=b.createElement("span");return this._applyCSS(c,a),this._addAttributes(c,a),this._addProperties(c,a),c},_buildPageNumber:function(a,c){var e=b.createElement("div");return a.style.position="relative",e.style.position="absolute",e.style.top=c.options.header.dimensionCSSRules.height?d._unitSizeConverter({from:c.options.header.dimensionCSSRules.height.units,to:this._htmlOptions.units.base,value:c.options.header.dimensionCSSRules.height.value})+this._htmlOptions.units.base:0,e.style.right=a.style.paddingRight||0,e.appendChild(b.createTextNode(c.options.pageNumber.value)),a.appendChild(e),a},html:function(a){var c,e,f,g,h=b.createDocumentFragment(),i=this._data.pages,j=i.length;for(this._setHTMLOptions(a),e=0;j>e;e++){for(g=b.createElement("div"),j-1>e&&!i[e].dimensionCSSRules.marginBottom&&(i[e].dimensionCSSRules.marginBottom={units:"px",value:10}),this._applyCSS(g,i[e]),this._addAttributes(g,i[e]),this._addProperties(g,i[e]),d.DOM.css(g,"box-sizing","border-box"),i[e].options.pageNumber&&this._buildPageNumber(g,i[e]),c=i[e].elements.length,f=0;c>f;f++)g.appendChild(this._buildElement(i[e].elements[f]));h.appendChild(g)}return h},data:function(){return this._clonedData},getPage:function(a){return this._clonedData.pages[a]}},d._unitSizeConversations={pt:{px:function(a){var b=0;return isNaN(a)||(b=Math.round(a/.75),a>0&&0==b&&(b=1)),b}},cm:{px:function(a){var b=0;return isNaN(a)||(b=Math.round(a/.0265),a>0&&0==b&&(b=1)),b}},mm:{px:function(a){var b=0;return isNaN(a)||(b=Math.round(1.7*a/4),a>0&&0==b&&(b=1)),b}},"in":{px:function(a){var b=0;return isNaN(a)||(b=Math.round(96*a),a>0&&0==b&&(b=1)),b}},pc:{px:function(a){var b=0;return isNaN(a)||(b=Math.round(6*a),a>0&&0==b&&(b=1)),b}}},d._unitSizeConverter=function(a){var b=0;return a=a||{},a.value&&a.from&&a.to&&(a.from=a.from.toLowerCase(),a.to=a.to.toLowerCase(),a.from==a.to?b=a.value:this._unitSizeConversations[a.from]&&this._unitSizeConversations[a.from][a.to]&&(b=this._unitSizeConversations[a.from][a.to](a.value))),b},d.Binary=function(a){this.blob=a,this.size=a.size||0},d.Binary.prototype={_blobSlice:function(a,b,c){return a.slice(b,b+c)},getDataHelper:function(a,b){var c,d;return c=new ArrayBuffer(a),d=new Uint8Array(c),b&&d.set(b,0),{buffer:c,array:d,view:new DataView(c)}},uintArrayToHex:function(a){var b,c,d="",e=a.length;for(c=0;e>c;c++)b=a[c].toString(16),d+=b.length<2?"0"+b:b;return d.toUpperCase()},readUint8Array:function(a){var b=new FileReader;b.onload=function(b){a.success(new Uint8Array(b.target.result))},b.onerror=a.onerror,b.readAsArrayBuffer(this._blobSlice(this.blob,a.index,a.length))},reverseUintArray:function(a){var b;return b=a instanceof Uint16Array?this.getUint16Array(a.length):a instanceof Uint32Array?this.getUint32Array(a.length):this.getUint8Array(a.length),b.set(Array.prototype.reverse.call(a),0),b},getUint8Array:function(a){return new Uint8Array(new ArrayBuffer(a))},getUint16Array:function(a){return new Uint16Array(new ArrayBuffer(a))},getUint32Array:function(a){return new Uint32Array(new ArrayBuffer(a))},excludeUintArray:function(a){var b,c,d=[],e=a.index+a.length;for(b=a.data instanceof Uint16Array?this.getUint16Array(a.length):a.data instanceof Uint32Array?this.getUint32Array(a.length):this.getUint8Array(a.length),e=a.index+a.length,c=a.index;e>c;c++)d.push(a.data[c]);return b.set(d,0),b},ord:function(a){a=String(a);var b=a.charCodeAt(0);if(b>=55296&&56319>=b){if(1===a.length)return b;var c=a.charCodeAt(1);return 1024*(b-55296)+(c-56320)+65536}return b>=56320&&57343>=b?b:b},findPosition:function(a){var b=this.excludeUintArray({data:a.data,index:a.offset||0,length:a.data.length});return Array.prototype.indexOf.call(b,a.needle)},uintArraySplit:function(a){var b,c=[],d=0,e=a.data.length,f=Math.ceil(a.data.length/(a.length||1));for(b=f-1;b>=0;b--)c[b]=this.excludeUintArray({data:a.data,index:d,length:(a.length>e-a.length*b?e-a.length*b:a.length)-d}),d+=a.length;return c}},d.clone=function(a){return this.deepMerge({},a)},d.deepMerge=function(a){var b,d,e,f=c.slice.call(arguments,1),g=f.length;for(a=a||{},d=0;g>d;d++)for(b in f[d])f[d].hasOwnProperty(b)&&(e=f[d][b],a[b]=e instanceof Array?e.slice(0):null!=e&&"object"==typeof e?this.deepMerge({},a[b],e):e);return a},function(a,b){function c(){if("undefined"==typeof F){var a;a=new N([f(0).view]),F=0==a.size}return F}function d(){var a=-1,b=this;b.append=function(c){var d,e=b.table;for(d=0;d<c.length;d++)a=a>>>8^e[255&(a^c[d])]},b.get=function(){return~a}}function e(a,b,c){return a.slice(b,b+c)}function f(a,b){var c,d;return c=new ArrayBuffer(a),d=new Uint8Array(c),b&&d.set(b,0),{buffer:c,array:d,view:new DataView(c)}}function g(){}function h(a){function b(b){this.size=a.size,b()}function c(b,c,d,f){var g=new FileReader;g.onload=function(a){d(new Uint8Array(a.target.result))},g.onerror=f,g.readAsArrayBuffer(e(a,b,c))}var d=this;d.size=0,d.init=b,d.readUint8Array=c}function i(){}function j(a){function b(a){a()}function d(b,d){f=new N([c()?b:b.buffer],{type:a}),d()}function e(a){a(f)}var f,g=this;g.init=b,g.writeUint8Array=d,g.getData=e}function k(a,b,c,d,e,f,g,h,i,j){function k(){var o;l=m*M,e>l?b.readUint8Array(d+l,Math.min(M,e-l),function(b){var h=a.append(b,function(){g&&g(d+l,e)});n+=h.length,f(!0,b),c.writeUint8Array(h,function(){f(!1,h),m++,setTimeout(k,1)},j),g&&g(l,e)},i):(o=a.flush(),o?(n+=o.length,c.writeUint8Array(o,function(){f(!1,o),h(n)},j)):h(n))}var l,m=0,n=0;k()}function l(a,c,e,f,g,h,i,j,l){function m(a,b){g&&!a&&o.append(b)}function n(a){h(a,o.get())}var o=new d;return k(new b.zip.Inflater,a,c,e,f,m,i,n,j,l),null}function m(a,b,c,e,f,g,h,i,j){function k(){var d=l*M;e>d?a.readUint8Array(c+d,Math.min(M,e-d),function(a){f&&m.append(a),h&&h(d,e,a),b.writeUint8Array(a,function(){l++,k()},j)},i):g(e,m.get())}var l=0,m=new d;k()}function n(a){var b,c,d="",e=["Ç","ü","é","â","ä","à","å","ç","ê","ë","è","ï","î","ì","Ä","Å","É","æ","Æ","ô","ö","ò","û","ù","ÿ","Ö","Ü","ø","£","Ø","×","ƒ","á","í","ó","ú","ñ","Ñ","ª","º","¿","®","¬","½","¼","¡","«","»","_","_","_","¦","¦","Á","Â","À","©","¦","¦","+","+","¢","¥","+","+","-","-","+","-","+","ã","Ã","+","+","-","-","¦","-","+","¤","ð","Ð","Ê","Ë","È","i","Í","Î","Ï","+","+","_","_","¦","Ì","_","Ó","ß","Ô","Ò","õ","Õ","µ","þ","Þ","Ú","Û","Ù","ý","Ý","¯","´","­","±","_","¾","¶","§","÷","¸","°","¨","·","¹","³","²","_"," "];for(b=0;b<a.length;b++)c=255&a.charCodeAt(b),d+=c>127?e[c-128]:String.fromCharCode(c);return d}function o(a){var b=[],c=0,d=0,e=0,f=0,g=0;for(a+="";c<a.length;)e=a.charCodeAt(c),128>e?(b[d++]=String.fromCharCode(e),c++):e>191&&224>e?(f=a.charCodeAt(c+1),b[d++]=String.fromCharCode((31&e)<<6|63&f),c+=2):(f=a.charCodeAt(c+1),g=a.charCodeAt(c+2),b[d++]=String.fromCharCode((15&e)<<12|(63&f)<<6|63&g),c+=3);return b.join("")}function p(a){var b,c="";for(b=0;b<a.length;b++)c+=String.fromCharCode(a[b]);return c}function q(a){var b=(4294901760&a)>>16,c=65535&a;try{return new Date(1980+((65024&b)>>9),((480&b)>>5)-1,31&b,(63488&c)>>11,(2016&c)>>5,2*(31&c),0)}catch(d){}return b}function r(a,b,c,d){return a.version=b.view.getUint16(c,!0),a.bitFlag=b.view.getUint16(c+2,!0),a.compressionMethod=b.view.getUint16(c+4,!0),a.lastModDateRaw=b.view.getUint32(c+6,!0),a.lastModDate=q(a.lastModDateRaw),1===(1&a.bitFlag)?(onerror(H),void 0):((d||8!=(8&a.bitFlag))&&(a.crc32=b.view.getUint32(c+10,!0),a.compressedSize=b.view.getUint32(c+14,!0),a.uncompressedSize=b.view.getUint32(c+18,!0)),4294967295===a.compressedSize||4294967295===a.uncompressedSize?(onerror(I),void 0):(a.filenameLength=b.view.getUint16(c+22,!0),a.extraFieldLength=b.view.getUint16(c+24,!0),void 0))}function s(a,b){function c(){}return c.prototype.getData=function(c,d,e,g){function h(a,b){o&&o.terminate(),o=null,a&&a(b)}function i(a){var b=f(4);return b.view.setUint32(0,a),p.crc32==b.view.getUint32(0)}function j(a,b){g&&!i(b)?k():c.getData(function(a){h(d,a)})}function k(){h(b,L)}function n(){h(b,K)}var o,p=this;a.readUint8Array(p.offset,30,function(d){var h,i=f(d.length,d);return 1347093252!=i.view.getUint32(0)?(b(G),void 0):(r(p,i,4),h=p.offset+30+p.filenameLength+p.extraFieldLength,c.init(function(){0===p.compressionMethod?m(a,c,h,p.compressedSize,g,j,e,k,n):o=l(a,c,h,p.compressedSize,g,j,e,k,n)},n),void 0)},k)},{getEntries:function(d){return a.size<22?(b(G),void 0):(a.readUint8Array(a.size-22,22,function(e){var g,h,i=f(e.length,e).view;return 1347093766!=i.getUint32(0)?(b(G),void 0):(g=i.getUint32(16,!0),h=i.getUint16(8,!0),a.readUint8Array(g,a.size-g,function(a){var e,g,i,j,k=0,l=[],m=f(a.length,a);for(e=0;h>e;e++){if(g=new c,1347092738!=m.view.getUint32(k))return b(G),void 0;r(g,m,k+6,!0),g.commentLength=m.view.getUint16(k+32,!0),g.directory=16==(16&m.view.getUint8(k+38)),g.offset=m.view.getUint32(k+42,!0),i=p(m.array.subarray(k+46,k+46+g.filenameLength)),g.filename=2048===(2048&g.bitFlag)?o(i):n(i),g.directory||"/"!=g.filename.charAt(g.filename.length-1)||(g.directory=!0),j=p(m.array.subarray(k+46+g.filenameLength+g.extraFieldLength,k+46+g.filenameLength+g.extraFieldLength+g.commentLength)),g.comment=2048===(2048&g.bitFlag)?o(j):n(j),l.push(g),k+=46+g.filenameLength+g.extraFieldLength+g.commentLength}d(l)},function(){b(J)}),void 0)},function(){b(J)}),void 0)},close:function(a){a&&a()}}}function t(){function a(a){var b,c,e,f,g,h,i=d.dyn_tree,j=d.stat_desc.static_tree,k=d.stat_desc.extra_bits,l=d.stat_desc.extra_base,m=d.stat_desc.max_length,n=0;for(f=0;O>=f;f++)a.bl_count[f]=0;for(i[2*a.heap[a.heap_max]+1]=0,b=a.heap_max+1;U>b;b++)c=a.heap[b],f=i[2*i[2*c+1]+1]+1,f>m&&(f=m,n++),i[2*c+1]=f,c>d.max_code||(a.bl_count[f]++,g=0,c>=l&&(g=k[c-l]),h=i[2*c],a.opt_len+=h*(f+g),j&&(a.static_len+=h*(j[2*c+1]+g)));if(0!==n){do{for(f=m-1;0===a.bl_count[f];)f--;a.bl_count[f]--,a.bl_count[f+1]+=2,a.bl_count[m]--,n-=2}while(n>0);for(f=m;0!==f;f--)for(c=a.bl_count[f];0!==c;)e=a.heap[--b],e>d.max_code||(i[2*e+1]!=f&&(a.opt_len+=(f-i[2*e+1])*i[2*e],i[2*e+1]=f),c--)}}function b(a,b){var c=0;do c|=1&a,a>>>=1,c<<=1;while(--b>0);return c>>>1}function c(a,c,d){var e,f,g,h=[],i=0;for(e=1;O>=e;e++)h[e]=i=i+d[e-1]<<1;for(f=0;c>=f;f++)g=a[2*f+1],0!==g&&(a[2*f]=b(h[g]++,g))}var d=this;d.build_tree=function(b){var e,f,g,h=d.dyn_tree,i=d.stat_desc.static_tree,j=d.stat_desc.elems,k=-1;for(b.heap_len=0,b.heap_max=U,e=0;j>e;e++)0!==h[2*e]?(b.heap[++b.heap_len]=k=e,b.depth[e]=0):h[2*e+1]=0;for(;b.heap_len<2;)g=b.heap[++b.heap_len]=2>k?++k:0,h[2*g]=1,b.depth[g]=0,b.opt_len--,i&&(b.static_len-=i[2*g+1]);for(d.max_code=k,e=Math.floor(b.heap_len/2);e>=1;e--)b.pqdownheap(h,e);g=j;do e=b.heap[1],b.heap[1]=b.heap[b.heap_len--],b.pqdownheap(h,1),f=b.heap[1],b.heap[--b.heap_max]=e,b.heap[--b.heap_max]=f,h[2*g]=h[2*e]+h[2*f],b.depth[g]=Math.max(b.depth[e],b.depth[f])+1,h[2*e+1]=h[2*f+1]=g,b.heap[1]=g++,b.pqdownheap(h,1);while(b.heap_len>=2);b.heap[--b.heap_max]=b.heap[1],a(b),c(h,d.max_code,b.bl_count)}}function u(a,b,c,d,e){var f=this;f.static_tree=a,f.extra_bits=b,f.extra_base=c,f.elems=d,f.max_length=e}function v(a,b,c,d,e){var f=this;f.good_length=a,f.max_lazy=b,f.nice_length=c,f.max_chain=d,f.func=e}function w(a,b,c,d){var e=a[2*b],f=a[2*c];return f>e||e==f&&d[b]<=d[c]}function x(){function a(){var a;for(O=2*K,U[nb-1]=0,a=0;nb-1>a;a++)U[a]=0;Zb=tb[$b].max_lazy,ac=tb[$b].good_length,bc=tb[$b].nice_length,Yb=tb[$b].max_chain,Ub=0,Qb=0,Wb=0,Rb=Xb=Kb-1,Tb=0,W=0}function b(){var a;for(a=0;T>a;a++)cc[2*a]=0;for(a=0;P>a;a++)dc[2*a]=0;for(a=0;Q>a;a++)ec[2*a]=0;cc[2*V]=1,fc.opt_len=fc.static_len=0,lc=nc=0}function c(){gc.dyn_tree=cc,gc.stat_desc=u.static_l_desc,hc.dyn_tree=dc,hc.stat_desc=u.static_d_desc,ic.dyn_tree=ec,ic.stat_desc=u.static_bl_desc,pc=0,qc=0,oc=8,b()}function d(a,b){var c,d,e=-1,f=a[1],g=0,h=7,i=4;for(0===f&&(h=138,i=3),a[2*(b+1)+1]=65535,c=0;b>=c;c++)d=f,f=a[2*(c+1)+1],++g<h&&d==f||(i>g?ec[2*d]+=g:0!==d?(d!=e&&ec[2*d]++,ec[2*X]++):10>=g?ec[2*Y]++:ec[2*Z]++,g=0,e=d,0===f?(h=138,i=3):d==f?(h=6,i=3):(h=7,i=4))}function e(){var a;for(d(cc,gc.max_code),d(dc,hc.max_code),ic.build_tree(fc),a=Q-1;a>=3&&0===ec[2*t.bl_order[a]+1];a--);return fc.opt_len+=3*(a+1)+5+5+4,a}function f(a){fc.pending_buf[fc.pending++]=a}function g(a){f(255&a),f(255&a>>>8)}function h(a){f(255&a>>8),f(255&(255&a))}function i(a,b){var c,d=b;qc>$-d?(c=a,pc|=65535&c<<qc,g(pc),pc=c>>>$-qc,qc+=d-$):(pc|=65535&a<<qc,qc+=d)}function j(a,b){var c=2*a;i(65535&b[c],65535&b[c+1])}function k(a,b){var c,d,e=-1,f=a[1],g=0,h=7,k=4;for(0===f&&(h=138,k=3),c=0;b>=c;c++)if(d=f,f=a[2*(c+1)+1],!(++g<h&&d==f)){if(k>g){do j(d,ec);while(0!==--g)}else 0!==d?(d!=e&&(j(d,ec),g--),j(X,ec),i(g-3,2)):10>=g?(j(Y,ec),i(g-3,3)):(j(Z,ec),i(g-11,7));g=0,e=d,0===f?(h=138,k=3):d==f?(h=6,k=3):(h=7,k=4)}}function l(a,b,c){var d;for(i(a-257,5),i(b-1,5),i(c-4,4),d=0;c>d;d++)i(ec[2*t.bl_order[d]+1],3);k(cc,a-1),k(dc,b-1)}function m(){16==qc?(g(pc),pc=0,qc=0):qc>=8&&(f(255&pc),pc>>>=8,qc-=8)}function n(){i(Fb<<1,3),j(V,u.static_ltree),m(),9>1+oc+10-qc&&(i(Fb<<1,3),j(V,u.static_ltree),m()),oc=7}function o(a,b){var c,d,e;if(fc.pending_buf[mc+2*lc]=255&a>>>8,fc.pending_buf[mc+2*lc+1]=255&a,fc.pending_buf[jc+lc]=255&b,lc++,0===a?cc[2*b]++:(nc++,a--,cc[2*(t._length_code[b]+S+1)]++,dc[2*t.d_code(a)]++),0===(8191&lc)&&$b>2){for(c=8*lc,d=Ub-Qb,e=0;P>e;e++)c+=dc[2*e]*(5+t.extra_dbits[e]);if(c>>>=3,nc<Math.floor(lc/2)&&c<Math.floor(d/2))return!0}return lc==kc-1}function p(a,b){var c,d,e,f,g=0;if(0!==lc)do c=65280&fc.pending_buf[mc+2*g]<<8|255&fc.pending_buf[mc+2*g+1],d=255&fc.pending_buf[jc+g],g++,0===c?j(d,a):(e=t._length_code[d],j(e+S+1,a),f=t.extra_lbits[e],0!==f&&(d-=t.base_length[e],i(d,f)),c--,e=t.d_code(c),j(e,b),f=t.extra_dbits[e],0!==f&&(c-=t.base_dist[e],i(c,f)));while(lc>g);j(V,a),oc=a[2*V+1]}function q(){for(var a=0,b=0,c=0;7>a;)c+=cc[2*a],a++;for(;128>a;)b+=cc[2*a],a++;for(;S>a;)c+=cc[2*a],a++;fc.data_type=255&(c>b>>>2?Hb:Ib)}function r(){qc>8?g(pc):qc>0&&f(255&pc),pc=0,qc=0}function s(a,b,c){r(),oc=8,c&&(g(b),g(~b)),fc.pending_buf.set(N.subarray(a,a+b),fc.pending),fc.pending+=b}function v(a,b,c){i((Eb<<1)+(c?1:0),3),s(a,b,!0)}function x(a,c,d){var f,g,h=0;$b>0?(fc.data_type==Jb&&q(),gc.build_tree(fc),hc.build_tree(fc),h=e(),f=fc.opt_len+3+7>>>3,g=fc.static_len+3+7>>>3,f>=g&&(f=g)):f=g=c+5,f>=c+4&&-1!=a?v(a,c,d):g==f?(i((Fb<<1)+(d?1:0),3),p(u.static_ltree,u.static_dtree)):(i((Gb<<1)+(d?1:0),3),l(gc.max_code+1,hc.max_code+1,h+1),p(cc,dc)),b(),d&&r()}function y(a){x(Qb>=0?Qb:-1,Ub-Qb,a),Qb=Ub,F.flush_pending()}function z(){var a,b,c,d;do{if(d=O-Wb-Ub,0===d&&0===Ub&&0===Wb)d=K;else if(-1==d)d--;else if(Ub>=K+K-Mb){N.set(N.subarray(K,K+K),0),Vb-=K,Ub-=K,Qb-=K,a=nb,c=a;do b=65535&U[--c],U[c]=b>=K?b-K:0;while(0!==--a);a=K,c=a;do b=65535&R[--c],R[c]=b>=K?b-K:0;while(0!==--a);d+=K}if(0===F.avail_in)return;a=F.read_buf(N,Ub+Wb,d),Wb+=a,Wb>=Kb&&(W=255&N[Ub],W=(W<<Pb^255&N[Ub+1])&Ob)}while(Mb>Wb&&0!==F.avail_in)}function A(a){var b,c=65535;for(c>H-5&&(c=H-5);;){if(1>=Wb){if(z(),0===Wb&&a==db)return vb;if(0===Wb)break}if(Ub+=Wb,Wb=0,b=Qb+c,(0===Ub||Ub>=b)&&(Wb=Ub-b,Ub=b,y(!1),0===F.avail_out))return vb;if(Ub-Qb>=K-Mb&&(y(!1),0===F.avail_out))return vb}return y(a==gb),0===F.avail_out?a==gb?xb:vb:a==gb?yb:wb}function B(a){var b,c,d=Yb,e=Ub,f=Xb,g=Ub>K-Mb?Ub-(K-Mb):0,h=bc,i=M,j=Ub+Lb,k=N[e+f-1],l=N[e+f];Xb>=ac&&(d>>=2),h>Wb&&(h=Wb);do if(b=a,N[b+f]==l&&N[b+f-1]==k&&N[b]==N[e]&&N[++b]==N[e+1]){e+=2,b++;do;while(N[++e]==N[++b]&&N[++e]==N[++b]&&N[++e]==N[++b]&&N[++e]==N[++b]&&N[++e]==N[++b]&&N[++e]==N[++b]&&N[++e]==N[++b]&&N[++e]==N[++b]&&j>e);if(c=Lb-(j-e),e=j-Lb,c>f){if(Vb=a,f=c,c>=h)break;k=N[e+f-1],l=N[e+f]}}while((a=65535&R[a&i])>g&&0!==--d);return Wb>=f?f:Wb}function C(a){for(var b,c=0;;){if(Mb>Wb){if(z(),Mb>Wb&&a==db)return vb;if(0===Wb)break}if(Wb>=Kb&&(W=(W<<Pb^255&N[Ub+(Kb-1)])&Ob,c=65535&U[W],R[Ub&M]=U[W],U[W]=Ub),0!==c&&K-Mb>=(65535&Ub-c)&&_b!=bb&&(Rb=B(c)),Rb>=Kb)if(b=o(Ub-Vb,Rb-Kb),Wb-=Rb,Zb>=Rb&&Wb>=Kb){Rb--;do Ub++,W=(W<<Pb^255&N[Ub+(Kb-1)])&Ob,c=65535&U[W],R[Ub&M]=U[W],U[W]=Ub;while(0!==--Rb);Ub++}else Ub+=Rb,Rb=0,W=255&N[Ub],W=(W<<Pb^255&N[Ub+1])&Ob;else b=o(0,255&N[Ub]),Wb--,Ub++;if(b&&(y(!1),0===F.avail_out))return vb}return y(a==gb),0===F.avail_out?a==gb?xb:vb:a==gb?yb:wb}function D(a){for(var b,c,d=0;;){if(Mb>Wb){if(z(),Mb>Wb&&a==db)return vb;if(0===Wb)break}if(Wb>=Kb&&(W=(W<<Pb^255&N[Ub+(Kb-1)])&Ob,d=65535&U[W],R[Ub&M]=U[W],U[W]=Ub),Xb=Rb,Sb=Vb,Rb=Kb-1,0!==d&&Zb>Xb&&K-Mb>=(65535&Ub-d)&&(_b!=bb&&(Rb=B(d)),5>=Rb&&(_b==ab||Rb==Kb&&Ub-Vb>4096)&&(Rb=Kb-1)),Xb>=Kb&&Xb>=Rb){c=Ub+Wb-Kb,b=o(Ub-1-Sb,Xb-Kb),Wb-=Xb-1,Xb-=2;do++Ub<=c&&(W=(W<<Pb^255&N[Ub+(Kb-1)])&Ob,d=65535&U[W],R[Ub&M]=U[W],U[W]=Ub);while(0!==--Xb);if(Tb=0,Rb=Kb-1,Ub++,b&&(y(!1),0===F.avail_out))return vb}else if(0!==Tb){if(b=o(0,255&N[Ub-1]),b&&y(!1),Ub++,Wb--,0===F.avail_out)return vb}else Tb=1,Ub++,Wb--}return 0!==Tb&&(b=o(0,255&N[Ub-1]),Tb=0),y(a==gb),0===F.avail_out?a==gb?xb:vb:a==gb?yb:wb}function E(b){return b.total_in=b.total_out=0,b.msg=null,b.data_type=Jb,fc.pending=0,fc.pending_out=0,G=Bb,J=db,c(),a(),hb}var F,G,H,I,J,K,L,M,N,O,R,U,W,nb,Nb,Ob,Pb,Qb,Rb,Sb,Tb,Ub,Vb,Wb,Xb,Yb,Zb,$b,_b,ac,bc,cc,dc,ec,fc=this,gc=new t,hc=new t,ic=new t;fc.depth=[];var jc,kc,lc,mc,nc,oc,pc,qc;fc.bl_count=[],fc.heap=[],cc=[],dc=[],ec=[],fc.pqdownheap=function(a,b){for(var c=fc.heap,d=c[b],e=b<<1;e<=fc.heap_len&&(e<fc.heap_len&&w(a,c[e+1],c[e],fc.depth)&&e++,!w(a,d,c[e],fc.depth));)c[b]=c[e],b=e,e<<=1;c[b]=d},fc.deflateInit=function(a,b,c,d,e,f){return d||(d=Db),e||(e=pb),f||(f=cb),a.msg=null,b==_&&(b=6),1>e||e>ob||d!=Db||9>c||c>15||0>b||b>9||0>f||f>bb?kb:(a.dstate=fc,L=c,K=1<<L,M=K-1,Nb=e+7,nb=1<<Nb,Ob=nb-1,Pb=Math.floor((Nb+Kb-1)/Kb),N=new Uint8Array(2*K),R=[],U=[],kc=1<<e+6,fc.pending_buf=new Uint8Array(4*kc),H=4*kc,mc=Math.floor(kc/2),jc=3*kc,$b=b,_b=f,I=255&d,E(a))},fc.deflateEnd=function(){return G!=Ab&&G!=Bb&&G!=Cb?kb:(fc.pending_buf=null,U=null,R=null,N=null,fc.dstate=null,G==Bb?lb:hb)},fc.deflateParams=function(a,b,c){var d=hb;return b==_&&(b=6),0>b||b>9||0>c||c>bb?kb:(tb[$b].func!=tb[b].func&&0!==a.total_in&&(d=a.deflate(eb)),$b!=b&&($b=b,Zb=tb[$b].max_lazy,ac=tb[$b].good_length,bc=tb[$b].nice_length,Yb=tb[$b].max_chain),_b=c,d)},fc.deflateSetDictionary=function(a,b,c){var d,e=c,f=0;if(!b||G!=Ab)return kb;if(Kb>e)return hb;for(e>K-Mb&&(e=K-Mb,f=c-e),N.set(b.subarray(f,f+e),0),Ub=e,Qb=e,W=255&N[0],W=(W<<Pb^255&N[1])&Ob,d=0;e-Kb>=d;d++)W=(W<<Pb^255&N[d+(Kb-1)])&Ob,R[d&M]=U[W],U[W]=d;return hb},fc.deflate=function(a,b){var c,d,e,f,g;if(b>gb||0>b)return kb;if(!a.next_out||!a.next_in&&0!==a.avail_in||G==Cb&&b!=gb)return a.msg=ub[jb-kb],kb;if(0===a.avail_out)return a.msg=ub[jb-mb],mb;if(F=a,f=J,J=b,G==Ab&&(d=Db+(L-8<<4)<<8,e=(255&$b-1)>>1,e>3&&(e=3),d|=e<<6,0!==Ub&&(d|=zb),d+=31-d%31,G=Bb,h(d)),0!==fc.pending){if(F.flush_pending(),0===F.avail_out)return J=-1,hb}else if(0===F.avail_in&&f>=b&&b!=gb)return F.msg=ub[jb-mb],mb;if(G==Cb&&0!==F.avail_in)return a.msg=ub[jb-mb],mb;if(0!==F.avail_in||0!==Wb||b!=db&&G!=Cb){switch(g=-1,tb[$b].func){case qb:g=A(b);break;case rb:g=C(b);break;case sb:g=D(b)}if((g==xb||g==yb)&&(G=Cb),g==vb||g==xb)return 0===F.avail_out&&(J=-1),hb;if(g==wb){if(b==eb)n();else if(v(0,0,!1),b==fb)for(c=0;nb>c;c++)U[c]=0;if(F.flush_pending(),0===F.avail_out)return J=-1,hb}}return b!=gb?hb:ib}}function y(){var a=this;a.next_in_index=0,a.next_out_index=0,a.avail_in=0,a.total_in=0,a.avail_out=0,a.total_out=0}function z(a){var b=this,c=new y,d=512,e=db,f=new Uint8Array(d);"undefined"==typeof a&&(a=_),c.deflateInit(a),c.next_out=f,b.append=function(a,b){var g,h,i=[],j=0,k=0,l=0;if(a.length){c.next_in_index=0,c.next_in=a,c.avail_in=a.length;do{if(c.next_out_index=0,c.avail_out=d,g=c.deflate(e),g!=hb)throw"deflating: "+c.msg;c.next_out_index&&(c.next_out_index==d?i.push(new Uint8Array(f)):i.push(new Uint8Array(f.subarray(0,c.next_out_index)))),l+=c.next_out_index,b&&c.next_in_index>0&&c.next_in_index!=j&&(b(c.next_in_index),j=c.next_in_index)}while(c.avail_in>0||0===c.avail_out);return h=new Uint8Array(l),i.forEach(function(a){h.set(a,k),k+=a.length}),h}},b.flush=function(){var a,b,e=[],g=0,h=0;do{if(c.next_out_index=0,c.avail_out=d,a=c.deflate(gb),a!=ib&&a!=hb)throw"deflating: "+c.msg;d-c.avail_out>0&&e.push(new Uint8Array(f.subarray(0,c.next_out_index))),h+=c.next_out_index}while(c.avail_in>0||0===c.avail_out);return c.deflateEnd(),b=new Uint8Array(h),e.forEach(function(a){b.set(a,g),g+=a.length}),b}}function A(){function a(a,b,c,d,i,j,k,l,m,n,o){var p,q,r,s,t,u,v,w,x,y,z,A,B,C,D;y=0,t=c;do e[a[b+y]]++,y++,t--;while(0!==t);if(e[0]==c)return k[0]=-1,l[0]=0,hb;for(w=l[0],u=1;Yb>=u&&0===e[u];u++);for(v=u,u>w&&(w=u),t=Yb;0!==t&&0===e[t];t--);for(r=t,w>t&&(w=t),l[0]=w,C=1<<u;t>u;u++,C<<=1)if((C-=e[u])<0)return lb;if((C-=e[t])<0)return lb;for(e[t]+=C,h[1]=u=0,y=1,B=2;0!==--t;)h[B]=u+=e[y],B++,y++;t=0,y=0;do 0!==(u=a[b+y])&&(o[h[u]++]=t),y++;while(++t<c);for(c=h[r],h[0]=t=0,y=0,s=-1,A=-w,g[0]=0,z=0,D=0,v;r>=v;v++)for(p=e[v];0!==p--;){for(;v>A+w;){if(s++,A+=w,D=r-A,D=D>w?w:D,(q=1<<(u=v-A))>p+1&&(q-=p+1,B=v,D>u))for(;++u<D&&!((q<<=1)<=e[++B]);)q-=e[B];if(D=1<<u,n[0]+D>Pb)return lb;g[s]=z=n[0],n[0]+=D,0!==s?(h[s]=t,f[0]=u,f[1]=w,u=t>>>A-w,f[2]=z-g[s-1]-u,m.set(f,3*(g[s-1]+u))):k[0]=z}for(f[1]=v-A,y>=c?f[0]=192:o[y]<d?(f[0]=o[y]<256?0:96,f[2]=o[y++]):(f[0]=j[o[y]-d]+16+64,f[2]=i[o[y++]-d]),q=1<<v-A,u=t>>>A;D>u;u+=q)m.set(f,3*(z+u));for(u=1<<v-1;0!==(t&u);u>>>=1)t^=u;for(t^=u,x=(1<<A)-1;(t&x)!=h[s];)s--,A-=w,x=(1<<A)-1}return 0!==C&&1!=r?mb:hb}function b(a){var b;for(c||(c=[],d=[],e=new Int32Array(Yb+1),f=[],g=new Int32Array(Yb),h=new Int32Array(Yb+1)),d.length<a&&(d=[]),b=0;a>b;b++)d[b]=0;for(b=0;Yb+1>b;b++)e[b]=0;for(b=0;3>b;b++)f[b]=0;g.set(e.subarray(0,Yb),0),h.set(e.subarray(0,Yb+1),0)}var c,d,e,f,g,h,i=this;i.inflate_trees_bits=function(e,f,g,h,i){var j;return b(19),c[0]=0,j=a(e,0,19,19,null,null,g,f,h,c,d),j==lb?i.msg="oversubscribed dynamic bit lengths tree":(j==mb||0===f[0])&&(i.msg="incomplete dynamic bit lengths tree",j=lb),j
},i.inflate_trees_dynamic=function(e,f,g,h,i,j,k,l,m){var n;return b(288),c[0]=0,n=a(g,0,e,257,Ub,Vb,j,h,l,c,d),n!=hb||0===h[0]?(n==lb?m.msg="oversubscribed literal/length tree":n!=Nb&&(m.msg="incomplete literal/length tree",n=lb),n):(b(288),n=a(g,e,f,0,Wb,Xb,k,i,l,c,d),n!=hb||0===i[0]&&e>257?(n==lb?m.msg="oversubscribed distance tree":n==mb?(m.msg="incomplete distance tree",n=lb):n!=Nb&&(m.msg="empty distance tree with lengths",n=lb),n):hb)}}function B(){function a(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;o=h.next_in_index,p=h.avail_in,m=g.bitb,n=g.bitk,q=g.write,r=q<g.read?g.read-q-1:g.end-q,s=Ob[a],t=Ob[b];do{for(;20>n;)p--,m|=(255&h.read_byte(o++))<<n,n+=8;if(i=m&s,j=c,k=d,x=3*(k+i),0!==(l=j[x]))for(;;){if(m>>=j[x+1],n-=j[x+1],0!==(16&l)){for(l&=15,u=j[x+2]+(m&Ob[l]),m>>=l,n-=l;15>n;)p--,m|=(255&h.read_byte(o++))<<n,n+=8;for(i=m&t,j=e,k=f,x=3*(k+i),l=j[x];;){if(m>>=j[x+1],n-=j[x+1],0!==(16&l)){for(l&=15;l>n;)p--,m|=(255&h.read_byte(o++))<<n,n+=8;if(v=j[x+2]+(m&Ob[l]),m>>=l,n-=l,r-=u,q>=v)w=q-v,q-w>0&&2>q-w?(g.window[q++]=g.window[w++],g.window[q++]=g.window[w++],u-=2):(g.window.set(g.window.subarray(w,w+2),q),q+=2,w+=2,u-=2);else{w=q-v;do w+=g.end;while(0>w);if(l=g.end-w,u>l){if(u-=l,q-w>0&&l>q-w){do g.window[q++]=g.window[w++];while(0!==--l)}else g.window.set(g.window.subarray(w,w+l),q),q+=l,w+=l,l=0;w=0}}if(q-w>0&&u>q-w){do g.window[q++]=g.window[w++];while(0!==--u)}else g.window.set(g.window.subarray(w,w+u),q),q+=u,w+=u,u=0;break}if(0!==(64&l))return h.msg="invalid distance code",u=h.avail_in-p,u=u>n>>3?n>>3:u,p+=u,o-=u,n-=u<<3,g.bitb=m,g.bitk=n,h.avail_in=p,h.total_in+=o-h.next_in_index,h.next_in_index=o,g.write=q,lb;i+=j[x+2],i+=m&Ob[l],x=3*(k+i),l=j[x]}break}if(0!==(64&l))return 0!==(32&l)?(u=h.avail_in-p,u=u>n>>3?n>>3:u,p+=u,o-=u,n-=u<<3,g.bitb=m,g.bitk=n,h.avail_in=p,h.total_in+=o-h.next_in_index,h.next_in_index=o,g.write=q,ib):(h.msg="invalid literal/length code",u=h.avail_in-p,u=u>n>>3?n>>3:u,p+=u,o-=u,n-=u<<3,g.bitb=m,g.bitk=n,h.avail_in=p,h.total_in+=o-h.next_in_index,h.next_in_index=o,g.write=q,lb);if(i+=j[x+2],i+=m&Ob[l],x=3*(k+i),0===(l=j[x])){m>>=j[x+1],n-=j[x+1],g.window[q++]=j[x+2],r--;break}}else m>>=j[x+1],n-=j[x+1],g.window[q++]=j[x+2],r--}while(r>=258&&p>=10);return u=h.avail_in-p,u=u>n>>3?n>>3:u,p+=u,o-=u,n-=u<<3,g.bitb=m,g.bitk=n,h.avail_in=p,h.total_in+=o-h.next_in_index,h.next_in_index=o,g.write=q,hb}var b,c,d,e,f=this,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0;f.init=function(a,f,g,h,i,j){b=Zb,m=a,n=f,d=g,o=h,e=i,p=j,c=null},f.proc=function(f,q,r){for(var s,t,u,v,w=f.bitb,x=f.bitk,y=q.next_in_index,z=q.avail_in,A=f.write,B=A<f.read?f.read-A-1:f.end-A;;)switch(b){case Zb:if(B>=258&&z>=10&&(f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,r=a(m,n,d,o,e,p,f,q),y=q.next_in_index,z=q.avail_in,w=f.bitb,x=f.bitk,A=f.write,B=A<f.read?f.read-A-1:f.end-A,r!=hb)){b=r==ib?ec:gc;break}i=m,c=d,h=o,b=$b;case $b:for(s=i;s>x;){if(0===z)return f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);r=hb,z--,w|=(255&q.read_byte(y++))<<x,x+=8}if(t=3*(h+(w&Ob[s])),w>>>=c[t+1],x-=c[t+1],u=c[t],0===u){j=c[t+2],b=dc;break}if(0!==(16&u)){k=15&u,g=c[t+2],b=_b;break}if(0===(64&u)){i=u,h=t/3+c[t+2];break}if(0!==(32&u)){b=ec;break}return b=gc,q.msg="invalid literal/length code",r=lb,f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);case _b:for(s=k;s>x;){if(0===z)return f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);r=hb,z--,w|=(255&q.read_byte(y++))<<x,x+=8}g+=w&Ob[s],w>>=s,x-=s,i=n,c=e,h=p,b=ac;case ac:for(s=i;s>x;){if(0===z)return f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);r=hb,z--,w|=(255&q.read_byte(y++))<<x,x+=8}if(t=3*(h+(w&Ob[s])),w>>=c[t+1],x-=c[t+1],u=c[t],0!==(16&u)){k=15&u,l=c[t+2],b=bc;break}if(0===(64&u)){i=u,h=t/3+c[t+2];break}return b=gc,q.msg="invalid distance code",r=lb,f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);case bc:for(s=k;s>x;){if(0===z)return f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);r=hb,z--,w|=(255&q.read_byte(y++))<<x,x+=8}l+=w&Ob[s],w>>=s,x-=s,b=cc;case cc:for(v=A-l;0>v;)v+=f.end;for(;0!==g;){if(0===B&&(A==f.end&&0!==f.read&&(A=0,B=A<f.read?f.read-A-1:f.end-A),0===B&&(f.write=A,r=f.inflate_flush(q,r),A=f.write,B=A<f.read?f.read-A-1:f.end-A,A==f.end&&0!==f.read&&(A=0,B=A<f.read?f.read-A-1:f.end-A),0===B)))return f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);f.window[A++]=f.window[v++],B--,v==f.end&&(v=0),g--}b=Zb;break;case dc:if(0===B&&(A==f.end&&0!==f.read&&(A=0,B=A<f.read?f.read-A-1:f.end-A),0===B&&(f.write=A,r=f.inflate_flush(q,r),A=f.write,B=A<f.read?f.read-A-1:f.end-A,A==f.end&&0!==f.read&&(A=0,B=A<f.read?f.read-A-1:f.end-A),0===B)))return f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);r=hb,f.window[A++]=j,B--,b=Zb;break;case ec:if(x>7&&(x-=8,z++,y--),f.write=A,r=f.inflate_flush(q,r),A=f.write,B=A<f.read?f.read-A-1:f.end-A,f.read!=f.write)return f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);b=fc;case fc:return r=ib,f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);case gc:return r=lb,f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);default:return r=kb,f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r)}},f.free=function(){}}function C(a,b){var c,d=this,e=ic,f=0,g=0,h=0,i=[0],j=[0],k=new B,l=0,m=new Int32Array(3*Pb),n=0,o=new A;d.bitk=0,d.bitb=0,d.window=new Uint8Array(b),d.end=b,d.read=0,d.write=0,d.reset=function(a,b){b&&(b[0]=n),e==nc&&k.free(a),e=ic,d.bitk=0,d.bitb=0,d.read=d.write=0},d.reset(a,null),d.inflate_flush=function(a,b){var c,e,f;return e=a.next_out_index,f=d.read,c=(f<=d.write?d.write:d.end)-f,c>a.avail_out&&(c=a.avail_out),0!==c&&b==mb&&(b=hb),a.avail_out-=c,a.total_out+=c,a.next_out.set(d.window.subarray(f,f+c),e),e+=c,f+=c,f==d.end&&(f=0,d.write==d.end&&(d.write=0),c=d.write-f,c>a.avail_out&&(c=a.avail_out),0!==c&&b==mb&&(b=hb),a.avail_out-=c,a.total_out+=c,a.next_out.set(d.window.subarray(f,f+c),e),e+=c,f+=c),a.next_out_index=e,d.read=f,b},d.proc=function(a,b){var n,p,q,r,s,t,u,v;for(r=a.next_in_index,s=a.avail_in,p=d.bitb,q=d.bitk,t=d.write,u=t<d.read?d.read-t-1:d.end-t;;)switch(e){case ic:for(;3>q;){if(0===s)return d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);b=hb,s--,p|=(255&a.read_byte(r++))<<q,q+=8}switch(n=7&p,l=1&n,n>>>1){case 0:p>>>=3,q-=3,n=7&q,p>>>=n,q-=n,e=jc;break;case 1:var w=[],x=[],y=[[]],z=[[]];A.inflate_trees_fixed(w,x,y,z,a),k.init(w[0],x[0],y[0],0,z[0],0,a),p>>>=3,q-=3,e=nc;break;case 2:p>>>=3,q-=3,e=kc;break;case 3:return p>>>=3,q-=3,e=qc,a.msg="invalid block type",b=lb,d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b)}break;case jc:for(;32>q;){if(0===s)return d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);b=hb,s--,p|=(255&a.read_byte(r++))<<q,q+=8}if((65535&~p>>>16)!=(65535&p))return e=qc,a.msg="invalid stored block lengths",b=lb,d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);f=65535&p,p=q=0,e=0!==f?qb:0!==l?oc:ic;break;case qb:if(0===s)return d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);if(0===u&&(t==d.end&&0!==d.read&&(t=0,u=t<d.read?d.read-t-1:d.end-t),0===u&&(d.write=t,b=d.inflate_flush(a,b),t=d.write,u=t<d.read?d.read-t-1:d.end-t,t==d.end&&0!==d.read&&(t=0,u=t<d.read?d.read-t-1:d.end-t),0===u)))return d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);if(b=hb,n=f,n>s&&(n=s),n>u&&(n=u),d.window.set(a.read_buf(r,n),t),r+=n,s-=n,t+=n,u-=n,0!==(f-=n))break;e=0!==l?oc:ic;break;case kc:for(;14>q;){if(0===s)return d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);b=hb,s--,p|=(255&a.read_byte(r++))<<q,q+=8}if(g=n=16383&p,(31&n)>29||(31&n>>5)>29)return e=qc,a.msg="too many length or distance symbols",b=lb,d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);if(n=258+(31&n)+(31&n>>5),!c||c.length<n)c=[];else for(v=0;n>v;v++)c[v]=0;p>>>=14,q-=14,h=0,e=lc;case lc:for(;4+(g>>>10)>h;){for(;3>q;){if(0===s)return d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);b=hb,s--,p|=(255&a.read_byte(r++))<<q,q+=8}c[hc[h++]]=7&p,p>>>=3,q-=3}for(;19>h;)c[hc[h++]]=0;if(i[0]=7,n=o.inflate_trees_bits(c,i,j,m,a),n!=hb)return b=n,b==lb&&(c=null,e=qc),d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);h=0,e=mc;case mc:for(;;){if(n=g,!(258+(31&n)+(31&n>>5)>h))break;var B,C;for(n=i[0];n>q;){if(0===s)return d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);b=hb,s--,p|=(255&a.read_byte(r++))<<q,q+=8}if(n=m[3*(j[0]+(p&Ob[n]))+1],C=m[3*(j[0]+(p&Ob[n]))+2],16>C)p>>>=n,q-=n,c[h++]=C;else{for(v=18==C?7:C-14,B=18==C?11:3;n+v>q;){if(0===s)return d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);b=hb,s--,p|=(255&a.read_byte(r++))<<q,q+=8}if(p>>>=n,q-=n,B+=p&Ob[v],p>>>=v,q-=v,v=h,n=g,v+B>258+(31&n)+(31&n>>5)||16==C&&1>v)return c=null,e=qc,a.msg="invalid bit length repeat",b=lb,d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);C=16==C?c[v-1]:0;do c[v++]=C;while(0!==--B);h=v}}j[0]=-1;var D=[],E=[],F=[],G=[];if(D[0]=9,E[0]=6,n=g,n=o.inflate_trees_dynamic(257+(31&n),1+(31&n>>5),c,D,E,F,G,m,a),n!=hb)return n==lb&&(c=null,e=qc),b=n,d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);k.init(D[0],E[0],m,F[0],m,G[0],a),e=nc;case nc:if(d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,(b=k.proc(d,a,b))!=ib)return d.inflate_flush(a,b);if(b=hb,k.free(a),r=a.next_in_index,s=a.avail_in,p=d.bitb,q=d.bitk,t=d.write,u=t<d.read?d.read-t-1:d.end-t,0===l){e=ic;break}e=oc;case oc:if(d.write=t,b=d.inflate_flush(a,b),t=d.write,u=t<d.read?d.read-t-1:d.end-t,d.read!=d.write)return d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);e=pc;case pc:return b=ib,d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);case qc:return b=lb,d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);default:return b=kb,d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b)}},d.free=function(a){d.reset(a,null),d.window=null,m=null},d.set_dictionary=function(a,b,c){d.window.set(a.subarray(b,b+c),0),d.read=d.write=c},d.sync_point=function(){return e==jc?1:0}}function D(){function a(a){return a&&a.istate?(a.total_in=a.total_out=0,a.msg=null,a.istate.mode=yc,a.istate.blocks.reset(a,null),hb):kb}var b=this;b.mode=0,b.method=0,b.was=[0],b.need=0,b.marker=0,b.wbits=0,b.inflateEnd=function(a){return b.blocks&&b.blocks.free(a),b.blocks=null,hb},b.inflateInit=function(c,d){return c.msg=null,b.blocks=null,8>d||d>15?(b.inflateEnd(c),kb):(b.wbits=d,c.istate.blocks=new C(c,1<<d),a(c),hb)},b.inflate=function(a,b){var c,d;if(!a||!a.istate||!a.next_in)return kb;for(b=b==gb?mb:hb,c=mb;;)switch(a.istate.mode){case rc:if(0===a.avail_in)return c;if(c=b,a.avail_in--,a.total_in++,(15&(a.istate.method=a.read_byte(a.next_in_index++)))!=Db){a.istate.mode=Ac,a.msg="unknown compression method",a.istate.marker=5;break}if((a.istate.method>>4)+8>a.istate.wbits){a.istate.mode=Ac,a.msg="invalid window size",a.istate.marker=5;break}a.istate.mode=sc;case sc:if(0===a.avail_in)return c;if(c=b,a.avail_in--,a.total_in++,d=255&a.read_byte(a.next_in_index++),0!==((a.istate.method<<8)+d)%31){a.istate.mode=Ac,a.msg="incorrect header check",a.istate.marker=5;break}if(0===(d&zb)){a.istate.mode=yc;break}a.istate.mode=tc;case tc:if(0===a.avail_in)return c;c=b,a.avail_in--,a.total_in++,a.istate.need=4278190080&(255&a.read_byte(a.next_in_index++))<<24,a.istate.mode=uc;case uc:if(0===a.avail_in)return c;c=b,a.avail_in--,a.total_in++,a.istate.need+=16711680&(255&a.read_byte(a.next_in_index++))<<16,a.istate.mode=vc;case vc:if(0===a.avail_in)return c;c=b,a.avail_in--,a.total_in++,a.istate.need+=65280&(255&a.read_byte(a.next_in_index++))<<8,a.istate.mode=wc;case wc:return 0===a.avail_in?c:(c=b,a.avail_in--,a.total_in++,a.istate.need+=255&a.read_byte(a.next_in_index++),a.istate.mode=xc,jb);case xc:return a.istate.mode=Ac,a.msg="need dictionary",a.istate.marker=0,kb;case yc:if(c=a.istate.blocks.proc(a,c),c==lb){a.istate.mode=Ac,a.istate.marker=0;break}if(c==hb&&(c=b),c!=ib)return c;c=b,a.istate.blocks.reset(a,a.istate.was),a.istate.mode=zc;case zc:return ib;case Ac:return lb;default:return kb}},b.inflateSetDictionary=function(a,b,c){var d=0,e=c;return a&&a.istate&&a.istate.mode==xc?(e>=1<<a.istate.wbits&&(e=(1<<a.istate.wbits)-1,d=c-e),a.istate.blocks.set_dictionary(b,d,e),a.istate.mode=yc,hb):kb},b.inflateSync=function(b){var c,d,e,f,g;if(!b||!b.istate)return kb;if(b.istate.mode!=Ac&&(b.istate.mode=Ac,b.istate.marker=0),0===(c=b.avail_in))return mb;for(d=b.next_in_index,e=b.istate.marker;0!==c&&4>e;)b.read_byte(d)==Bc[e]?e++:e=0!==b.read_byte(d)?0:4-e,d++,c--;return b.total_in+=d-b.next_in_index,b.next_in_index=d,b.avail_in=c,b.istate.marker=e,4!=e?lb:(f=b.total_in,g=b.total_out,a(b),b.total_in=f,b.total_out=g,b.istate.mode=yc,hb)},b.inflateSyncPoint=function(a){return a&&a.istate&&a.istate.blocks?a.istate.blocks.sync_point():kb}}function y(){}function E(){var a=this,b=new y,c=512,d=db,e=new Uint8Array(c),f=!1;b.inflateInit(),b.next_out=e,a.append=function(a,g){var h,i,j=[],k=0,l=0,m=0;if(0!==a.length){b.next_in_index=0,b.next_in=a,b.avail_in=a.length;do{if(b.next_out_index=0,b.avail_out=c,0!==b.avail_in||f||(b.next_in_index=0,f=!0),h=b.inflate(d),f&&h==mb)return-1;if(h!=hb&&h!=ib)throw"inflating: "+b.msg;if((f||h==ib)&&b.avail_out==a.length)return-1;b.next_out_index&&(b.next_out_index==c?j.push(new Uint8Array(e)):j.push(new Uint8Array(e.subarray(0,b.next_out_index)))),m+=b.next_out_index,g&&b.next_in_index>0&&b.next_in_index!=k&&(g(b.next_in_index),k=b.next_in_index)}while(b.avail_in>0||0===b.avail_out);return i=new Uint8Array(m),j.forEach(function(a){i.set(a,l),l+=a.length}),i}},a.flush=function(){b.inflateEnd()}}function A(){function a(a,b,c,d,i,j,k,l,m,n,o){var p,q,r,s,t,u,v,w,x,y,z,A,B,C,D;y=0,t=c;do e[a[b+y]]++,y++,t--;while(0!==t);if(e[0]==c)return k[0]=-1,l[0]=0,hb;for(w=l[0],u=1;Yb>=u&&0===e[u];u++);for(v=u,u>w&&(w=u),t=Yb;0!==t&&0===e[t];t--);for(r=t,w>t&&(w=t),l[0]=w,C=1<<u;t>u;u++,C<<=1)if((C-=e[u])<0)return lb;if((C-=e[t])<0)return lb;for(e[t]+=C,h[1]=u=0,y=1,B=2;0!==--t;)h[B]=u+=e[y],B++,y++;t=0,y=0;do 0!==(u=a[b+y])&&(o[h[u]++]=t),y++;while(++t<c);for(c=h[r],h[0]=t=0,y=0,s=-1,A=-w,g[0]=0,z=0,D=0,v;r>=v;v++)for(p=e[v];0!==p--;){for(;v>A+w;){if(s++,A+=w,D=r-A,D=D>w?w:D,(q=1<<(u=v-A))>p+1&&(q-=p+1,B=v,D>u))for(;++u<D&&!((q<<=1)<=e[++B]);)q-=e[B];if(D=1<<u,n[0]+D>Pb)return lb;g[s]=z=n[0],n[0]+=D,0!==s?(h[s]=t,f[0]=u,f[1]=w,u=t>>>A-w,f[2]=z-g[s-1]-u,m.set(f,3*(g[s-1]+u))):k[0]=z}for(f[1]=v-A,y>=c?f[0]=192:o[y]<d?(f[0]=o[y]<256?0:96,f[2]=o[y++]):(f[0]=j[o[y]-d]+16+64,f[2]=i[o[y++]-d]),q=1<<v-A,u=t>>>A;D>u;u+=q)m.set(f,3*(z+u));for(u=1<<v-1;0!==(t&u);u>>>=1)t^=u;for(t^=u,x=(1<<A)-1;(t&x)!=h[s];)s--,A-=w,x=(1<<A)-1}return 0!==C&&1!=r?mb:hb}function b(a){var b;for(c||(c=[],d=[],e=new Int32Array(Yb+1),f=[],g=new Int32Array(Yb),h=new Int32Array(Yb+1)),d.length<a&&(d=[]),b=0;a>b;b++)d[b]=0;for(b=0;Yb+1>b;b++)e[b]=0;for(b=0;3>b;b++)f[b]=0;g.set(e.subarray(0,Yb),0),h.set(e.subarray(0,Yb+1),0)}var c,d,e,f,g,h,i=this;i.inflate_trees_bits=function(e,f,g,h,i){var j;return b(19),c[0]=0,j=a(e,0,19,19,null,null,g,f,h,c,d),j==lb?i.msg="oversubscribed dynamic bit lengths tree":(j==mb||0===f[0])&&(i.msg="incomplete dynamic bit lengths tree",j=lb),j},i.inflate_trees_dynamic=function(e,f,g,h,i,j,k,l,m){var n;return b(288),c[0]=0,n=a(g,0,e,257,Ub,Vb,j,h,l,c,d),n!=hb||0===h[0]?(n==lb?m.msg="oversubscribed literal/length tree":n!=Nb&&(m.msg="incomplete literal/length tree",n=lb),n):(b(288),n=a(g,e,f,0,Wb,Xb,k,i,l,c,d),n!=hb||0===i[0]&&e>257?(n==lb?m.msg="oversubscribed distance tree":n==mb?(m.msg="incomplete distance tree",n=lb):n!=Nb&&(m.msg="empty distance tree with lengths",n=lb),n):hb)}}function B(){function a(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;o=h.next_in_index,p=h.avail_in,m=g.bitb,n=g.bitk,q=g.write,r=q<g.read?g.read-q-1:g.end-q,s=Ob[a],t=Ob[b];do{for(;20>n;)p--,m|=(255&h.read_byte(o++))<<n,n+=8;if(i=m&s,j=c,k=d,x=3*(k+i),0!==(l=j[x]))for(;;){if(m>>=j[x+1],n-=j[x+1],0!==(16&l)){for(l&=15,u=j[x+2]+(m&Ob[l]),m>>=l,n-=l;15>n;)p--,m|=(255&h.read_byte(o++))<<n,n+=8;for(i=m&t,j=e,k=f,x=3*(k+i),l=j[x];;){if(m>>=j[x+1],n-=j[x+1],0!==(16&l)){for(l&=15;l>n;)p--,m|=(255&h.read_byte(o++))<<n,n+=8;if(v=j[x+2]+(m&Ob[l]),m>>=l,n-=l,r-=u,q>=v)w=q-v,q-w>0&&2>q-w?(g.window[q++]=g.window[w++],g.window[q++]=g.window[w++],u-=2):(g.window.set(g.window.subarray(w,w+2),q),q+=2,w+=2,u-=2);else{w=q-v;do w+=g.end;while(0>w);if(l=g.end-w,u>l){if(u-=l,q-w>0&&l>q-w){do g.window[q++]=g.window[w++];while(0!==--l)}else g.window.set(g.window.subarray(w,w+l),q),q+=l,w+=l,l=0;w=0}}if(q-w>0&&u>q-w){do g.window[q++]=g.window[w++];while(0!==--u)}else g.window.set(g.window.subarray(w,w+u),q),q+=u,w+=u,u=0;break}if(0!==(64&l))return h.msg="invalid distance code",u=h.avail_in-p,u=u>n>>3?n>>3:u,p+=u,o-=u,n-=u<<3,g.bitb=m,g.bitk=n,h.avail_in=p,h.total_in+=o-h.next_in_index,h.next_in_index=o,g.write=q,lb;i+=j[x+2],i+=m&Ob[l],x=3*(k+i),l=j[x]}break}if(0!==(64&l))return 0!==(32&l)?(u=h.avail_in-p,u=u>n>>3?n>>3:u,p+=u,o-=u,n-=u<<3,g.bitb=m,g.bitk=n,h.avail_in=p,h.total_in+=o-h.next_in_index,h.next_in_index=o,g.write=q,ib):(h.msg="invalid literal/length code",u=h.avail_in-p,u=u>n>>3?n>>3:u,p+=u,o-=u,n-=u<<3,g.bitb=m,g.bitk=n,h.avail_in=p,h.total_in+=o-h.next_in_index,h.next_in_index=o,g.write=q,lb);if(i+=j[x+2],i+=m&Ob[l],x=3*(k+i),0===(l=j[x])){m>>=j[x+1],n-=j[x+1],g.window[q++]=j[x+2],r--;break}}else m>>=j[x+1],n-=j[x+1],g.window[q++]=j[x+2],r--}while(r>=258&&p>=10);return u=h.avail_in-p,u=u>n>>3?n>>3:u,p+=u,o-=u,n-=u<<3,g.bitb=m,g.bitk=n,h.avail_in=p,h.total_in+=o-h.next_in_index,h.next_in_index=o,g.write=q,hb}var b,c,d,e,f=this,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0;f.init=function(a,f,g,h,i,j){b=Zb,m=a,n=f,d=g,o=h,e=i,p=j,c=null},f.proc=function(f,q,r){for(var s,t,u,v,w=f.bitb,x=f.bitk,y=q.next_in_index,z=q.avail_in,A=f.write,B=A<f.read?f.read-A-1:f.end-A;;)switch(b){case Zb:if(B>=258&&z>=10&&(f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,r=a(m,n,d,o,e,p,f,q),y=q.next_in_index,z=q.avail_in,w=f.bitb,x=f.bitk,A=f.write,B=A<f.read?f.read-A-1:f.end-A,r!=hb)){b=r==ib?ec:gc;break}i=m,c=d,h=o,b=$b;case $b:for(s=i;s>x;){if(0===z)return f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);r=hb,z--,w|=(255&q.read_byte(y++))<<x,x+=8}if(t=3*(h+(w&Ob[s])),w>>>=c[t+1],x-=c[t+1],u=c[t],0===u){j=c[t+2],b=dc;break}if(0!==(16&u)){k=15&u,g=c[t+2],b=_b;break}if(0===(64&u)){i=u,h=t/3+c[t+2];break}if(0!==(32&u)){b=ec;break}return b=gc,q.msg="invalid literal/length code",r=lb,f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);case _b:for(s=k;s>x;){if(0===z)return f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);r=hb,z--,w|=(255&q.read_byte(y++))<<x,x+=8}g+=w&Ob[s],w>>=s,x-=s,i=n,c=e,h=p,b=ac;case ac:for(s=i;s>x;){if(0===z)return f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);r=hb,z--,w|=(255&q.read_byte(y++))<<x,x+=8}if(t=3*(h+(w&Ob[s])),w>>=c[t+1],x-=c[t+1],u=c[t],0!==(16&u)){k=15&u,l=c[t+2],b=bc;break}if(0===(64&u)){i=u,h=t/3+c[t+2];break}return b=gc,q.msg="invalid distance code",r=lb,f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);case bc:for(s=k;s>x;){if(0===z)return f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);r=hb,z--,w|=(255&q.read_byte(y++))<<x,x+=8}l+=w&Ob[s],w>>=s,x-=s,b=cc;case cc:for(v=A-l;0>v;)v+=f.end;for(;0!==g;){if(0===B&&(A==f.end&&0!==f.read&&(A=0,B=A<f.read?f.read-A-1:f.end-A),0===B&&(f.write=A,r=f.inflate_flush(q,r),A=f.write,B=A<f.read?f.read-A-1:f.end-A,A==f.end&&0!==f.read&&(A=0,B=A<f.read?f.read-A-1:f.end-A),0===B)))return f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);f.window[A++]=f.window[v++],B--,v==f.end&&(v=0),g--}b=Zb;break;case dc:if(0===B&&(A==f.end&&0!==f.read&&(A=0,B=A<f.read?f.read-A-1:f.end-A),0===B&&(f.write=A,r=f.inflate_flush(q,r),A=f.write,B=A<f.read?f.read-A-1:f.end-A,A==f.end&&0!==f.read&&(A=0,B=A<f.read?f.read-A-1:f.end-A),0===B)))return f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);r=hb,f.window[A++]=j,B--,b=Zb;break;case ec:if(x>7&&(x-=8,z++,y--),f.write=A,r=f.inflate_flush(q,r),A=f.write,B=A<f.read?f.read-A-1:f.end-A,f.read!=f.write)return f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);b=fc;case fc:return r=ib,f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);case gc:return r=lb,f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r);default:return r=kb,f.bitb=w,f.bitk=x,q.avail_in=z,q.total_in+=y-q.next_in_index,q.next_in_index=y,f.write=A,f.inflate_flush(q,r)}},f.free=function(){}}function C(a,b){var c,d=this,e=ic,f=0,g=0,h=0,i=[0],j=[0],k=new B,l=0,m=new Int32Array(3*Pb),n=0,o=new A;d.bitk=0,d.bitb=0,d.window=new Uint8Array(b),d.end=b,d.read=0,d.write=0,d.reset=function(a,b){b&&(b[0]=n),e==nc&&k.free(a),e=ic,d.bitk=0,d.bitb=0,d.read=d.write=0},d.reset(a,null),d.inflate_flush=function(a,b){var c,e,f;return e=a.next_out_index,f=d.read,c=(f<=d.write?d.write:d.end)-f,c>a.avail_out&&(c=a.avail_out),0!==c&&b==mb&&(b=hb),a.avail_out-=c,a.total_out+=c,a.next_out.set(d.window.subarray(f,f+c),e),e+=c,f+=c,f==d.end&&(f=0,d.write==d.end&&(d.write=0),c=d.write-f,c>a.avail_out&&(c=a.avail_out),0!==c&&b==mb&&(b=hb),a.avail_out-=c,a.total_out+=c,a.next_out.set(d.window.subarray(f,f+c),e),e+=c,f+=c),a.next_out_index=e,d.read=f,b},d.proc=function(a,b){var n,p,q,r,s,t,u,v;for(r=a.next_in_index,s=a.avail_in,p=d.bitb,q=d.bitk,t=d.write,u=t<d.read?d.read-t-1:d.end-t;;)switch(e){case ic:for(;3>q;){if(0===s)return d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);b=hb,s--,p|=(255&a.read_byte(r++))<<q,q+=8}switch(n=7&p,l=1&n,n>>>1){case 0:p>>>=3,q-=3,n=7&q,p>>>=n,q-=n,e=jc;break;case 1:var w=[],x=[],y=[[]],z=[[]];A.inflate_trees_fixed(w,x,y,z,a),k.init(w[0],x[0],y[0],0,z[0],0,a),p>>>=3,q-=3,e=nc;break;case 2:p>>>=3,q-=3,e=kc;break;case 3:return p>>>=3,q-=3,e=qc,a.msg="invalid block type",b=lb,d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b)}break;case jc:for(;32>q;){if(0===s)return d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);b=hb,s--,p|=(255&a.read_byte(r++))<<q,q+=8}if((65535&~p>>>16)!=(65535&p))return e=qc,a.msg="invalid stored block lengths",b=lb,d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);f=65535&p,p=q=0,e=0!==f?qb:0!==l?oc:ic;break;case qb:if(0===s)return d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);if(0===u&&(t==d.end&&0!==d.read&&(t=0,u=t<d.read?d.read-t-1:d.end-t),0===u&&(d.write=t,b=d.inflate_flush(a,b),t=d.write,u=t<d.read?d.read-t-1:d.end-t,t==d.end&&0!==d.read&&(t=0,u=t<d.read?d.read-t-1:d.end-t),0===u)))return d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);if(b=hb,n=f,n>s&&(n=s),n>u&&(n=u),d.window.set(a.read_buf(r,n),t),r+=n,s-=n,t+=n,u-=n,0!==(f-=n))break;e=0!==l?oc:ic;break;case kc:for(;14>q;){if(0===s)return d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);b=hb,s--,p|=(255&a.read_byte(r++))<<q,q+=8}if(g=n=16383&p,(31&n)>29||(31&n>>5)>29)return e=qc,a.msg="too many length or distance symbols",b=lb,d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);if(n=258+(31&n)+(31&n>>5),!c||c.length<n)c=[];else for(v=0;n>v;v++)c[v]=0;p>>>=14,q-=14,h=0,e=lc;case lc:for(;4+(g>>>10)>h;){for(;3>q;){if(0===s)return d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);b=hb,s--,p|=(255&a.read_byte(r++))<<q,q+=8}c[hc[h++]]=7&p,p>>>=3,q-=3}for(;19>h;)c[hc[h++]]=0;if(i[0]=7,n=o.inflate_trees_bits(c,i,j,m,a),n!=hb)return b=n,b==lb&&(c=null,e=qc),d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);h=0,e=mc;case mc:for(;;){if(n=g,!(258+(31&n)+(31&n>>5)>h))break;var B,C;for(n=i[0];n>q;){if(0===s)return d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);b=hb,s--,p|=(255&a.read_byte(r++))<<q,q+=8}if(n=m[3*(j[0]+(p&Ob[n]))+1],C=m[3*(j[0]+(p&Ob[n]))+2],16>C)p>>>=n,q-=n,c[h++]=C;else{for(v=18==C?7:C-14,B=18==C?11:3;n+v>q;){if(0===s)return d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);b=hb,s--,p|=(255&a.read_byte(r++))<<q,q+=8}if(p>>>=n,q-=n,B+=p&Ob[v],p>>>=v,q-=v,v=h,n=g,v+B>258+(31&n)+(31&n>>5)||16==C&&1>v)return c=null,e=qc,a.msg="invalid bit length repeat",b=lb,d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);C=16==C?c[v-1]:0;do c[v++]=C;while(0!==--B);h=v}}j[0]=-1;var D=[],E=[],F=[],G=[];if(D[0]=9,E[0]=6,n=g,n=o.inflate_trees_dynamic(257+(31&n),1+(31&n>>5),c,D,E,F,G,m,a),n!=hb)return n==lb&&(c=null,e=qc),b=n,d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);k.init(D[0],E[0],m,F[0],m,G[0],a),e=nc;case nc:if(d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,(b=k.proc(d,a,b))!=ib)return d.inflate_flush(a,b);if(b=hb,k.free(a),r=a.next_in_index,s=a.avail_in,p=d.bitb,q=d.bitk,t=d.write,u=t<d.read?d.read-t-1:d.end-t,0===l){e=ic;break}e=oc;case oc:if(d.write=t,b=d.inflate_flush(a,b),t=d.write,u=t<d.read?d.read-t-1:d.end-t,d.read!=d.write)return d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);e=pc;case pc:return b=ib,d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);case qc:return b=lb,d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b);default:return b=kb,d.bitb=p,d.bitk=q,a.avail_in=s,a.total_in+=r-a.next_in_index,a.next_in_index=r,d.write=t,d.inflate_flush(a,b)}},d.free=function(a){d.reset(a,null),d.window=null,m=null},d.set_dictionary=function(a,b,c){d.window.set(a.subarray(b,b+c),0),d.read=d.write=c},d.sync_point=function(){return e==jc?1:0}}function D(){function a(a){return a&&a.istate?(a.total_in=a.total_out=0,a.msg=null,a.istate.mode=yc,a.istate.blocks.reset(a,null),hb):kb}var b=this;b.mode=0,b.method=0,b.was=[0],b.need=0,b.marker=0,b.wbits=0,b.inflateEnd=function(a){return b.blocks&&b.blocks.free(a),b.blocks=null,hb},b.inflateInit=function(c,d){return c.msg=null,b.blocks=null,8>d||d>15?(b.inflateEnd(c),kb):(b.wbits=d,c.istate.blocks=new C(c,1<<d),a(c),hb)},b.inflate=function(a,b){var c,d;if(!a||!a.istate||!a.next_in)return kb;for(b=b==gb?mb:hb,c=mb;;)switch(a.istate.mode){case rc:if(0===a.avail_in)return c;if(c=b,a.avail_in--,a.total_in++,(15&(a.istate.method=a.read_byte(a.next_in_index++)))!=Db){a.istate.mode=Ac,a.msg="unknown compression method",a.istate.marker=5;break}if((a.istate.method>>4)+8>a.istate.wbits){a.istate.mode=Ac,a.msg="invalid window size",a.istate.marker=5;break}a.istate.mode=sc;case sc:if(0===a.avail_in)return c;if(c=b,a.avail_in--,a.total_in++,d=255&a.read_byte(a.next_in_index++),0!==((a.istate.method<<8)+d)%31){a.istate.mode=Ac,a.msg="incorrect header check",a.istate.marker=5;break}if(0===(d&zb)){a.istate.mode=yc;break}a.istate.mode=tc;case tc:if(0===a.avail_in)return c;c=b,a.avail_in--,a.total_in++,a.istate.need=4278190080&(255&a.read_byte(a.next_in_index++))<<24,a.istate.mode=uc;case uc:if(0===a.avail_in)return c;c=b,a.avail_in--,a.total_in++,a.istate.need+=16711680&(255&a.read_byte(a.next_in_index++))<<16,a.istate.mode=vc;case vc:if(0===a.avail_in)return c;c=b,a.avail_in--,a.total_in++,a.istate.need+=65280&(255&a.read_byte(a.next_in_index++))<<8,a.istate.mode=wc;case wc:return 0===a.avail_in?c:(c=b,a.avail_in--,a.total_in++,a.istate.need+=255&a.read_byte(a.next_in_index++),a.istate.mode=xc,jb);case xc:return a.istate.mode=Ac,a.msg="need dictionary",a.istate.marker=0,kb;case yc:if(c=a.istate.blocks.proc(a,c),c==lb){a.istate.mode=Ac,a.istate.marker=0;break}if(c==hb&&(c=b),c!=ib)return c;c=b,a.istate.blocks.reset(a,a.istate.was),a.istate.mode=zc;case zc:return ib;case Ac:return lb;default:return kb}},b.inflateSetDictionary=function(a,b,c){var d=0,e=c;return a&&a.istate&&a.istate.mode==xc?(e>=1<<a.istate.wbits&&(e=(1<<a.istate.wbits)-1,d=c-e),a.istate.blocks.set_dictionary(b,d,e),a.istate.mode=yc,hb):kb},b.inflateSync=function(b){var c,d,e,f,g;if(!b||!b.istate)return kb;if(b.istate.mode!=Ac&&(b.istate.mode=Ac,b.istate.marker=0),0===(c=b.avail_in))return mb;for(d=b.next_in_index,e=b.istate.marker;0!==c&&4>e;)b.read_byte(d)==Bc[e]?e++:e=0!==b.read_byte(d)?0:4-e,d++,c--;return b.total_in+=d-b.next_in_index,b.next_in_index=d,b.avail_in=c,b.istate.marker=e,4!=e?lb:(f=b.total_in,g=b.total_out,a(b),b.total_in=f,b.total_out=g,b.istate.mode=yc,hb)},b.inflateSyncPoint=function(a){return a&&a.istate&&a.istate.blocks?a.istate.blocks.sync_point():kb}}function y(){}function E(){var a=this,b=new y,c=512,d=db,e=new Uint8Array(c),f=!1;b.inflateInit(),b.next_out=e,a.append=function(a,g){var h,i,j=[],k=0,l=0,m=0;if(0!==a.length){b.next_in_index=0,b.next_in=a,b.avail_in=a.length;do{if(b.next_out_index=0,b.avail_out=c,0!==b.avail_in||f||(b.next_in_index=0,f=!0),h=b.inflate(d),f&&h==mb)return-1;if(h!=hb&&h!=ib)throw"inflating: "+b.msg;if((f||h==ib)&&b.avail_out==a.length)return-1;b.next_out_index&&(b.next_out_index==c?j.push(new Uint8Array(e)):j.push(new Uint8Array(e.subarray(0,b.next_out_index)))),m+=b.next_out_index,g&&b.next_in_index>0&&b.next_in_index!=k&&(g(b.next_in_index),k=b.next_in_index)}while(b.avail_in>0||0===b.avail_out);return i=new Uint8Array(m),j.forEach(function(a){i.set(a,l),l+=a.length}),i}},a.flush=function(){b.inflateEnd()}}var F,G="File format is not recognized.",H="File contains encrypted entry.",I="File is using Zip64 (4gb+ file size).",J="Error while reading zip file.",K="Error while writing file data.",L="Error while reading file data.",M=524288,N=a.Blob;
d.prototype.table=function(){var a,b,c,d=[];for(a=0;256>a;a++){for(c=a,b=0;8>b;b++)1&c?c=3988292384^c>>>1:c>>>=1;d[a]=c}return d}(),h.prototype=new g,h.prototype.constructor=h,i.prototype.getData=function(a){a(this.data)},j.prototype=new i,j.prototype.constructor=j,b.zip={Reader:g,Writer:i,BlobReader:h,BlobWriter:j,createReader:function(a,b,c){a.init(function(){b(s(a,c))},c)}};var O=15,P=30,Q=19,R=29,S=256,T=S+1+R,U=2*T+1,V=256,W=7,X=16,Y=17,Z=18,$=16,_=-1,ab=1,bb=2,cb=0,db=0,eb=1,fb=3,gb=4,hb=0,ib=1,jb=2,kb=-2,lb=-3,mb=-5,nb=[0,1,2,3,4,4,5,5,6,6,6,6,7,7,7,7,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,0,0,16,17,18,18,19,19,20,20,20,20,21,21,21,21,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29];t._length_code=[0,1,2,3,4,5,6,7,8,8,9,9,10,10,11,11,12,12,12,12,13,13,13,13,14,14,14,14,15,15,15,15,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28],t.base_length=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0],t.base_dist=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576],t.d_code=function(a){return 256>a?nb[a]:nb[256+(a>>>7)]},t.extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],t.extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],t.extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],t.bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],u.static_ltree=[12,8,140,8,76,8,204,8,44,8,172,8,108,8,236,8,28,8,156,8,92,8,220,8,60,8,188,8,124,8,252,8,2,8,130,8,66,8,194,8,34,8,162,8,98,8,226,8,18,8,146,8,82,8,210,8,50,8,178,8,114,8,242,8,10,8,138,8,74,8,202,8,42,8,170,8,106,8,234,8,26,8,154,8,90,8,218,8,58,8,186,8,122,8,250,8,6,8,134,8,70,8,198,8,38,8,166,8,102,8,230,8,22,8,150,8,86,8,214,8,54,8,182,8,118,8,246,8,14,8,142,8,78,8,206,8,46,8,174,8,110,8,238,8,30,8,158,8,94,8,222,8,62,8,190,8,126,8,254,8,1,8,129,8,65,8,193,8,33,8,161,8,97,8,225,8,17,8,145,8,81,8,209,8,49,8,177,8,113,8,241,8,9,8,137,8,73,8,201,8,41,8,169,8,105,8,233,8,25,8,153,8,89,8,217,8,57,8,185,8,121,8,249,8,5,8,133,8,69,8,197,8,37,8,165,8,101,8,229,8,21,8,149,8,85,8,213,8,53,8,181,8,117,8,245,8,13,8,141,8,77,8,205,8,45,8,173,8,109,8,237,8,29,8,157,8,93,8,221,8,61,8,189,8,125,8,253,8,19,9,275,9,147,9,403,9,83,9,339,9,211,9,467,9,51,9,307,9,179,9,435,9,115,9,371,9,243,9,499,9,11,9,267,9,139,9,395,9,75,9,331,9,203,9,459,9,43,9,299,9,171,9,427,9,107,9,363,9,235,9,491,9,27,9,283,9,155,9,411,9,91,9,347,9,219,9,475,9,59,9,315,9,187,9,443,9,123,9,379,9,251,9,507,9,7,9,263,9,135,9,391,9,71,9,327,9,199,9,455,9,39,9,295,9,167,9,423,9,103,9,359,9,231,9,487,9,23,9,279,9,151,9,407,9,87,9,343,9,215,9,471,9,55,9,311,9,183,9,439,9,119,9,375,9,247,9,503,9,15,9,271,9,143,9,399,9,79,9,335,9,207,9,463,9,47,9,303,9,175,9,431,9,111,9,367,9,239,9,495,9,31,9,287,9,159,9,415,9,95,9,351,9,223,9,479,9,63,9,319,9,191,9,447,9,127,9,383,9,255,9,511,9,0,7,64,7,32,7,96,7,16,7,80,7,48,7,112,7,8,7,72,7,40,7,104,7,24,7,88,7,56,7,120,7,4,7,68,7,36,7,100,7,20,7,84,7,52,7,116,7,3,8,131,8,67,8,195,8,35,8,163,8,99,8,227,8],u.static_dtree=[0,5,16,5,8,5,24,5,4,5,20,5,12,5,28,5,2,5,18,5,10,5,26,5,6,5,22,5,14,5,30,5,1,5,17,5,9,5,25,5,5,5,21,5,13,5,29,5,3,5,19,5,11,5,27,5,7,5,23,5],u.static_l_desc=new u(u.static_ltree,t.extra_lbits,S+1,T,O),u.static_d_desc=new u(u.static_dtree,t.extra_dbits,0,P,O),u.static_bl_desc=new u(null,t.extra_blbits,0,Q,W);var ob=9,pb=8,qb=0,rb=1,sb=2,tb=[new v(0,0,0,0,qb),new v(4,4,8,4,rb),new v(4,5,16,8,rb),new v(4,6,32,32,rb),new v(4,4,16,16,sb),new v(8,16,32,32,sb),new v(8,16,128,128,sb),new v(8,32,128,256,sb),new v(32,128,258,1024,sb),new v(32,258,258,4096,sb)],ub=["need dictionary","stream end","","","stream error","data error","","buffer error","",""],vb=0,wb=1,xb=2,yb=3,zb=32,Ab=42,Bb=113,Cb=666,Db=8,Eb=0,Fb=1,Gb=2,Hb=0,Ib=1,Jb=2,Kb=3,Lb=258,Mb=Lb+Kb+1;y.prototype={deflateInit:function(a,b){var c=this;return c.dstate=new x,b||(b=O),c.dstate.deflateInit(c,a,b)},deflate:function(a){var b=this;return b.dstate?b.dstate.deflate(b,a):kb},deflateEnd:function(){var a=this;if(!a.dstate)return kb;var b=a.dstate.deflateEnd();return a.dstate=null,b},deflateParams:function(a,b){var c=this;return c.dstate?c.dstate.deflateParams(c,a,b):kb},deflateSetDictionary:function(a,b){var c=this;return c.dstate?c.dstate.deflateSetDictionary(c,a,b):kb},read_buf:function(a,b,c){var d=this,e=d.avail_in;return e>c&&(e=c),0===e?0:(d.avail_in-=e,a.set(d.next_in.subarray(d.next_in_index,d.next_in_index+e),b),d.next_in_index+=e,d.total_in+=e,e)},flush_pending:function(){var a=this,b=a.dstate.pending;b>a.avail_out&&(b=a.avail_out),0!==b&&(a.next_out.set(a.dstate.pending_buf.subarray(a.dstate.pending_out,a.dstate.pending_out+b),a.next_out_index),a.next_out_index+=b,a.dstate.pending_out+=b,a.total_out+=b,a.avail_out-=b,a.dstate.pending-=b,0===a.dstate.pending&&(a.dstate.pending_out=0))}},b.zip.Deflater=z;var O=15,hb=0,ib=1,jb=2,kb=-2,lb=-3,Nb=-4,mb=-5,Ob=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],Pb=1440,db=0,gb=4,Qb=9,Rb=5,Sb=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],Tb=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],Ub=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Vb=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],Wb=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Xb=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Yb=15;A.inflate_trees_fixed=function(a,b,c,d){return a[0]=Qb,b[0]=Rb,c[0]=Sb,d[0]=Tb,hb};var Zb=0,$b=1,_b=2,ac=3,bc=4,cc=5,dc=6,ec=7,fc=8,gc=9,hc=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ic=0,jc=1,qb=2,kc=3,lc=4,mc=5,nc=6,oc=7,pc=8,qc=9,zb=32,Db=8,rc=0,sc=1,tc=2,uc=3,vc=4,wc=5,xc=6,yc=7,zc=12,Ac=13,Bc=[0,0,255,255];y.prototype={inflateInit:function(a){var b=this;return b.istate=new D,a||(a=O),b.istate.inflateInit(b,a)},inflate:function(a){var b=this;return b.istate?b.istate.inflate(b,a):kb},inflateEnd:function(){var a=this;if(!a.istate)return kb;var b=a.istate.inflateEnd(a);return a.istate=null,b},inflateSync:function(){var a=this;return a.istate?a.istate.inflateSync(a):kb},inflateSetDictionary:function(a,b){var c=this;return c.istate?c.istate.inflateSetDictionary(c,a,b):kb},read_byte:function(a){var b=this;return b.next_in.subarray(a,a+1)[0]},read_buf:function(a,b){var c=this;return c.next_in.subarray(a,a+b)}},b.zip.Inflater=E;var O=15,hb=0,ib=1,jb=2,kb=-2,lb=-3,Nb=-4,mb=-5,Ob=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],Pb=1440,db=0,gb=4,Qb=9,Rb=5,Sb=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],Tb=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],Ub=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Vb=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],Wb=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Xb=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Yb=15;A.inflate_trees_fixed=function(a,b,c,d){return a[0]=Qb,b[0]=Rb,c[0]=Sb,d[0]=Tb,hb};var Zb=0,$b=1,_b=2,ac=3,bc=4,cc=5,dc=6,ec=7,fc=8,gc=9,hc=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ic=0,jc=1,qb=2,kc=3,lc=4,mc=5,nc=6,oc=7,pc=8,qc=9,zb=32,Db=8,rc=0,sc=1,tc=2,uc=3,vc=4,wc=5,xc=6,yc=7,zc=12,Ac=13,Bc=[0,0,255,255];y.prototype={inflateInit:function(a){var b=this;return b.istate=new D,a||(a=O),b.istate.inflateInit(b,a)},inflate:function(a){var b=this;return b.istate?b.istate.inflate(b,a):kb},inflateEnd:function(){var a=this;if(!a.istate)return kb;var b=a.istate.inflateEnd(a);return a.istate=null,b},inflateSync:function(){var a=this;return a.istate?a.istate.inflateSync(a):kb},inflateSetDictionary:function(a,b){var c=this;return c.istate?c.istate.inflateSetDictionary(c,a,b):kb},read_byte:function(a){var b=this;return b.next_in.subarray(a,a+1)[0]},read_buf:function(a,b){var c=this;return c.next_in.subarray(a,a+b)}},b.zip.Inflater=E}(a,d),d.zipEngine={_getEntryFile:function(a,b,c,e){a.getData(new d.zip.BlobWriter,function(b){c(a,b)},e)},read:function(a){d.zip.createReader(new d.zip.BlobReader(a.file),function(b){b.getEntries(function(b){"function"==typeof a.success&&a.success(b)})},function(){"function"==typeof a.error&&a.error()})},readEntry:function(a){var b=this;this._getEntryFile(a.entry,a.type,function(){"function"==typeof a.success&&a.success.apply(b,arguments)})}},d.DOM={find:function(a,b){var c,d;if(!a||!a.childNodes||!b)return null;if(d=a.childNodes.length,!d)return null;for(c=0;d>c;c++)if(a.childNodes[c].localName==b||a.childNodes[c].nodeName==b)return a.childNodes[c];return null},findAll:function(a,b){var c,d,e=[];if(!a||!a.childNodes||!b)return null;if(d=a.childNodes.length,!d)return null;for(c=0;d>c;c++)(a.childNodes[c].localName==b||a.childNodes[c].nodeName==b)&&e.push(a.childNodes[c]);return e},children:function(a){return a?this.sibling(a.firstChild):[]},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c},_vendorPrefix:{boxSizing:["moz","o","ms","webkit"]},_addVendorPrefix:function(a,b,c){var d;for(d=this._vendorPrefix[b].length-1;d>=0;d--)a.style[this._vendorPrefix[b][d]]=c;return a.style[b]=c,a},_prepareCSSProperty:function(a){for(var b=/-(\w)/g,c=a,d=b.exec(c);d;)c=c.replace("-"+d[1],d[1].toUpperCase()),d=b.exec(c);return c},css:function(a,b,c){var d;if(!a)return a;if("object"==typeof b)for(d in b)d=this._prepareCSSProperty(d),this._vendorPrefix[d]&&this._addVendorPrefix(a,d,b[d]),a.style[d]=b[d];else b=this._prepareCSSProperty(b),this._vendorPrefix[b]&&this._addVendorPrefix(a,b,c),a.style[b]=c;return a}},d.Engine=function(){this.initialize.apply(this,arguments)},d.Engine.prototype={_fileTypeParsers:[],_effectPatterns:{blinkBackground:"blinkBackgroundAnimation",lights:"lightsAnimation",antsBlack:"blackDashedLineAnimation",antsRed:"redDashedLineAnimation",shimmer:"shimmerAnimation",sparkle:"sparkleAnimation",none:"none"},_shadowPatterns:{nil:null,clear:null,solid:"0 0 5px 0",horzStripe:"5px 0 5px 0",vertStripe:"0 5px 5px 0",reverseDiagStripe:"-5px -5px 5px 0",diagStripe:"5px 5px 5px 0",thinHorzStripe:"1px 0 1px 0",thinVertStripe:"0 1px 1px 0",thinReverseDiagStripe:"-1px -1px 1px 0",thinDiagStripe:"1px 1px 1px 0"},_errors:{invalidFileType:{message:"Invalid file format"},invalidReadZIPFile:{message:"Can not read file"}},options:{isValid:!1,fileType:"",page:{width:641,height:971,fontSize:14,paddingTop:76,paddingRight:57,paddingBottom:76,paddingLeft:113,marginTop:20},paragraph:{paddingTop:5,paddingRight:0,paddingBottom:5,paddingLeft:0,textIndent:30}},initialize:function(a){var b=this._getFileType(a);return b?(this.file=a,this.options.isValid=!0,this.options.fileType=b):this.options.isValid=!1,this},parse:function(a){var b=this;return"function"==typeof a.start&&a.start(),this.validate()?(this._readFilesFromZIP({success:function(c){b._createParsedFile(c,function(b){"function"==typeof a.success&&a.success(b),"function"==typeof a.complete&&a.complete()})},error:function(){"function"==typeof a.error&&a.error(this._errors.invalidReadZIPFile),"function"==typeof a.complete&&a.complete()}.bind(this)}),null):("function"==typeof a.error&&a.error(this._errors.invalidFileType),"function"==typeof a.complete&&a.complete(),!1)},validate:function(){return!!this.options.isValid},_prepareParsedFile:function(){},_parseStyleAttribute:function(){},isTextDocument:function(){return!(!this.options.fileType||!this.options.fileType.isTextDocument)},isTemplate:function(){return!(!this.options.fileType||!this.options.fileType.isTemplate)},isGraphicDocument:function(){return!(!this.options.fileType||!this.options.fileType.isGraphicDocument)},isPresentationDocument:function(){return!(!this.options.fileType||!this.options.fileType.isPresentationDocument)},isSpreadsheetDocument:function(){return!(!this.options.fileType||!this.options.fileType.isSpreadsheetDocument)},isChartDocument:function(){return!(!this.options.fileType||!this.options.fileType.isChartDocument)},isImageDocument:function(){return!(!this.options.fileType||!this.options.fileType.isImageDocument)},isFormulaDocument:function(){return!(!this.options.fileType||!this.options.fileType.isFormulaDocument)},isTextDocumentMaster:function(){return this.options.fileType&&!!this.options.fileType.isTextDocumentMaster},isTextDocumentMasterWeb:function(){return this.options.fileType&&!!this.options.fileType.isTextDocumentMasterWeb},_getFileNameFromPath:function(a){return(a||"").replace(/^.+\//,"")||a},_cropUnits:function(a){return a=+String(a).replace(/,/g,".").replace(/[^0-9.]+/g,""),isNaN(a)?0:a},_getFileTypeByExtension:function(a){return{isImage:/.jpeg|.jpg/i.test(a)}},_getFileValidationError:function(a){return this._getFileType(a)?null:this._errors.invalidFileType},_getWordsCountInText:function(a){var b,c=(a||"").split(/\s+/),d=c.length,e=0;for(b=d-1;b>=0;b--)e+=c[b].length>1;return e},_normalizeDataURI:function(a,b){return a.replace(/data:[^;]*;/,"data:"+this._getFileMimeType(b)+";")},_getFileMimeType:function(a){var b=/[a-z]+$/i.exec(a),c="";if(b)switch(b=b[0].toLowerCase()){case"png":c="image/png";break;case"jpg":case"jpeg":c="image/jpeg";break;case"gif":c="image/gif"}return c},_normalizeDate:function(a){var b,c="";return a&&/^[0-9]{4}-(0[1-9]|1[0-2])-([0-2][0-9]|3[01])$/.test(a)&&(b=a.split("-"),c=b[2]+"."+b[1]+"."+b[0]),c},_normalizeVerticalAlign:function(a){var b="baseline";return a=String(a).toLowerCase(),"superscript"==a?b="top":"subscript"==a&&(b="bottom"),b},_normalizeEncodingValue:function(a){var b="utf-8";return a&&(a=a.toLowerCase(),"windows-1251"==a&&(b="cp1251")),b},_parseShadowProperty:function(a){var b="none";return a&&a.attributes["w:val"]&&a.attributes["w:color"]&&this._shadowPatterns[a.attributes["w:val"].value]&&(b=this._shadowPatterns[a.attributes["w:val"].value]+" "+a.attributes["w:color"]),b},_getFileType:function(a){var b,c,d,e,f=null,g=String(a.name).split("."),h=this._fileTypeParsers.length,i=!1;for(g=g[g.length-1],e=0;h>e;e++){if(a.type)for(c=this._fileTypeParsers[e].mime,c instanceof Array||(c=[c]),d=c.length-1;d>=0;d--)if(a.type.indexOf(c[d])>=0){i=!0;break}if(!i&&!a.type&&g)for(b=this._fileTypeParsers[e].extension,b instanceof Array||(b=[b]),d=b.length-1;d>=0;d--)if(g.indexOf(b[d])>=0){i=!0;break}if(i){f=this._fileTypeParsers[e];break}}return f},_parseLanguageNode:function(a){var b={latin:null,eastAsia:null,complexLanguage:null};return a&&(b.latin=a.attributes["w:val"]?a.attributes["w:val"]||b.latin:b.latin,b.complexLanguage=a.attributes["w:bidi"]?a.attributes["w:bidi"]||b.complexLanguage:b.complexLanguage,b.eastAsia=a.attributes["w:eastAsia"]?a.attributes["w:eastAsia"]||b.eastAsia:b.eastAsia),b},_addCssRule:function(a,b,c){return"boxShadow"===b&&(a.webkitBoxShadow=c,a.mozBoxShadow=c,a.oBoxShadow=c,a.msBoxShadow=c,a.boxShadow=c),a},_parseStyleEffectProperty:function(a){return a&&a.attributes["w:val"]?this._effectPatterns[a.attributes["w:val"]]||"none":"none"},_replaceAttributeNamespace:function(a){return a?a.replace(/^[0-9a-zA-Z-_]+:/,""):""},_spotElementHeight:function(a){a=a||{},a.lineHeight=a.lineHeight||1,a.parentFontSize=a.parentFontSize||1;var b=a.el.textContent?a.el.textContent.length:0,c=b*a.fontSize/a.width*(a.fontSize>a.parentFontSize?a.fontSize:a.parentFontSize)*a.lineHeight;return isNaN(c)?0:Math.round(c)}},d.Engine.extend=function(a){var b,c=function(){},d=function(){},e=this;c=this&&this.hasOwnProperty("constructor")?this.constructor:function(){e.apply(this,arguments)},d.prototype=this.prototype,c.prototype=new d,c.prototype.constructor=c;for(b in a)a.hasOwnProperty(b)&&(c.prototype[b]=a[b]);return c},d.Engine.prototype._getCharFromHex=function(a){var b=parseInt(a,16);return isNaN(b)?"":String.fromCharCode(b)},d.Engine.prototype._getHalfTabAsSpaces=function(){return"  "},d.Engine.prototype._getNonbreakingSpace=function(){return" "},d.Engine.prototype._getTabAsSpaces=function(){var a=this._getHalfTabAsSpaces();return a+a},d.Engine.prototype._normalizeColorValue=function(a){var b=this._colorList.black;return a&&"string"==typeof a?(a=a.replace(/\s+/g,""),/^#/.test(a)?a.toUpperCase():isNaN(+("0x"+a))?(a=a.toLowerCase(),this._colorList[a]||b):"#"+a.toUpperCase()):b},d.Engine.prototype._colorList={black:"#000000",navy:"#000080",darkblue:"#00008B",mediumblue:"#0000CD",blue:"#0000FF",darkgreen:"#006400",green:"#008000",teal:"#008080",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",lime:"#00FF00",springgreen:"#00FF7F",aqua:"#00FFFF",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",white:"#FFFFFF",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",mediumaquamarine:"#66CDAA",dimgray:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",lightslategray:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",maroon:"#800000",purple:"#800080",olive:"#808000",gray:"#808080",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370D8",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",silver:"#C0C0C0",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgray:"#D3D3D3",palevioletred:"#D87093",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EE82EE",airforceblue:"#5D8AA8",aliceblue:"#F0F8FF",alizarincrimson:"#E32636",almond:"#EFDECD",amaranth:"#E52B50",lightcoral:"#F08080",khaki:"#F0E68C",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiqueWhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",red:"#FF0000",fuchsia:"#FF00FF",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightSalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",yellow:"#FFFF00",lightyellow:"#FFFFE0",ivory:"#FFFFF0",none:"inherit"},d.Engine.prototype._readFilesFromZIP=function(a){var b=[];d.zipEngine.read({file:this.file,success:function(c){var e,f=0,g=c.length;for(e=0;g>e;e++)d.zipEngine.readEntry({entry:c[e],type:"Blob",success:function(c,d,e){return d&&b.push({entry:c,file:d,blobURL:e}),f++,f==g?("function"==typeof a.success&&a.success(b),null):null}})},error:function(){"function"==typeof a.error&&a.error()}})},d.Engines.DSV=d.Engine.extend({_createParsedFile:function(a,b){var c,e,f,g,h,i,j,k,l,m=this.options.fileType.delimiterType||"comma",n="",o="DSV_DELIMITER_ESCAPED",p=/".*(,).*"/g,q={options:{isTable:!0},header:{rows:[{cells:[],css:{},options:{},dimensionCSSRules:{}}]},body:{rows:[]},footer:{rows:[]},attributes:{},dimensionCSSRules:{},css:{}};if("comma"===m)for(c=/,/,n=",",e=p.exec(a);e&&e[0]&&e[1];)f=e[0].replace(/,/g,o),a=a.replace(e[0],f),e=p.exec(a);else"tab"===m&&(c=/\t/,n=this._getTabAsSpaces());for(k=a.split(/\n+/),l=k[0].split(c),j=l.length,g=0;j>g;g++)q.header.rows[0].cells[g]={css:{},dimensionCSSRules:{},options:{},elements:[{options:{},properties:{textContent:l[g].replace(/DSV_DELIMITER_ESCAPED/g,n)}}]};for(i=k.length,h=1;i>h;h++)for(l=k[h].split(c),j=l.length,q.body.rows[h-1]={cells:[],css:{},options:{},dimensionCSSRules:{}},g=0;j>g;g++)q.body.rows[h-1].cells[g]={css:{},dimensionCSSRules:{},options:{},elements:[{options:{},properties:{textContent:l[g].replace(/DSV_DELIMITER_ESCAPED/g,n)}}]};"function"==typeof b&&b(new d.ParsedFile({pages:[{options:{},css:{},elements:[q]}]}))},_fileTypeParsers:[{extension:["csv"],mime:["text/csv"],delimiterType:"comma",isTextDocument:!0},{extension:["tsv","tab"],mime:["text/tab-separated-values"],delimiterType:"tab",isTextDocument:!0}],parse:function(a){var b,c;return"function"==typeof a.start&&a.start(),this.validate()?(b=new FileReader,c=this,b.onload=function(b){c._createParsedFile(b.target.result,function(b){"function"==typeof a.success&&a.success(b),"function"==typeof a.complete&&a.complete()})},b.readAsText(this.file)):("function"==typeof a.error&&a.error(this._errors.invalidFileType),"function"==typeof a.complete&&a.complete()),null}}),d.Engines.FictionBook=d.Engine.extend({_createParsedFile:function(a,b){var c,e,f,g={binaryItems:this._parseBinaryItems(a.querySelectorAll("binary"))},h={pages:[{options:{},css:{},dimensionCSSRules:{},elements:[]}],options:{},css:{},dimensionCSSRules:{}};for(c=d.DOM.children(a.querySelector("FictionBook")),f=c.length,e=0;f>e;e++)switch(c[e].localName){case"description":var i=a.querySelector("description");g.publishInfo=this._parsePublishInfo(i.querySelector("publish-info")),g.fileInfo=this._parseFileInfo(i.querySelector("title-info"),g),g.documentInfo=this._parseDocumentInfo(i.querySelector("document-info"),g),g.fileInfo.annotation&&h.pages[0].elements.push(g.fileInfo.annotation),g.fileInfo.coverpage&&g.binaryItems[g.fileInfo.coverpage.image]&&h.pages[0].elements.push({options:{},elements:[this._prepareImage({documentData:g,imageName:g.fileInfo.coverpage.image})]});
break;case"body":this._parsePages(c[e],g,h.pages[0].elements)}"function"==typeof b&&b(new d.ParsedFile(h))},_fileTypeParsers:[{extension:["fb2"],mime:["application/x-fictionbook+xml"],isTextDocument:!0}],_getPersonInfo:function(a){var b,c=d.DOM.children(a),e=c.length,f={};for(b=e-1;b>=0;b--)c[b].localName&&(f[c[b].localName.replace(/-\w+$/,"")+"Name"]=c[b].textContent||"");return f},_normalizeEncodingValue:function(a){var b="utf-8";return a&&(b=a.replace(/^windows-/i,"cp")),b},_parseBinaryItems:function(a){var b,c={};for(b=a.length-1;b>=0;b--)a[b].attributes.id&&a[b].attributes.id.value&&a[b].attributes["content-type"]&&a[b].attributes["content-type"].value&&a[b].textContent&&(c[a[b].attributes.id.value]="data:"+a[b].attributes["content-type"].value+";base64,"+a[b].textContent);return c},_parseBlockElement:function(a){var b;switch(a.node.localName){case"p":b=this._parseParagraph({node:a.node,documentData:a.documentData});break;case"empty-line":b={options:{isEmptyLine:!0}};break;case"subtitle":b=this._parseParagraph({node:a.node,documentData:a.documentData}),b.css.textAlign="center";break;case"image":b=this._prepareImage({node:a.node,documentData:a.documentData});break;default:b=this._prepareBlock(a.node,a.documentData)}return b},_parseDocumentInfo:function(a,b){var c,e,f,g,h,i=d.DOM.children(a),j=i.length,k={isTextDocument:!0,programs:[]};for(c=j-1;c>=0;c--)switch(i[c].localName){case"author":k.author=this._getPersonInfo(i[c]);break;case"src-url":k.sourceURL=i[c].textContent||"";break;case"id":k.id=i[c].textContent||"";break;case"version":k.version=i[c].textContent||"";break;case"history":k.history=this._prepareBlock(i[c],b);break;case"date":g=(i[c].textContent||"").split("-"),h=g[0],g[0]=g[2],g[2]=h,k.date=g.join(".");break;case"program-used":for(g=(i[c].textContent||"").split(","),f=g.length,e=f-1;e>=0;e--)k.programs[e]=g[e].replace(/^\s+/,"")}return k},_parseFileHelper:function(a,b){var c=new DOMParser;this._createParsedFile(c.parseFromString(a,"application/xml"),function(a){"function"==typeof b.success&&b.success(a),"function"==typeof b.complete&&b.complete()})},_parseFileInfo:function(a,b){var c,e={},f=d.DOM.children(a),g=f.length;for(c=g-1;c>=0;c--)switch(f[c].localName){case"genre":e.genre=f[c].textContent||"";break;case"book-title":e.title=f[c].textContent||"";break;case"lang":e.language=f[c].textContent||"";break;case"src-lang":e.sourceLanguage=f[c].textContent||"";break;case"author":e.author=this._getPersonInfo(f[c]);break;case"translator":e.translator=this._getPersonInfo(f[c]);break;case"annotation":e.annotation=this._prepareBlock(f[c],b);break;case"date":e.date=f[c].textContent||"";break;case"coverpage":var h=f[c].querySelector("image");e.coverpage={image:h.attributes["l:href"]?(h.attributes["l:href"].value||"").replace("#",""):""};break;case"sequence":e.sequence={name:f[c].attributes.name?f[c].attributes.name.value||"":"",number:f[c].attributes.number?isNaN(f[c].attributes.number.value)?0:+f[c].attributes.number.value:0}}return e},_parseLinkElement:function(a){var b={options:{isLink:!0},attributes:{},properties:{textContent:""},css:{},dimensionCSSRules:{}},c=a.attributes["l:href"]&&a.attributes["l:href"].value?a.attributes["l:href"].value:"";return b.attributes.href=c,/^#/.test(c)||(b.attributes.target="_blank"),b.properties.textContent=a.textContent,b},_parsePages:function(a,c,e){var f,g,h=d.DOM.children(a),i=h.length;for(f=0;i>f;f++)"title"===h[f].localName?e.push(this._prepareBlock(h[f],c)):"section"===h[f].localName?this._parsePages(h[f],c,e):h[f].localName&&e.push(this._parseBlockElement({node:h[f],documentData:c}));a.attributes.id&&a.attributes.id.value&&(g=b.createElement("a"),g.setAttribute("name",a.attributes.id.value),e[e.length-1].appendChild(g))},_parseParagraph:function(a){var b,c,e=d.DOM.children(a.node),f=e.length,g={options:{isParagraph:!0},css:{},dimensionCSSRules:{margin:{value:0,units:"px"},padding:{value:0,units:"px"}},elements:[]};for(b=0;f>b;b++)"a"===e[b].localName?g.elements.push(this._parseLinkElement(e[b])):(c={options:{},css:{},attributes:{},properties:{textContent:e[b].textContent}},"strong"===e[b].localName?c.css.fontWeight="bold":"emphasis"===e[b].localName&&(c.css.fontStyle="italic"),g.elements.push(c));return g},_parsePublishInfo:function(a){var b,c=d.DOM.children(a),e=c.length,f={};for(b=e-1;b>=0;b--)f[c[b].localName]=c[b].textContent||"";return f},_prepareBlock:function(a,b){var c,e=d.DOM.children(a),f=e.length,g={options:{},css:{},dimensionCSSRules:{},elements:[]};for(c=0;f>c;c++)e[c].localName&&g.elements.push(this._parseBlockElement({node:e[c],documentData:b}));return g},_prepareImage:function(a){var b={options:{isImage:!0},css:{},dimensionCSSRules:{},attributes:{src:"",alt:""}};return b.attributes.src=!a.imageName&&a.node&&a.node.attributes["l:href"]&&a.node.attributes["l:href"].value?a.documentData.binaryItems[a.node.attributes["l:href"].value.replace("#","")]||b.attributes.src:a.documentData.binaryItems[a.imageName]||b.attributes.src,b},parse:function(a){if("function"==typeof a.start&&a.start(),!this.validate())return"function"==typeof a.error&&a.error({message:"Invalid file format"}),"function"==typeof a.complete&&a.complete(),null;var b=this,c=new FileReader,d="utf-8";return c.onload=function(e){var f=/encoding="(.+)"/.exec(e.target.result);f=f?b._normalizeEncodingValue(f[1]):d,f!=d?(c.onload=function(c){b._parseFileHelper(c.target.result,a)},c.readAsText(b.file,f)):b._parseFileHelper(e.target.result,a)},c.readAsText(this.file),null}}),d.Engines.ODF=d.Engine.extend({_createPage:function(a){var b={options:{},css:{},dimensionCSSRules:{},elements:[]};return a=a||{},a.layout&&(b=d.deepMerge({},b,a.layout.page)),b},_createParsedFile:function(){return this.isTextDocument()&&this._createParsedFileFromTextDocument.apply(this,arguments),null},_createParsedFileFromTextDocument:function(a,b){var c,e,f,g,h,i=a.length,j=0,k=new DOMParser,l=this,m=100,n={documentInfo:{},applicationInfo:{},styles:{},media:{}};for(c=i-1;-1!=c;c--)h=new FileReader,h.onload=function(a){return function(b){return-1!=a.entry.filename.indexOf("styles.")?l._parseTextDocumentStyles(k.parseFromString(b.target.result,"application/xml"),function(a){n.styles=a,j++}):-1!=a.entry.filename.indexOf("meta.")?(f=l._parseTextDocumentMetaInformation(k.parseFromString(b.target.result,"application/xml")),n.documentInfo=f.documentInfo,n.applicationInfo=f.applicationInfo,j++):-1!=a.entry.filename.indexOf("content.")?(e=k.parseFromString(b.target.result,"application/xml"),j++):-1!=a.entry.filename.indexOf("Pictures")?(n.media[a.entry.filename]=l._normalizeDataURI(b.target.result,a.entry.filename),j++):j++,null}}(a[c]),h[-1!=a[c].entry.filename.indexOf("Pictures")?"readAsDataURL":"readAsText"](a[c].file);g=setInterval(function(){j==i&&(clearInterval(g),l._parseTextDocumentContent({xml:e,documentData:n},function(a){b(new d.ParsedFile(a))}))},m)},_fileTypeParsers:[{extension:"odt",mime:"vnd.oasis.opendocument.text",isTextDocument:!0},{extension:"ott",mime:"vnd.oasis.opendocument.text-template",isTextDocument:!0,isTemplate:!0},{extension:"odg",mime:"vnd.oasis.opendocument.graphics",isGraphicDocument:!0},{extension:"otg",mime:"vnd.oasis.opendocument.graphics-template",isGraphicDocument:!0,isTemplate:!0},{extension:"odp",mime:"vnd.oasis.opendocument.presentation",isPresentation:!0,isTemplate:!0},{extension:"otp",mime:"vnd.oasis.opendocument.presentation-template",isPresentationDocument:!0,isTemplate:!0},{extension:"ods",mime:"vnd.oasis.opendocument.spreadsheet",isSpreadsheetDocument:!0},{extension:"ots",mime:"vnd.oasis.opendocument.spreadsheet-template",isSpreadsheetDocument:!0,isTemplate:!0},{extension:"odc",mime:"vnd.oasis.opendocument.chart",isChartDocument:!0},{extension:"otc",mime:"vnd.oasis.opendocument.chart-template",isChartDocument:!0,isTemplate:!0},{extension:"odi",mime:"vnd.oasis.opendocument.image",isImageDocument:!0},{extension:"oti",mime:"vnd.oasis.opendocument.image-template",isImageDocument:!0,isTemplate:!0},{extension:"odf",mime:"vnd.oasis.opendocument.formula",isFormulaDocument:!0},{extension:"otf",mime:"vnd.oasis.opendocument.formula-template",isFormulaDocument:!0,isTemplate:!0},{extension:"odm",mime:"vnd.oasis.opendocument.text-master",isTextDocumentMaster:!0},{extension:"oth",mime:"vnd.oasis.opendocument.text-web",isTextDocumentMasterWeb:!0}],_getListStyleType:function(a){var b;switch(a){case"1":b="decimal";break;case"i":b="lower-roman";break;case"I":b="upper-roman";break;case"a":b="lower-alpha";break;case"A":b="upper-alpha";break;default:b="auto"}return b},_getSize:function(a){var b={value:0,units:""},c=/^([0-9]*[0-9][0-9]*(?:\.[0-9]*)?|0+\.[0-9]*[1-9][0-9]*|\.[0-9]*[1-9][0-9]*)((cm)|(mm)|(in)|(pt)|(pc)|(px))$/.exec(a);return c?c[1]&&c[2]&&(b.value=isNaN(c[1])?0:+c[1],b.units=c[2]?String(c[2]).toLowerCase():""):(c=/^-?([0-9]+(?:\.[0-9]*)?|\.[0-9]+)(%)$/.exec(a),c&&c[1]&&c[2]&&(b.value=isNaN(c[1])?0:+c[1],b.units=c[2]?String(c[2]||"").toLowerCase():"")),b},_getStyleRules:function(a){var b,c={};for(b=a.elements.length-1;b>=0;b--)a.elements[b]&&(c[a.elements[b]]={css:{},dimensionCSSRules:{}},a.documentData.styles&&a.documentData.styles.defaults&&(a.documentData.styles.defaults[a.elements[b]]&&(c[a.elements[b]].css=d.clone(a.documentData.styles.defaults[a.elements[b]].css),c[a.elements[b]].dimensionCSSRules=d.clone(a.documentData.styles.defaults[a.elements[b]].dimensionCSSRules)),a.documentData.styles.defaults.named&&a.documentData.styles.defaults.named[a.styleName]&&a.documentData.styles.defaults.named[a.styleName][a.elements[b]]&&(d.deepMerge(c[a.elements[b]].css,a.documentData.styles.defaults.named[a.styleName][a.elements[b]].css),d.deepMerge(c[a.elements[b]].dimensionCSSRules,a.documentData.styles.defaults.named[a.styleName][a.elements[b]].dimensionCSSRules))),a.styles&&(a.styles[a.elements[b]]&&(d.deepMerge(c[a.elements[b]].css,a.styles[a.elements[b]].css),d.deepMerge(c[a.elements[b]].dimensionCSSRules,a.styles[a.elements[b]].dimensionCSSRules)),a.styles.named&&a.styles.named[a.styleName]&&a.styles.named[a.styleName][a.elements[b]]&&(d.deepMerge(c[a.elements[b]].css,a.styles.named[a.styleName][a.elements[b]].css),d.deepMerge(c[a.elements[b]].dimensionCSSRules,a.styles.named[a.styleName][a.elements[b]].dimensionCSSRules))));return c},_parseBorderStyle:function(a){var b,c,d={width:{},style:"none",color:"none"};return a&&"none"!==a&&(b=a.split(" "),b[0]&&b[1]&&b[2]&&(c=this._getSize(b[0]),c.units&&(d.width=c),d.style=b[1],d.color=this._normalizeColorValue(b[2]))),d},_parsePageLayoutStyles:function(a){var b,c,e,f,g={page:{css:{},dimensionCSSRules:{},options:{isLandscapeOrientation:!1}},footnote:{css:{},dimensionCSSRules:{},options:{}},footer:{css:{},dimensionCSSRules:{},options:{}},header:{css:{},dimensionCSSRules:{},options:{}}},h=d.DOM.children(a),i=h.length,j={};for(b=0;i>b;b++)if("page-layout-properties"===h[b].localName)for(h[b].attributes["fo:page-width"]&&h[b].attributes["fo:page-width"].value&&(j=this._getSize(h[b].attributes["fo:page-width"].value),j.units&&(g.page.dimensionCSSRules.width=j)),h[b].attributes["fo:page-height"]&&h[b].attributes["fo:page-height"].value&&(j=this._getSize(h[b].attributes["fo:page-height"].value),j.units&&(g.page.dimensionCSSRules.height=j)),h[b].attributes["fo:margin"]&&h[b].attributes["fo:margin"].value&&(j=this._getSize(h[b].attributes["fo:margin"].value),j.units&&(g.page.dimensionCSSRules.padding=j)),h[b].attributes["fo:margin-top"]&&h[b].attributes["fo:margin-top"].value&&(j=this._getSize(h[b].attributes["fo:margin-top"].value),j.units&&(g.page.dimensionCSSRules.paddingTop=j)),h[b].attributes["fo:margin-left"]&&h[b].attributes["fo:margin-left"].value&&(j=this._getSize(h[b].attributes["fo:margin-left"].value),j.units&&(g.page.dimensionCSSRules.paddingLeft=j)),h[b].attributes["fo:margin-right"]&&h[b].attributes["fo:margin-right"].value&&(j=this._getSize(h[b].attributes["fo:margin-right"].value),j.units&&(g.page.dimensionCSSRules.paddingRight=j)),h[b].attributes["fo:margin-bottom"]&&h[b].attributes["fo:margin-bottom"].value&&(j=this._getSize(h[b].attributes["fo:margin-bottom"].value),j.units&&(g.page.dimensionCSSRules.paddingBottom=j)),h[b].attributes["fo:padding"]&&h[b].attributes["fo:padding"].value&&(j=this._getSize(h[b].attributes["fo:padding"].value),j.units&&(g.page.dimensionCSSRules.padding=j)),h[b].attributes["fo:padding-top"]&&h[b].attributes["fo:padding-top"].value&&(j=this._getSize(h[b].attributes["fo:padding-top"].value),j.units&&(g.page.dimensionCSSRules.paddingTop=j)),h[b].attributes["fo:padding-left"]&&h[b].attributes["fo:padding-left"].value&&(j=this._getSize(h[b].attributes["fo:padding-left"].value),j.units&&(g.page.dimensionCSSRules.paddingLeft=j)),h[b].attributes["fo:padding-right"]&&h[b].attributes["fo:padding-right"].value&&(j=this._getSize(h[b].attributes["fo:padding-right"].value),j.units&&(g.page.dimensionCSSRules.paddingRight=j)),h[b].attributes["fo:padding-bottom"]&&h[b].attributes["fo:padding-bottom"].value&&(j=this._getSize(h[b].attributes["fo:padding-bottom"].value),j.units&&(g.page.dimensionCSSRules.paddingBottom=j)),h[b].attributes["style:footnote-max-height"]&&h[b].attributes["style:footnote-max-height"].value&&(j=this._getSize(h[b].attributes["style:footnote-max-height"].value),j.units&&(g.footnote.dimensionCSSRules.maxHeight=j)),h[b].attributes["style:num-format"]&&h[b].attributes["style:num-format"].value&&(g.page.options.numberingFormat=h[b].attributes["style:num-format"].value),h[b].attributes["style:print-orientation"]&&h[b].attributes["style:print-orientation"].value&&(g.page.options.isLandscapeOrientation="landscape"==h[b].attributes["style:print-orientation"].value),h[b].attributes["style:writing-mode"]&&h[b].attributes["style:writing-mode"].value&&(g.page.css.direction=/rl/gi.test(h[b].attributes["style:writing-mode"].value)?"rtl":"ltr"),c=d.DOM.children(h[b]),e=c.length,f=0;c>e;f++)switch(c[f].localName){case"footnote-sep":c[f].attributes["style:width"]&&c[f].attributes["style:width"].value&&(j=this._getSize(c[f].attributes["style:width"].value),j.units&&(g.footnote.dimensionCSSRules.width=j)),c[f].attributes["style:distance-before-sep"]&&c[f].attributes["style:distance-before-sep"].value&&(j=this._getSize(c[f].attributes["style:distance-before-sep"].value),j.units&&(g.footnote.dimensionCSSRules.marginTop=j)),c[f].attributes["style:distance-after-sep"]&&c[f].attributes["style:distance-after-sep"].value&&(j=this._getSize(c[f].attributes["style:distance-after-sep"].value),j.units&&(g.footnote.dimensionCSSRules.marginBottom=j)),c[f].attributes["style:adjustment"]&&c[f].attributes["style:adjustment"].value&&(g.footnote.css["float"]="none","left"==c[f].attributes["style:adjustment"].value?g.footnote.css["float"]="left":"right"==c[f].attributes["style:adjustment"].value&&(g.footnote.css["float"]="right")),c[f].attributes["style:color"]&&c[f].attributes["style:color"].value&&(g.footnote.css.color=this._normalizeColorValue(c[f].attributes["style:color"].value))}return g},_parseTextDocumentContent:function(a,b){var c,e,f,g,h={pages:[]},i={chunk:20,time:0,index:0},j=100,k=this,l=0,m=0,n=0,o=a.xml.querySelector("body"),p={layout:a.documentData.styles.automatic.layouts[a.documentData.styles.pageLayout]};g=this._createPage(p),this._parseTextDocumentStylesNode(a.xml.querySelector("automatic-styles"),function(q){o=o?o.querySelector("text"):null,a.documentData._heading=[],o&&(m++,i.data=d.DOM.children(o),i.len=i.data.length,i.all=i.len,e=function(b){b.end=b.index+(b.all>b.chunk?b.chunk:b.all),setTimeout(function(){for(b.index;b.index<b.end;b.index++){switch(b.data[b.index].localName){case"p":f=k._parseTextDocumentParagraphNode({node:b.data[b.index],styles:q,documentData:a.documentData}),f.options.pageBreak&&(h.pages.push(g),g=k._createPage(p)),g.elements.push(f);break;case"list":f=k._parseTextDocumentListNode({node:b.data[b.index],styles:q,documentData:a.documentData}),f.options.pageBreak&&(h.pages.push(g),g=k._createPage(p)),g.elements.push(f);break;case"table":f=k._parseTextDocumentTableNode({node:b.data[b.index],styles:q,documentData:a.documentData}),f.options.pageBreak&&(h.pages.push(g),g=k._createPage(p)),g.elements.push(f)}l++,l>=b.len&&(n++,n===m&&h.pages.push(g))}return b.all=b.len-b.end,b.index<b.len&&e.call(k,b),!0},b.time)},e.call(k,i)),c=setInterval(function(){n===m&&(clearInterval(c),"function"==typeof b&&b(h))},j)})},_parseTextDocumentParagraphNodeDrawFrame:function(a){var b,c,e={attributes:{},properties:{},css:{},dimensionCSSRules:{},isImage:!0},f=d.DOM.children(a.node),g=f.length;for(a.node.attributes["svg:x"]&&a.node.attributes["svg:x"].value&&(b=this._getSize(a.node.attributes["svg:x"].value),b.units&&(e.dimensionCSSRules.left=b,e.css.position="absolute")),a.node.attributes["svg:y"]&&a.node.attributes["svg:y"].value&&(b=this._getSize(a.node.attributes["svg:y"].value),b.units&&(e.dimensionCSSRules.top=b,e.css.position="absolute")),a.node.attributes["svg:width"]&&a.node.attributes["svg:width"].value&&(b=this._getSize(a.node.attributes["svg:width"].value),b.units&&(e.dimensionCSSRules.width=b)),a.node.attributes["svg:height"]&&a.node.attributes["svg:height"].value&&(b=this._getSize(a.node.attributes["svg:height"].value),b.units&&(e.dimensionCSSRules.height=b)),a.node.attributes["draw:z-index"]&&!isNaN(a.node.attributes["draw:z-index"].value)&&(e.css.zIndex=+a.node.attributes["draw:z-index"].value),a.node.attributes["draw:style-name"]&&a.node.attributes["draw:style-name"].value&&(e.properties.styleName=a.node.attributes["draw:style-name"].value),c=0;g>c;c++)"image"===f[c].localName&&f[c].attributes["xlink:href"]&&a.documentData&&a.documentData.media&&(e.attributes.src=a.documentData.media[f[c].attributes["xlink:href"].value]);return e},_parseTextDocumentParagraphNodeTextSection:function(a){var b,c,e=d.DOM.children(a.node),f=e.length,g={css:{},dimensionCSSRules:{},attributes:{},properties:{textContent:""},options:{}};for(a.node.attributes["text:style-name"]&&a.node.attributes["text:style-name"].value&&(c=this._getStyleRules({documentData:a.documentData,styles:a.styles,styleName:a.node.attributes["text:style-name"].value,elements:["paragraphContent"]}),d.deepMerge(g,c.paragraph)),b=0;f>b;b++)a.properties.textContent+=e[b].textContent;return data},_parseTextDocumentListNode:function(a){var b,c,e,f,g,h={options:{isList:!0,pageBreak:!1},attributes:{},css:{},dimensionCSSRules:{},items:[]},i=d.DOM.children(a.node),j=[],k=i.length;for(a.node.attributes["xml:id"]&&a.node.attributes["xml:id"].value&&(h.attributes.id=a.node.attributes["xml:id"].value),a.node.attributes["text:style-name"]&&a.node.attributes["text:style-name"].value&&(b=this._getStyleRules({documentData:a.documentData,styles:a.styles,styleName:a.node.attributes["text:style-name"].value,elements:["list"]}),d.deepMerge(h,b.list)),c=0;k>c;c++){if(g={options:{},attributes:{},css:{},dimensionCSSRules:{},elements:[]},"list-item"===i[c].localName)for(j=d.DOM.children(i[c]),f=j.length,e=0;f>e;e++)"p"===j[e].localName&&g.elements.push(this._parseTextDocumentParagraphNode({node:j[e],styles:a.styles,documentData:a.documentData}));h.items[c]=g}return h},_parseTextDocumentListStyles:function(a){var b,c={list:{css:{},dimensionCSSRules:{}}},e=d.DOM.children(a),f=e.length;for(b=0;f>b;b++)"list-level-style-number"==e[b].localName&&e[b].attributes["style:num-format"]&&e[b].attributes["style:num-format"].value&&(c.list.css.listStyleType=this._getListStyleType(e[b].attributes["style:num-format"].value));return c},_parseTextDocumentMetaInformation:function(a){var b,c={documentInfo:{},applicationInfo:{}},e=a.querySelector("meta"),f=d.DOM.children(e),g=f.length;if(e)for(b=0;g>b;b++)switch(f[b].localName){case"initial-creator":case"creator":f[b].textContent&&(c.documentInfo.creator=f[b].textContent);break;case"creation-date":f[b].textContent&&(c.documentInfo.dateCreated=new Date(f[b].textContent));break;case"date":f[b].textContent&&(c.documentInfo.dateModified=new Date(f[b].textContent));break;case"generator":f[b].textContent&&(c.applicationInfo.application=f[b].textContent);break;case"document-statistic":c.documentInfo.tableCount=f[b].attributes["meta:table-count"]&&!isNaN(f[b].attributes["meta:table-count"].value)?+f[b].attributes["meta:table-count"].value:0,c.documentInfo.imageCount=f[b].attributes["meta:image-count"]&&!isNaN(f[b].attributes["meta:image-count"].value)?+f[b].attributes["meta:image-count"].value:0,c.documentInfo.objectCount=f[b].attributes["meta:object-count"]&&!isNaN(f[b].attributes["meta:object-count"].value)?+f[b].attributes["meta:object-count"].value:0,c.documentInfo.pageCount=f[b].attributes["meta:page-count"]&&!isNaN(f[b].attributes["meta:page-count"].value)?+f[b].attributes["meta:page-count"].value:0,c.documentInfo.paragraphCount=f[b].attributes["meta:paragraph-count"]&&!isNaN(f[b].attributes["meta:paragraph-count"].value)?+f[b].attributes["meta:paragraph-count"].value:0,c.documentInfo.wordsCount=f[b].attributes["meta:word-count"]&&!isNaN(f[b].attributes["meta:word-count"].value)?+f[b].attributes["meta:word-count"].value:0,c.documentInfo.characterCount=f[b].attributes["meta:character-count"]&&!isNaN(f[b].attributes["meta:character-count"].value)?+f[b].attributes["meta:character-count"].value:0}return c},_parseTextDocumentParagraphNode:function(a){var b,c,e={options:{isParagraph:!0,pageBreak:!1},attributes:{},css:{},dimensionCSSRules:{margin:{value:0,units:"px"},padding:{value:0,units:"px"}},elements:[]},f={},g=a.node.childNodes.length;for(a.node.attributes["text:style-name"]&&a.node.attributes["text:style-name"].value&&(f=this._getStyleRules({documentData:a.documentData,styles:a.styles,styleName:a.node.attributes["text:style-name"].value,elements:["paragraph","paragraphContent"]}),d.deepMerge(e,f.paragraph)),b=0;g>b;b++)switch(c=d.deepMerge({options:{},attributes:{},properties:{}},f.paragraphContent),a.node.childNodes[b].localName){case"tab":c.properties.textContent=this._getTabAsSpaces(),e.elements.push(c);break;case"soft-page-break":e.options.pageBreak=!0;break;case"span":c=d.deepMerge({},c,this._parseTextDocumentParagraphNodeTextSection({node:a.node.childNodes[b],styles:a.styles,documentData:a.documentData})),e.elements.push(c);break;case"frame":c=d.deepMerge({},c,this._parseTextDocumentParagraphNodeDrawFrame({node:a.node.childNodes[b],styles:a.styles,documentData:a.documentData})),e.elements.push(c);break;default:c.properties.textContent=a.node.childNodes[b].textContent,e.elements.push(c)}return e},_parseTextDocumentParagraphStyles:function(a){var b,c,e,f=d.DOM.children(a),g=f.length,h={paragraph:{css:{},dimensionCSSRules:{},options:{}},paragraphContent:{css:{},dimensionCSSRules:{},options:{}}},i={};for(b=0;g>b;b++)e=f[b].localName,"paragraph-properties"===e?(f[b].attributes["fo:background-color"]&&f[b].attributes["fo:background-color"].value&&(h.paragraph.css.backgroundColor=this._normalizeColorValue(f[b].attributes["fo:background-color"].value)),f[b].attributes["style:writing-mode"]&&f[b].attributes["style:writing-mode"].value&&(h.paragraph.css.direction=/rl/gi.test(f[b].attributes["style:writing-mode"].value)?"rtl":"ltr"),f[b].attributes["fo:text-align"]&&f[b].attributes["fo:text-align"].value&&(c=/center|left|right/i.exec(f[b].attributes["fo:text-align"].value),c&&c[0]&&(h.paragraph.css.textAlign=c[0])),f[b].attributes["fo:margin"]&&f[b].attributes["fo:margin"].value&&(i=this._getSize(f[b].attributes["fo:margin"].value),i.units&&(h.paragraph.dimensionCSSRules.margin=i)),f[b].attributes["fo:margin-top"]&&f[b].attributes["fo:margin-top"].value&&(i=this._getSize(f[b].attributes["fo:margin-top"].value),i.units&&(h.paragraph.dimensionCSSRules.marginTop=i)),f[b].attributes["fo:margin-bottom"]&&f[b].attributes["fo:margin-bottom"].value&&(i=this._getSize(f[b].attributes["fo:margin-bottom"].value),i.units&&(h.paragraph.dimensionCSSRules.marginBottom=i)),f[b].attributes["fo:margin-left"]&&f[b].attributes["fo:margin-left"].value&&(i=this._getSize(f[b].attributes["fo:margin-left"].value),i.units&&(h.paragraph.dimensionCSSRules.marginLeft=i)),f[b].attributes["fo:margin-right"]&&f[b].attributes["fo:margin-right"].value&&(i=this._getSize(f[b].attributes["fo:margin-right"].value),i.units&&(h.paragraph.dimensionCSSRules.marginLeft=i)),f[b].attributes["fo:margin"]&&f[b].attributes["fo:margin"].value&&(i=this._getSize(f[b].attributes["fo:margin"].value),i.units&&(h.paragraph.dimensionCSSRules.margin=i)),f[b].attributes["fo:margin-top"]&&f[b].attributes["fo:margin-top"].value&&(i=this._getSize(f[b].attributes["fo:margin-top"].value),i.units&&(h.paragraph.dimensionCSSRules.marginTop=i)),f[b].attributes["fo:margin-bottom"]&&f[b].attributes["fo:margin-bottom"].value&&(i=this._getSize(f[b].attributes["fo:margin-bottom"].value),i.units&&(h.paragraph.dimensionCSSRules.marginBottom=i)),f[b].attributes["fo:margin-left"]&&f[b].attributes["fo:margin-left"].value&&(i=this._getSize(f[b].attributes["fo:margin-left"].value),i.units&&(h.paragraph.dimensionCSSRules.marginLeft=i)),f[b].attributes["fo:margin-right"]&&f[b].attributes["fo:margin-right"].value&&(i=this._getSize(f[b].attributes["fo:margin-right"].value),i.units&&(h.paragraph.dimensionCSSRules.marginRight=i)),f[b].attributes["fo:padding"]&&f[b].attributes["fo:padding"].value&&(i=this._getSize(f[b].attributes["fo:padding"].value),i.units&&(h.paragraph.dimensionCSSRules.padding=i)),f[b].attributes["fo:padding-top"]&&f[b].attributes["fo:padding-top"].value&&(i=this._getSize(f[b].attributes["fo:padding-top"].value),i.units&&(h.paragraph.dimensionCSSRules.paddingTop=i)),f[b].attributes["fo:padding-bottom"]&&f[b].attributes["fo:padding-bottom"].value&&(i=this._getSize(f[b].attributes["fo:padding-bottom"].value),i.units&&(h.paragraph.dimensionCSSRules.paddingBottom=i)),f[b].attributes["fo:padding-left"]&&f[b].attributes["fo:padding-left"].value&&(i=this._getSize(f[b].attributes["fo:padding-left"].value),i.units&&(h.paragraph.dimensionCSSRules.paddingLeft=i)),f[b].attributes["fo:padding-right"]&&f[b].attributes["fo:padding-right"].value&&(i=this._getSize(f[b].attributes["fo:padding-right"].value),i.units&&(h.paragraph.dimensionCSSRules.paddingRight=i))):"text-properties"===e&&(f[b].attributes["fo:color"]&&f[b].attributes["fo:color"].value&&(h.paragraphContent.css.color=this._normalizeColorValue(f[b].attributes["fo:color"].value)),f[b].attributes["fo:font-style"]&&f[b].attributes["fo:font-style"].value&&(h.paragraphContent.css.fontStyle=/italic/gi.test(f[b].attributes["fo:font-style"].value)?"italic":"normal"),f[b].attributes["fo:font-weight"]&&f[b].attributes["fo:font-weight"].value&&(h.paragraphContent.css.fontWeight=/bold/gi.test(f[b].attributes["fo:font-weight"].value)?"bold":"normal"),f[b].attributes["style:text-underline-style"]&&f[b].attributes["style:text-underline-style"].value&&(h.paragraphContent.css.textDecoration=/none/gi.test(f[b].attributes["style:text-underline-style"].value)?"none":"underline"),f[b].attributes["style:font-name"]&&f[b].attributes["style:font-name"].value&&(h.paragraphContent.css.fontFamily=f[b].attributes["style:font-name"].value),f[b].attributes["fo:font-size"]&&f[b].attributes["fo:font-size"].value&&(i=this._getSize(f[b].attributes["fo:font-size"].value),i.units&&(h.paragraphContent.dimensionCSSRules.fontSize=i)),f[b].attributes["fo:margin"]&&f[b].attributes["fo:margin"].value&&(i=this._getSize(f[b].attributes["fo:margin"].value),i.units&&(h.paragraphContent.dimensionCSSRules.margin=i)),f[b].attributes["fo:margin-top"]&&f[b].attributes["fo:margin-top"].value&&(i=this._getSize(f[b].attributes["fo:margin-top"].value),i.units&&(h.paragraphContent.dimensionCSSRules.marginTop=i)),f[b].attributes["fo:margin-bottom"]&&f[b].attributes["fo:margin-bottom"].value&&(i=this._getSize(f[b].attributes["fo:margin-bottom"].value),i.units&&(h.paragraphContent.dimensionCSSRules.marginBottom=i)),f[b].attributes["fo:margin-left"]&&f[b].attributes["fo:margin-left"].value&&(i=this._getSize(f[b].attributes["fo:margin-left"].value),i.units&&(h.paragraphContent.dimensionCSSRules.marginLeft=i)),f[b].attributes["fo:margin-right"]&&f[b].attributes["fo:margin-right"].value&&(i=this._getSize(f[b].attributes["fo:margin-right"].value),i.units&&(h.paragraphContent.dimensionCSSRules.marginLeft=i)),f[b].attributes["fo:margin"]&&f[b].attributes["fo:margin"].value&&(i=this._getSize(f[b].attributes["fo:margin"].value),i.units&&(h.paragraphContent.dimensionCSSRules.margin=i)),f[b].attributes["fo:margin-top"]&&f[b].attributes["fo:margin-top"].value&&(i=this._getSize(f[b].attributes["fo:margin-top"].value),i.units&&(h.paragraphContent.dimensionCSSRules.marginTop=i)),f[b].attributes["fo:margin-bottom"]&&f[b].attributes["fo:margin-bottom"].value&&(i=this._getSize(f[b].attributes["fo:margin-bottom"].value),i.units&&(h.paragraphContent.dimensionCSSRules.marginBottom=i)),f[b].attributes["fo:margin-left"]&&f[b].attributes["fo:margin-left"].value&&(i=this._getSize(f[b].attributes["fo:margin-left"].value),i.units&&(h.paragraphContent.dimensionCSSRules.marginLeft=i)),f[b].attributes["fo:margin-right"]&&f[b].attributes["fo:margin-right"].value&&(i=this._getSize(f[b].attributes["fo:margin-right"].value),i.units&&(h.paragraphContent.dimensionCSSRules.marginRight=i)),f[b].attributes["fo:padding"]&&f[b].attributes["fo:padding"].value&&(i=this._getSize(f[b].attributes["fo:padding"].value),i.units&&(h.paragraphContent.dimensionCSSRules.padding=i)),f[b].attributes["fo:padding-top"]&&f[b].attributes["fo:padding-top"].value&&(i=this._getSize(f[b].attributes["fo:padding-top"].value),i.units&&(h.paragraphContent.dimensionCSSRules.paddingTop=i)),f[b].attributes["fo:padding-bottom"]&&f[b].attributes["fo:padding-bottom"].value&&(i=this._getSize(f[b].attributes["fo:padding-bottom"].value),i.units&&(h.paragraphContent.dimensionCSSRules.paddingBottom=i)),f[b].attributes["fo:padding-left"]&&f[b].attributes["fo:padding-left"].value&&(i=this._getSize(f[b].attributes["fo:padding-left"].value),i.units&&(h.paragraphContent.dimensionCSSRules.paddingLeft=i)),f[b].attributes["fo:padding-right"]&&f[b].attributes["fo:padding-right"].value&&(i=this._getSize(f[b].attributes["fo:padding-right"].value),i.units&&(h.paragraphContent.dimensionCSSRules.paddingRight=i)),f[b].attributes["fo:language"]&&f[b].attributes["fo:language"].value&&(h.paragraphContent.options.language=f[b].attributes["fo:language"].value));return h},_parseTextDocumentStyles:function(a,b){var c,e,f,g,h={automatic:{layouts:{}},pageLayout:"",defaults:{}},i="";for(f=a.querySelector("master-styles"),g=d.DOM.children(f),e=g.length,c=e-1;c>=0;c--)"master-page"===g[c].localName&&g[c].attributes["style:page-layout-name"]&&g[c].attributes["style:page-layout-name"].value&&(h.pageLayout=g[c].attributes["style:page-layout-name"].value);for(f=a.querySelector("automatic-styles"),g=d.DOM.children(f),e=g.length,c=e-1;c>=0;c--)"page-layout"===g[c].localName&&g[c].attributes["style:name"]&&g[c].attributes["style:name"].value&&(h.automatic.layouts[g[c].attributes["style:name"].value]=this._parsePageLayoutStyles(g[c]),i||(i=g[c].attributes["style:name"].value));!h.automatic.layouts[h.pageLayout]&&i&&(h.pageLayout=i),f=a.querySelector("styles"),this._parseTextDocumentStylesNode(f,function(a){h.defaults=a,b(h)})},_parseTextDocumentStylesNode:function(a,b){var c,e,f,g,h={named:{},paragraph:{},paragraphContent:{},table:{},list:{}},i=this,j={},k=0,l=0,m={chunk:20,time:10,index:0},n=0,o="style",p="list-style",q="default-style";a?(n++,m.data=d.DOM.children(a),m.len=m.data.length,m.all=m.len,c=function(a){a.end=a.index+(a.all>a.chunk?a.chunk:a.all),setTimeout(function(){for(a.index;a.index<a.end;a.index++){if(g=a.data[a.index],f=g.localName,f===o||q===f)switch("default-style"!==f&&g.attributes["style:name"]&&g.attributes["style:name"].value?(h.named[g.attributes["style:name"].value]=h.named[g.attributes["style:name"].value]||{},e=h.named[g.attributes["style:name"].value]):e=null,g.attributes["style:family"]&&g.attributes["style:family"].value){case"table":e?e.table=i._parseTextDocumentTableStyles(g):h.table=i._parseTextDocumentTableStyles(g);break;case"table-column":e&&(e.tableColumn=i._parseTextDocumentTableColumnStyles(g));
break;case"table-cell":e&&(e.tableCell=i._parseTextDocumentTableCellStyles(g));break;case"paragraph":e?(j=i._parseTextDocumentParagraphStyles(g),e.paragraph=d.deepMerge(j.paragraph,{css:{wordWrap:"break-word",wordBreak:"break-all",width:"100%"}}),e.paragraphContent=j.paragraphContent):(j=i._parseTextDocumentParagraphStyles(g),h.paragraph=j.paragraph,h.paragraphContent=j.paragraphContent);break;case"text":e?(j=i._parseTextDocumentParagraphStyles(g),e.paragraph=j.paragraph,e.paragraphContent=j.paragraphContent):(j=i._parseTextDocumentParagraphStyles(g),h.paragraph=j.paragraph,h.paragraphContent=j.paragraphContent)}else f===p&&g.attributes["style:name"]&&g.attributes["style:name"].value&&(h.named[g.attributes["style:name"].value]=h.named[g.attributes["style:name"].value]||{},d.deepMerge(h.named[g.attributes["style:name"].value],i._parseTextDocumentListStyles(g)));k++,k>=a.len&&(l++,l>=n&&"function"==typeof b&&b(h))}return a.all=a.len-a.end,a.index<a.len&&c.call(i,a),!0},a.time)},c.call(i,m)):b(h)},_parseTextDocumentTableCellStyles:function(a){var b,c,e=d.DOM.children(a),f=e.length,g={css:{},dimensionCSSRules:{},options:{}};for(b=0;f>b;b++)"table-cell-properties"===e[b].localName&&(e[b].attributes["fo:padding"]&&e[b].attributes["fo:padding"].value&&(c=this._getSize(e[b].attributes["fo:padding"].value),c.units&&(g.dimensionCSSRules.padding=c)),e[b].attributes["fo:border"]&&e[b].attributes["fo:border"].value&&(c=this._parseBorderStyle(e[b].attributes["fo:border"].value),g.css.borderStyle=c.style,g.dimensionCSSRules.borderWidth=c.width,g.css.borderColor=c.color),e[b].attributes["fo:border-left"]&&e[b].attributes["fo:border-left"].value&&(c=this._parseBorderStyle(e[b].attributes["fo:border-left"].value),g.css.borderLeftStyle=c.style,g.dimensionCSSRules.borderLeftWidth=c.width,g.css.borderLeftColor=c.color),e[b].attributes["fo:border-right"]&&e[b].attributes["fo:border-right"].value&&(c=this._parseBorderStyle(e[b].attributes["fo:border-right"].value),g.css.borderRightStyle=c.style,g.dimensionCSSRules.borderRightWidth=c.width,g.css.borderRightColor=c.color),e[b].attributes["fo:border-top"]&&e[b].attributes["fo:border-top"].value&&(c=this._parseBorderStyle(e[b].attributes["fo:border-top"].value),g.css.borderTopStyle=c.style,g.dimensionCSSRules.borderTopWidth=c.width,g.css.borderTopColor=c.color),e[b].attributes["fo:border-bottom"]&&e[b].attributes["fo:border-bottom"].value&&(c=this._parseBorderStyle(e[b].attributes["fo:border-bottom"].value),g.css.borderBottomStyle=c.style,g.dimensionCSSRules.borderBottomWidth=c.width,g.css.borderBottomColor=c.color));return g},_parseTextDocumentTableColumnStyles:function(a){var b,c=d.DOM.children(a),e=c.length,f={css:{},dimensionCSSRules:{},options:{}},g={};for(b=0;e>b;b++)"table-column-properties"===c[b].localName&&c[b].attributes["style:column-width"]&&c[b].attributes["style:column-width"].value&&(g=this._getSize(c[b].attributes["style:column-width"].value),g.units&&(f.dimensionCSSRules.width=g));return f},_parseTextDocumentTableNode:function(a){var b,c,e={options:{isTable:!0,pageBreak:!1},header:{rows:[]},body:{rows:[]},footer:{rows:[]},attributes:{},dimensionCSSRules:{},css:{}},f=d.DOM.children(a.node),g=f.length,h=[],i=0,j=0,k={};for(a.node.attributes["table:name"]&&a.node.attributes["table:name"].value&&(e.attributes.name=a.node.attributes["table:name"].value),a.node.attributes["table:style-name"]&&a.node.attributes["table:style-name"].value&&(k=this._getStyleRules({documentData:a.documentData,styles:a.styles,styleName:a.node.attributes["table:style-name"].value,elements:["table"]}),d.deepMerge(e,k.table)),b=0;g>b;b++)if(c=f[b].localName,"table-row"===c)e.body.rows.push(d.deepMerge(this._parseTextDocumentTableRowNode({node:f[b],documentData:a.documentData,styles:a.styles})));else if("table-header-rows"===c)for(h=d.DOM.children(f[b]),j=h.length,i=0;j>i;i++)"table-row"===h[i].localName&&e.header.rows.push(this._parseTextDocumentTableRowNode({node:h[i],documentData:a.documentData,styles:a.styles}));return e},_parseTextDocumentTableRowNode:function(a){var b,c,e,f,g,h={cells:[],css:{},dimensionCSSRules:{}},i={},j=d.DOM.children(a.node),k=j.length;for(b=0;k>b;b++)if("table-cell"===j[b].localName){for(j[b].attributes["table:style-name"]&&j[b].attributes["table:style-name"].value&&(i=this._getStyleRules({documentData:a.documentData,styles:a.styles,styleName:j[b].attributes["table:style-name"].value,elements:["tableCell"]})),e=d.deepMerge({elements:[],options:{}},a.styles,i.tableCell),f=d.DOM.children(j[b]),g=f.length,c=0;g>c;c++)"p"===f[c].localName&&e.elements.push(this._parseTextDocumentParagraphNode({node:f[c],styles:a.styles,documentData:a.documentData}));h.cells.push(e)}return h},_parseTextDocumentTableStyles:function(a){var b,c=d.DOM.children(a),e=c.length,f={css:{},dimensionCSSRules:{},options:{}},g={};for(b=e-1;b>=0;b--)"table-properties"===c[b].localName&&(c[b].attributes["style:width"]&&c[b].attributes["style:width"].value&&(g=this._getSize(c[b].attributes["style:width"].value),g.units&&(f.dimensionCSSRules.width=g)),c[b].attributes["table:border-model"]&&c[b].attributes["table:border-model"].value&&(f.css.borderCollapse=/coll/gi.test(c[b].attributes["table:border-model"].value)?"collapse":"separate"));return f}}),d.Engines.OXML=d.Engine.extend({_attributeToBoolean:function(a){return!!a&&("true"==a.value||"1"==a.value||"on"==a.value)},_checkPageLinesHeight:function(a){var b;return a.pageHeight&&a.pageLinesHeight+a.lineHeight>a.pageHeight?(b=d.clone(a.pageOptions),b.options.pageNumber&&(b.options.pageNumber.value=b.options.pageNumber.start+a.pageOptions.options.pageIndex),b.elements=a.pageElements,a.pageLinesHeight=0,a.pages.push(b)):a.pageLinesHeight+=a.lineHeight,a.pageLinesHeight},_convertEMU:function(a){return{value:a/12700,units:"pt"}},_createParsedFile:function(){return this.isTextDocument()&&this._createParsedFileFromTextDocument.apply(this,arguments),null},_createParsedFileFromTextDocument:function(a,b){var c,e,f,g=a.length,h=0,i=new DOMParser,j=this,k={mainRelations:{},documentRelations:{},appInfo:{},documentInfo:{},fonts:{},settings:{},styles:{},webSettings:{},media:{},themes:{}};for(c=0;g>c;c++)e=new FileReader,e.onload=function(a){return function(c){return a.entry.filename.indexOf("_rels/.rels")>=0?(k.mainRelations=j._parseRelations.call(j,i.parseFromString(c.target.result,"application/xml")),h++):a.entry.filename.indexOf("word/_rels/")>=0?(h++,k.documentRelations=j._parseRelations.call(j,i.parseFromString(c.target.result,"application/xml"))):a.entry.filename.indexOf("/app.xml")>=0?(h++,k.applicationInfo=j._parseApplicationInfo.call(j,i.parseFromString(c.target.result,"application/xml"))):a.entry.filename.indexOf("/core.xml")>=0?(h++,k.documentInfo=j._parseDocumentInfo.call(j,i.parseFromString(c.target.result,"application/xml"))):a.entry.filename.indexOf("media/")>=0?(h++,k.media[a.entry.filename]={fileData:a,data:j._normalizeDataURI(c.target.result,a.entry.filename)}):a.entry.filename.indexOf("theme/")>=0?(h++,k.themes[a.entry.filename]=j._parseDocumentTheme.call(j,i.parseFromString(c.target.result,"application/xml"))):a.entry.filename.indexOf("/fontTable.xml")>=0?(h++,k.fonts=j._parseFontsInfo.call(j,i.parseFromString(c.target.result,"application/xml"))):a.entry.filename.indexOf("/settings.xml")>=0?(h++,k.settings=j._parseTextDocumentSettings.call(j,i.parseFromString(c.target.result,"application/xml"))):a.entry.filename.indexOf("/webSettings.xml")>=0?(h++,k.webSettings=j._parseWebSettings.call(j,i.parseFromString(c.target.result,"application/xml"))):a.entry.filename.indexOf("/styles.xml")>=0?(h++,k.styles=j._parseTextDocumentStyles.call(j,i.parseFromString(c.target.result,"application/xml"))):a.entry.filename.indexOf("/document.xml")>=0?(h++,f=i.parseFromString(c.target.result,"application/xml")):h++,h>g-1?(j._parseTextDocumentContent.call(j,{xml:f,documentData:k,callback:function(a){b(new d.ParsedFile(a))}}),!1):!0}}(a[c]),e[a[c].entry.filename.indexOf("media/")>=0?"readAsDataURL":"readAsText"](a[c].file)},_fileTypeParsers:[{extension:["docx"],mime:["vnd.openxmlformats-officedocument.wordprocessingml.document"],isTextDocument:!0}],_getCSSRulesFromPreferencedStyle:function(a){return{elementCSSRules:{css:a.lineStyle.css||{},dimensionCSSRules:a.lineStyle.dimensionCSSRules||{}},childrenCSSRules:{css:a.contentProperties.css||{},dimensionCSSRules:a.contentProperties.dimensionCSSRules||{}}}},_getLineHeight:function(a){var b=Math.round(100*(a/240))/100;return isNaN(b)||1>b?1:b},_getMediaFromRelation:function(a){var b,c=this._getRelation(a);return c&&a.documentData.media&&a.documentData.media["word/"+c.target]&&(b=a.documentData.media["word/"+c.target]),b},_getRelation:function(a){var b;return a.documentData.documentRelations&&a.documentData.documentRelations[a.relationId]?b=a.documentData.documentRelations[a.relationId]:a.documentData.mainRelations&&a.documentData.mainRelations[a.relationId]&&(b=a.documentData.mainRelations[a.relationId]),b},_getTextDocumentStyleProperties:function(a){var b,c,e,f,g,h,i,j,k,l={options:{classList:[]},css:{},dimensionCSSRules:{}},m=d.DOM.children(a.node),n="0 0 1px 0 rgba(0,0,0,0.5)";for(k=m.length-1;k>=0;k--)switch(m[k].localName){case"pStyle":m[k].attributes["w:val"]&&m[k].attributes["w:val"].value&&a.documentData&&a.documentData.styles.preferencedStyles[m[k].attributes["w:val"].value]&&(e=this._getCSSRulesFromPreferencedStyle(a.documentData.styles.preferencedStyles[m[k].attributes["w:val"].value]),d.deepMerge(l,e.elementCSSRules),l.options.childrenCSSRules=d.deepMerge(l.options.childrenCSSRules,e.childrenCSSRules),b=/Heading\s*([0-9]+)/i.exec(a.documentData.styles.preferencedStyles[m[k].attributes["w:val"].value].name),b?(l.options.classList.push(m[k].attributes["w:val"].value),l.options.heading={level:isNaN(b[1])?0:+b[1]}):/List\s*Paragraph/i.test(a.documentData.styles.preferencedStyles[m[k].attributes["w:val"].value].name)&&(l.options.isListItem=!0));break;case"jc":m[k].attributes["w:val"]&&m[k].attributes["w:val"].value&&("both"==m[k].attributes["w:val"].value?l.css.textAlign="justify":"center"==m[k].attributes["w:val"].value?l.css.textAlign="center":"left"==m[k].attributes["w:val"].value?l.css.textAlign="left":"right"==m[k].attributes["w:val"].value&&(l.css.textAlign="right"));break;case"ind":m[k].attributes["w:left"]&&!isNaN(m[k].attributes["w:left"].value)&&(l.dimensionCSSRules.paddingLeft={units:"pt",value:m[k].attributes["w:left"].value/20}),m[k].attributes["w:right"]&&!isNaN(m[k].attributes["w:right"].value)&&(l.dimensionCSSRules.paddingRight={units:"pt",value:m[k].attributes["w:right"].value/20}),m[k].attributes["w:firstLine"]&&!isNaN(m[k].attributes["w:firstLine"].value)&&(l.dimensionCSSRules.textIndent={units:"pt",value:m[k].attributes["w:firstLine"].value/20});break;case"b":l.css.fontWeight=m[k].attributes["w:val"]&&!this._attributeToBoolean(m[k].attributes["w:val"])?"normal":"bold";break;case"bCs":m[k].attributes["w:val"]&&!this._attributeToBoolean(m[k].attributes["w:val"])&&(l.options.complexFontWeight="bold");break;case"shadow":l.css.textShadow=this._attributeToBoolean(m[k].attributes["w:val"])?n:"none";break;case"cs":l.options.useComplexScript=this._attributeToBoolean(m[k].attributes["w:val"]);break;case"outline":l.options.outline=this._attributeToBoolean(m[k].attributes["w:val"]);break;case"rtl":l.css.direction=this._attributeToBoolean(m[k].attributes["w:val"])?"rtl":"ltr";break;case"strike":l.options.strike=this._attributeToBoolean(m[k].attributes["w:val"]);break;case"dstrike":l.options.doubleStrike=this._attributeToBoolean(m[k].attributes["w:val"]);break;case"vanish":this._attributeToBoolean(m[k].attributes["w:val"])&&(l.css.visibility="hidden");break;case"specVanish":this._attributeToBoolean(m[k].attributes["w:val"])&&(l.css.visibility="hidden");break;case"i":l.css.fontStyle=m[k].attributes["w:val"]&&!this._attributeToBoolean(m[k].attributes["w:val"])?"normal":"italic";break;case"iCs":m[k].attributes["w:val"]&&!this._attributeToBoolean(m[k].attributes["w:val"])&&(l.options.complexFontStyle="italic");break;case"color":m[k].attributes["w:val"]&&m[k].attributes["w:val"].value&&(l.css.color=this._normalizeColorValue(m[k].attributes["w:val"].value));break;case"sz":m[k]&&m[k].attributes["w:val"]&&!isNaN(m[k].attributes["w:val"].value)&&(l.dimensionCSSRules.fontSize={units:"pt",value:m[k].attributes["w:val"].value/2});break;case"szCs":!l.dimensionCSSRules.fontSize&&m[k]&&m[k].attributes["w:val"]&&!isNaN(m[k].attributes["w:val"].value)&&(l.dimensionCSSRules.fontSize={value:m[k].attributes["w:val"].value/2,units:"pt"});break;case"rFonts":m[k].attributes["w:ascii"]?l.css.fontFamily=m[k].attributes["w:ascii"].value||"":m[k].attributes["w:cs"]?l.css.fontFamily=m[k].attributes["w:cs"].value||"":m[k].attributes["w:asciiTheme"]&&(/major/gi.test(m[k].attributes["w:asciiTheme"].value)?l.options.majorFontFamily=!0:/minor/gi.test(m[k].attributes["w:asciiTheme"].value)&&(l.options.minorFontFamily=!0));break;case"u":m[k].attributes["w:val"]&&m[k].attributes["w:val"].value&&(l.css.textDecoration="none"!=m[k].attributes["w:val"].value?"underline":l.css.textDecoration);break;case"vertAlign":m[k].attributes["w:val"]&&(l.css.verticalAlign=this._normalizeVerticalAlign(m[k].attributes["w:val"]));break;case"oMath":l.options.math=this._attributeToBoolean(m[k].attributes["w:val"]);break;case"imprint":l.options.imprinting=this._attributeToBoolean(m[k].attributes["w:val"]);break;case"snapToGrid":l.options.useDocumentGrid=this._attributeToBoolean(m[k].attributes["w:val"]);break;case"webHidden":l.options.webHiddenText=this._attributeToBoolean(m[k].attributes["w:val"]);break;case"emboss":l.options.embossing=this._attributeToBoolean(m[k].attributes["w:val"]);break;case"smallCaps":l.options.smallCaps=this._attributeToBoolean(m[k].attributes["w:val"]);break;case"noProof":l.options.checkSpellingGrammar=!this._attributeToBoolean(m[k].attributes["w:val"]);break;case"fitText":l.options.fitText.id=m[k]&&m[k].attributes["w:id"]?m[k].attributes["w:id"].value:null,l.options.fitText.width=m[k]&&!isNaN(m[k].attributes["w:val"])?{value:m[k].attributes["w:id"].value/20,units:"pt"}:null;break;case"shd":m[k].attributes["w:val"]&&(l.css.boxShadow=this._parseShadowProperty(m[k]));break;case"effect":l.options.effect=this._parseStyleEffectProperty(m[k]);break;case"eastAsianLayout":l.options.eastAsianSettings={id:m[k].attributes["w:id"]?m[k].attributes["w:id"].value:null,combines:this._attributeToBoolean(!!m[k].attributes["w:combine"]),isVertical:!!m[k]&&this._attributeToBoolean(!!m[k].attributes["w:vert"]),verticalCompress:!!m[k]&&this._attributeToBoolean(!!m[k].attributes["w:vertCompress"]),combineBrackets:!!m[k]&&this._parseBrackets(m[k].attributes["w:combineBrackets"])};break;case"position":m[k].attributes["w:val"]&&!isNaN(m[k].attributes["w:val"].value)&&(l.options.position={value:m[k].attributes["w:val"].value/2,units:"pt"});break;case"spacing":m[k].attributes["w:line"]&&!isNaN(m[k].attributes["w:line"].value)&&(l.css.lineHeight=this._getLineHeight(m[k].attributes["w:line"].value),l.dimensionCSSRules.minHeight={value:m[k].attributes["w:line"].value/20,units:"pt"}),m[k].attributes["w:before"]&&!isNaN(m[k].attributes["w:before"].value)&&(l.dimensionCSSRules.marginTop={value:m[k].attributes["w:before"].value/20,units:"pt"}),m[k].attributes["w:after"]&&!isNaN(m[k].attributes["w:after"].value)&&(l.dimensionCSSRules.marginBottom={value:m[k].attributes["w:after"].value/20,units:"pt"});break;case"kern":m[k]&&!isNaN(m[k].attributes["w:val"])&&(l.dimensionCSSRules.letterSpacing={value:m[k].attributes["w:val"].value/20,units:"pt"});break;case"rStyle":m[k].attributes["w:val"]&&d.deepMerge(l,this._parseTextDocumentReferenceStyle(m[k].attributes["w:val"].value));break;case"w":l.options.textScale=m[k].attributes["w:val"]&&!isNaN(m[k].attributes["w:val"].value)?+m[k].attributes["w:val"].value:l.options.textScale;break;case"em":l.options.emphasis=this._parseEmphasis(m[k].attributes["w:val"]);break;case"highlight":l.options.highlight=m[k].attributes["w:val"]?this._normalizeColorValue(m[k].attributes["w:val"].value):l.options.highlight;break;case"bdr":l.options.textBorder={color:m[k].attributes["w:color"]&&this._normalizeColorValue(m[k].attributes["w:color"].value)||"",themeColor:m[k].attributes["w:themeColor"]&&this._normalizeColorValue(m[k].attributes["w:themeColor"].value)||"",shadow:this._attributeToBoolean(m[k].attributes["w:shadow"]),frame:this._attributeToBoolean(m[k].attributes["w:frame"])},m[k].attributes["w:sz"]&&!isNaN(m[k].attributes["w:sz"].value)&&(l.options.textBorder.width={value:m[k].attributes["w:sz"].value/8,units:"pt"});break;case"keepNext":l.options.keepNext=m[k]?this._attributeToBoolean(m[k].attributes["w:val"]):!1;break;case"outlineLvl":l.options.outlineLevel=m[k]&&m[k].attributes["w:val"]&&!isNaN(m[k].attributes["w:val"].value)?+m[k].attributes["w:val"].value:0;break;case"numPr":c=m[k].querySelector("numId"),f=m[k].querySelector("ilvl"),l.options.numbering={id:c&&c.attributes["w:val"]&&!isNaN(c.attributes["w:val"].value)?+c.attributes["w:val"].value:0,level:f&&f.attributes["w:val"]&&!isNaN(f.attributes["w:val"].value)?+f.attributes["w:val"].value:0};break;case"tblBorders":d.deepMerge(l,this._parseTableBorderStyle({node:m[k]})),g=m[k].querySelector("insideH"),h=m[k].querySelector("insideV"),i=g?this._parseTableBorderProperties(g):null,j=h?this._parseTableBorderProperties(h):null,(i||j)&&(l.cellsStyleProperties={css:{}},j&&(l.cellsStyleProperties.css.borderRightWidth=j.width,l.cellsStyleProperties.css.borderRightColor=j.color,l.cellsStyleProperties.css.borderRightStyle=j.style),i&&(l.cellsStyleProperties.css.borderBottomWidth=i.width,l.cellsStyleProperties.css.borderBottomColor=i.color,l.cellsStyleProperties.css.borderBottomStyle=i.style));break;case"lang":l.options.language=this._parseLanguageNode(m[k])}return l},_parseApplicationInfo:function(a){var b,c={template:"",totalTime:0,pagesCount:0,wordsCount:0,characters:0,charactersWithSpaces:0,application:"",security:0,linesCount:0,scaleCrop:!1,linksUpToDateCrop:!1,hyperlinksChanged:!1,company:"",version:"",isShared:!1},e=d.DOM.children(a);for(b=e.length-1;b>=0;b--)switch(e[b].localName){case"Template":c.template=e[b].textContent||"";break;case"TotalTime":c.totalTime=+(e[b].textContent||0);break;case"Pages":c.pagesCount=+(e[b].textContent||0);break;case"Words":c.wordsCount=+(e[b].textContent||0);break;case"Characters":c.characters=+(e[b].textContent||0);break;case"CharactersWithSpaces":c.charactersWithSpaces=+(e[b].textContent||0);break;case"DocSecurity":c.security=+(e[b].textContent||0);break;case"Lines":c.linesCount=+(e[b].textContent||0);break;case"Application":c.application=e[b].textContent||"";break;case"Company":c.company=e[b].textContent||"";break;case"AppVersion":c.version=e[b].textContent||"";break;case"ScaleCrop":c.scaleCrop=e[b].textContent||"";break;case"LinksUpToDate":c.linksUpToDateCrop="true"==e[b].textContent;break;case"HyperlinksChanged":c.hyperlinksChanged="true"==e[b].textContent;break;case"SharedDoc":c.isShared="true"==e[b].textContent}return c},_parseDocumentInfo:function(a){var b,c=d.DOM.children(a),e={creator:"",lastModifiedBy:"",revision:0,dateCreated:null,dateModified:null};for(b=c.length-1;b>=0;b--)switch(c[b].localName){case"creator":e.creator=c[b].textContent||"";break;case"lastModifiedBy":e.lastModifiedBy=c[b].textContent||"";break;case"revision":e.revision=+(c[b].textContent||0);break;case"created":e.dateCreated=c[b].textContent?new Date(c[b].textContent):null;break;case"modified":e.dateModified=c[b].textContent?new Date(c[b].textContent):null}return e},_parseDocumentTheme:function(a){var b,c,e,f,g=a.querySelector("themeElements"),h={css:{}};if(g)for(b=d.DOM.children(g),c=b.length-1;c>=0;c--)if("fontScheme"==b[c].localName){f=b[c].querySelector("minorFont"),e=f.querySelector("latin"),e&&e.attributes.typeface&&e.attributes.typeface.value&&(h.css.fontFamily=e.attributes.typeface.value),f=b[c].querySelector("majorFont"),e=f.querySelector("latin"),e&&e.attributes.typeface&&e.attributes.typeface.value&&(h.css.fontFamily=e.attributes.typeface.value);break}return h},_parseEmphasis:function(a){var b="";if(a)switch(a.value){case"dot":b="dotted";break;case"comma":b="comma";break;case"circle":b="circle";break;case"underDot":b="underDotted"}return b},_parseFontsInfo:function(a){var b,c,e,f,g,h,i,j=a.childNodes[0]?d.DOM.children(a.childNodes[0]):[],k={},l=this;for(e=j.length-1;e>=0;e--)if(h=j[e].attributes["w:name"],h&&h.value)for(k[h.value]={},i=d.DOM.children(j[e]),g=i.length,f=g-1;f>=0;f--)switch(i[f].localName){case"panose1":i[f].attributes["w:val"]&&i[f].attributes["w:val"].value&&(k[h.value].panose1=i[f].attributes["w:val"].value);break;case"charset":i[f].attributes["w:val"]&&i[f].attributes["w:val"].value&&(k[h.value].charset=i[f].attributes["w:val"].value);break;case"family":i[f].attributes["w:val"]&&i[f].attributes["w:val"].value&&(k[h.value].family=i[f].attributes["w:val"].value);break;case"pitch":i[f].attributes["w:val"]&&i[f].attributes["w:val"].value&&(k[h.value].pitch=i[f].attributes["w:val"].value);break;case"sig":for(k[h.value].signature={},b=i[f].attributes.length,c=0;b>c;c++)i[f].attributes[c]&&i[f].attributes[c].value&&(k[h.value].signature[l._replaceAttributeNamespace(i[f].attributes[c].name)]=i[f].attributes[c].value)}return k},_parseRelations:function(a){var b,c,e,f,g=a.childNodes[0]?d.DOM.children(a.childNodes[0]):[],h={};for(b=g.length-1;b>=0;b--)g[b].attributes&&(c=g[b].attributes.Id,e=g[b].attributes.Type,f=g[b].attributes.Target,c&&e&&f&&(h[c.value]={id:c.value||"",type:e.value||"",target:f.value||""}));return h},_parseRunNode:function(a){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=d.deepMerge({},{css:d.clone(a.documentData.styles.defaults.paragraphContent.css),dimensionCSSRules:d.clone(a.documentData.styles.defaults.paragraphContent.dimensionCSSRules),options:{elementHeight:{value:0,units:"pt"}},attributes:{},properties:{}},a.cssRules),y=a.node.querySelector("rPr"),z=null,A=a.node.querySelector("drawing"),B=a.node.querySelector("pict"),C=a.node.attributes.length,D={},E=null,F=0;for(v=0;C>v;v++)a.node.attributes[v].value&&(x[this._replaceAttributeNamespace(a.node.attributes[v].name)]=isNaN(a.node.attributes[v].value)?a.node.attributes[v].value:+a.node.attributes[v].value);if(y&&(t=this._getTextDocumentStyleProperties({node:y,documentData:a.documentData}),d.deepMerge(x.css,t.css),d.deepMerge(x.dimensionCSSRules,t.dimensionCSSRules)),B){if(b=B.querySelector("group"))for(d.deepMerge(x,{css:{},dimensionCSSRules:{},parts:[],options:{isSchema:!0}}),b.attributes.style&&b.attributes.style.value&&(d.deepMerge(x,this._parseStyleAttribute(b.attributes.style.value)),delete x.dimensionCSSRules.margin),x.css.margin="auto",x.css.position="relative",x.css.overflow="hidden",x.css.textIndent=0,x.dimensionCSSRules.height&&(x.options.elementHeight.value=x.dimensionCSSRules.height.value),D={},E=null,u=d.DOM.children(b),C=u.length,v=0;C>v;v++)switch(D={css:{},dimensionCSSRules:{},attributes:{},elements:[],options:{backgroundRelationID:null}},u[v].localName){case"shape":u[v].attributes.style&&u[v].attributes.style.value&&d.deepMerge(D,this._parseStyleAttribute(u[v].attributes.style.value,{denominator:20})),u[v].attributes.strokeweight&&u[v].attributes.strokeweight.value&&(D.css.borderStyle="solid",D.dimensionCSSRules.borderWidth={value:1,units:"px"},D.css.borderColor="#000000",this._cropUnits(D.css.height)&&(D.css.height=this._cropUnits(D.css.height)-2+"px"),this._cropUnits(D.css.width)&&(D.css.width=this._cropUnits(D.css.width)-2+"px")),E=u[v].querySelector("imagedata"),E&&(E.attributes["o:title"]&&E.attributes["o:title"].value&&(D.attributes.title=E.attributes["o:title"].value),E.attributes["r:id"]&&E.attributes["r:id"].value&&(h=this._getMediaFromRelation({relationId:E.attributes["r:id"].value,documentData:a.documentData}),h&&(D.css.backgroundImage='url("'+h.data+'")',D.css.backgroundRepeat="no-repeat"))),D.css.zIndex=v+2,x.parts.push(D);break;case"rect":if(u[v].attributes.style&&u[v].attributes.style.value&&d.deepMerge(D,this._parseStyleAttribute(u[v].attributes.style.value,{denominator:20})),u[v].attributes.strokeweight&&u[v].attributes.strokeweight.value&&(D.css.borderStyle="solid",D.dimensionCSSRules.borderWidth={value:1,units:"px"},D.css.borderColor="#000000",this._cropUnits(D.css.height)&&(D.dimensionCSSRules.height={value:this._cropUnits(D.css.height)-2,units:"px"}),this._cropUnits(D.css.width)&&(D.dimensionCSSRules.width={value:this._cropUnits(D.css.width)-2,units:"px"})),f=u[v].querySelector("textbox"),f&&(s=f.querySelector("txbxContent")))for(c=d.DOM.children(s),e=c.length,w=0;e>w;w++)"p"===c[w].localName&&D.elements.push(this._parseTextDocumentParagraphNode({node:c[w],cssRules:{css:{wordWrap:"normal",wordBreak:"normal",width:"auto"}},documentData:a.documentData}));D.css.zIndex=v+2,x.parts.push(D)}}else if(A){if(i=A.querySelector("inline"),j=A.querySelector("extent"),k=A.querySelector("positionH"),l=A.querySelector("positionV"),m=A.querySelector("effectExtent"),n=A.querySelector("docPr"),o=A.querySelector("blip"),p=A.querySelector("off"),q=A.querySelector("ext"),r=A.querySelector("prstGeom"),d.deepMerge(x.options,{isImage:!0,isHidden:!1,relationID:"",offset:{},extents:{},shapeType:"",inline:{extent:{},effectExtent:{left:0,top:0,right:0,bottom:0}},nonVisualProperties:{}}),r&&(x.options.shapeType=r.attributes.prst?this._prepareShapeType(r.attributes.prst):""),o&&o.attributes["r:embed"]&&o.attributes["r:embed"].value&&(h=this._getMediaFromRelation({relationId:o.attributes["r:embed"].value,documentData:a.documentData}),h&&(x.attributes.src=h.data)),p&&(isNaN(p.attributes.y)||(x.options.offset.top={value:+p.attributes.y,units:"pt"}),isNaN(p.attributes.x)||(x.options.offset.left={value:+p.attributes.x,units:"pt"})),k&&(F=k.querySelector("posOffset"),x.css.position="absolute",!k.attributes.relativeFrom||"column"!=k.attributes.relativeFrom.value&&"character"!=k.attributes.relativeFrom.value||(x.options.relativeParentPosition=!0),F&&F.textContent&&(x.dimensionCSSRules.left=this._convertEMU(F.textContent))),l&&(F=l.querySelector("posOffset"),x.css.position="absolute",!l.attributes.relativeFrom||"column"!=l.attributes.relativeFrom.value&&"character"!=l.attributes.relativeFrom.value||(x.options.relativeParentPosition=!0),F&&F.textContent&&(x.dimensionCSSRules.top=this._convertEMU(F.textContent))),q&&(isNaN(q.attributes.y)||(x.options.extents.top={value:+q.attributes.y,units:"pt"}),isNaN(q.attributes.x)||(x.options.extents.left={value:+q.attributes.x,units:"pt"})),i)for(C=i.attributes.length,v=0;C>v;v++)i.attributes[v].value&&(x.options.inline[this._replaceAttributeNamespace(i.attributes[v].name)]=isNaN(i.attributes[v].value)?i.attributes[v].value:+i.attributes[v].value);if(n&&(x.attributes.id=n.attributes.id&&n.attributes.id.value||x.attributes.id,x.attributes.name=n.attributes.name&&n.attributes.name.value||x.attributes.name,x.options.isHidden=this._attributeToBoolean(n.attributes.descr),x.attributes.alt=n.attributes.descr&&n.attributes.descr.value||x.attributes.alt),j&&(j.attributes.cy&&!isNaN(j.attributes.cy.value)&&(x.dimensionCSSRules.height=this._convertEMU(j.attributes.cy.value)),j.attributes.cx&&!isNaN(j.attributes.cx.value)&&(x.dimensionCSSRules.width=this._convertEMU(j.attributes.cx.value))),m)for(C=m.attributes.length,v=0;C>v;v++)if(m.attributes[v].value)switch(g=this._replaceAttributeNamespace(m.attributes[v].name)){case"l":isNaN(m.attributes[v].value)||(x.options.inline.effectExtent.left={value:+m.attributes[v].value,units:"pt"});break;case"r":isNaN(m.attributes[v].value)||(x.options.inline.effectExtent.right={value:+m.attributes[v].value,units:"pt"});break;case"b":isNaN(m.attributes[v].value)||(x.options.inline.effectExtent.bottom={value:+m.attributes[v].value,units:"pt"});break;case"top":isNaN(m.attributes[v].value)||(x.options.inline.effectExtent.bottom={value:+m.attributes[v].value,units:"pt"});break;default:x.options.inline.effectExtent[g]=m.attributes[v].value}x.dimensionCSSRules.height&&(x.options.elementHeight.value=x.dimensionCSSRules.height.value)}else z=a.node.querySelector("t"),x.properties.textContent=z?z.textContent||"":"",/^\s+$/.test(x.properties.textContent)&&(x.properties.textContent=x.properties.textContent.replace(/\s/g," "));return x},_parseStyleAttribute:function(a,b){var c,d,e={css:{},dimensionCSSRules:{}},f=0,g=String(a).split(";"),h=g.length;if(a)for(g=String(a).split(";"),h=g.length,c=null,"object"!=typeof b&&(b={}),isNaN(b.denominator)&&(b.denominator=1),f=0;h>f;f++)c=g[f].split(":"),d=c[0],"width"===d||"height"===d||"left"===d||"top"===d?e.dimensionCSSRules[d]={value:this._cropUnits(c[1].trim())/b.denominator,units:"pt"}:("visibility"===d||"position"===d)&&(e.css[d]=c[1].trim());return e},_parseTableBorderProperties:function(a){var b=a.attributes["w:color"]&&a.attributes["w:color"].value?a.attributes["w:color"].value:"";return{width:a.attributes["w:sz"]&&!isNaN(a.attributes["w:sz"].value)?{value:a.attributes["w:sz"].value/8,units:"pt"}:0,style:"solid",color:this._normalizeColorValue(b)}},_parseTableBorderStyle:function(a){var b,c,e,f={css:{},dimensionCSSRules:{}},g=d.DOM.children(a.node);for(b=g.length-1;b>=0;b--)["top","left","right","bottom"].indexOf(g[b].localName)>=0&&(e=g[b].localName.charAt(0).toUpperCase()+g[b].localName.slice(1),c=this._parseTableBorderProperties(g[b]),f.dimensionCSSRules["border"+e+"Width"]=c.width,f.css["border"+e+"Style"]=c.style,f.css["border"+e+"TopColor"]=c.color);return f},_parseTableElementWidth:function(a){var b={value:100,units:"%"},c=a.attributes["w:type"]&&a.attributes["w:type"].value&&"nil"!=a.attributes["w:type"]?a.attributes["w:type"].value:null,d=a.attributes["w:w"]&&!isNaN(a.attributes["w:w"].value)?+a.attributes["w:w"].value:0;return c&&d&&("pct"===c?b={value:d,units:"%"}:"dxa"===c&&(b={value:d/20,units:"pt"})),b},_parseTextDocumentContent:function(a){a.documentData._heading=[];var b,c,e,f,g,h,i,j={pages:[]},k={css:{},dimensionCSSRules:{},options:{pageIndex:0,pageNumber:null,header:{css:{},dimensionCSSRules:{}},footer:{css:{},dimensionCSSRules:{}},columns:{equalWidth:!1,space:0,number:0,separated:!1}}},l=this,m=0,n=[],o=0,p=0,q=0,r={},s=null,t=0,u=0,v=a.xml.querySelector("body");if(a.documentData.styles.defaults.options.pageContentWidth={value:0,units:"pt"},v){if(i={chunk:20,time:0,data:d.DOM.children(v),index:0},i.len=i.data.length,i.all=i.len,f=i.data[i.len-1],"sectPr"===f.localName){for(i.len--,i.all=i.len,c=d.DOM.children(f),g=c.length,h=g-1;h>=0;h--)switch(c[h].localName){case"pgSz":c[h].attributes["w:w"]&&!isNaN(c[h].attributes["w:w"].value)&&(k.dimensionCSSRules.width={value:c[h].attributes["w:w"].value/20,units:"pt"},a.documentData.styles.defaults.options.pageContentWidth.value+=k.dimensionCSSRules.width.value),c[h].attributes["w:h"]&&!isNaN(c[h].attributes["w:h"].value)&&(k.dimensionCSSRules.height={value:+c[h].attributes["w:h"].value/20,units:"pt"},u+=k.dimensionCSSRules.height.value);break;case"pgMar":c[h].attributes["w:top"]&&!isNaN(c[h].attributes["w:top"].value)&&(k.dimensionCSSRules.paddingTop={value:c[h].attributes["w:top"].value/20,units:"pt"},u-=k.dimensionCSSRules.paddingTop.value),c[h].attributes["w:left"]&&!isNaN(c[h].attributes["w:left"].value)&&(k.dimensionCSSRules.paddingLeft={value:c[h].attributes["w:left"].value/20,units:"pt"},a.documentData.styles.defaults.options.pageContentWidth.value-=k.dimensionCSSRules.paddingLeft.value),c[h].attributes["w:right"]&&!isNaN(c[h].attributes["w:right"].value)&&(k.dimensionCSSRules.paddingRight={value:c[h].attributes["w:right"].value/20,units:"pt"},a.documentData.styles.defaults.options.pageContentWidth.value-=k.dimensionCSSRules.paddingRight.value),c[h].attributes["w:bottom"]&&!isNaN(c[h].attributes["w:bottom"].value)&&(k.dimensionCSSRules.paddingBottom={value:c[h].attributes["w:bottom"].value/20,units:"pt"},u-=k.dimensionCSSRules.paddingBottom.value),k.options.pageNumber&&c[h].attributes["w:header"]&&!isNaN(c[h].attributes["w:header"].value)&&(k.options.header.dimensionCSSRules.height={value:c[h].attributes["w:header"].value/20,units:"pt"}),c[h].attributes["w:footer"]&&!isNaN(c[h].attributes["w:footer"].value)&&(k.options.footer.dimensionCSSRules.height={value:c[h].attributes["w:footer"].value/20,units:"pt"}),c[h].attributes["w:gutter"]&&!isNaN(c[h].attributes["w:gutter"].value)&&(k.dimensionCSSRules.marginTop={value:c[h].attributes["w:gutter"].value/20,units:"pt"});
break;case"pgNumType":k.options.pageNumber={value:0,start:c[h].attributes["w:start"]&&!isNaN(c[h].attributes["w:start"].value)?+c[h].attributes["w:start"].value:1};break;case"cols":k.options.columns.equalWidth=l._attributeToBoolean(c[h].attributes["w:equalWidth"]),k.options.columns.separated=l._attributeToBoolean(c[h].attributes["w:sep"]),k.options.columns.number=c[h].attributes["w:num"]&&!isNaN(c[h].attributes["w:num"])?+c[h].attributes["w:num"]:k.options.columns.number,k.options.columns.space=c[h].attributes["w:space"]&&!isNaN(c[h].attributes["w:space"].value)?{value:+c[h].attributes["w:space"].value/20,units:"pt"}:k.options.columns.space;break;case"docGrid":c[h].attributes["w:linePitch"]&&!isNaN(c[h].attributes["w:linePitch"].value)&&(a.documentData.styles.defaults.options.linePitch={value:c[h].attributes["w:linePitch"].value/20,units:"pt"})}for(p=f.attributes.length,m=0;p>m;m++)f.attributes[m].value&&(k.options[l._replaceAttributeNamespace(f.attributes[m].name)]=isNaN(f.attributes[m].value)?f.attributes[m].value:+f.attributes[m].value)}b=function(c){c.end=c.index+(c.all>c.chunk?c.chunk:c.all),setTimeout(function(){for(c.index;c.index<c.end;c.index++)"p"===c.data[c.index].localName?(t=0,r=l._parseTextDocumentParagraphNode({node:c.data[c.index],documentData:a.documentData}),r.options.isListItem?(s||(s={options:{isList:!0},dimensionCSSRules:{padding:{value:0,units:"pt"},margin:{value:0,units:"pt"}},items:[]}),r.dimensionCSSRules.paddingLeft&&(s.dimensionCSSRules.paddingLeft=r.dimensionCSSRules.paddingLeft,delete r.dimensionCSSRules.paddingLeft),r.dimensionCSSRules.marginLeft&&(s.dimensionCSSRules.marginLeft=r.dimensionCSSRules.marginLeft,delete r.dimensionCSSRules.marginLeft),t+=r.options.elementHeight.value,s.items.push(r)):(s||(t=r.options.elementHeight.value),o=l._checkPageLinesHeight({pageOptions:k,pageHeight:u,lineHeight:t,pages:j.pages,pageLinesHeight:o,pageElements:n}),o||(k.options.pageIndex++,n=[]),s?(n.push(s),s=null):n.push(r),o+=t),q++):"tbl"===c.data[c.index].localName?l._parseTextDocumentTableNode({tableNode:c.data[c.index],documentData:a.documentData},function(a){return t=r.options.elementHeight.value,o=l._checkPageLinesHeight({pageOptions:k,pageHeight:u,lineHeight:t,pages:j.pages,pageLinesHeight:o,pageElements:n}),o||(k.options.pageIndex++,n=[]),n.push(a),o+=t,q++,!1}):q++,q>=c.len&&(e=k,e.elements=n,j.pages.push(e),"function"==typeof a.callback&&a.callback(j));return c.all=c.len-c.end,c.index<c.len&&b.call(l,c),!0},c.time)},b.call(l,i)}else"function"==typeof a.callback&&a.callback(j);return null},_parseTextDocumentParagraphNode:function(a){var b,c,e,f,g,h,i,j,k,l,m,n,o,p={options:{isParagraph:!0,pageBreak:!1,elementHeight:{value:a.documentData.styles.defaults.options.linePitch?a.documentData.styles.defaults.options.linePitch.value:0,units:"pt"}},attributes:{},css:d.deepMerge({},a.documentData.styles.defaults.paragraph.css,a.cssRules?a.cssRules.css:{}),dimensionCSSRules:d.deepMerge({},a.documentData.styles.defaults.paragraph.dimensionCSSRules,a.cssRules?a.cssRules.dimensionCSSRules:{}),elements:[]},q={value:14,units:"pt"},r={value:q.value/2,units:"pt"},s=0,t=d.DOM.children(a.node),u=0,v=a.node.attributes.length;for(f=0;v>f;f++)a.node.attributes[f].value&&(p[this._replaceAttributeNamespace(a.node.attributes[f].name)]=isNaN(a.node.attributes[f].value)?a.node.attributes[f].value:+a.node.attributes[f].value);for(v=t.length,m=0;v>m;m++)switch(t[m].localName){case"bookmarkStart":t[m].attributes["w:name"]&&t[m].attributes["w:name"].value&&p.elements.push({options:{isLink:!0},attributes:{name:t[m].attributes["w:name"].value}});break;case"pPr":n=this._getTextDocumentStyleProperties({node:t[m],documentData:a.documentData}),n.options.isListItem&&(p.options.isParagraph=!1,p.options.isListItem=!0,p.css={},p.dimensionCSSRules={}),d.deepMerge(p.css,n.css),d.deepMerge(p.dimensionCSSRules,n.dimensionCSSRules),d.deepMerge(p.attributes,n.attributes),p.options.childrenCSSRules=n.options.childrenCSSRules,p.dimensionCSSRules.height&&(p.options.elementHeight.value=p.dimensionCSSRules.height.value),p.dimensionCSSRules.minHeight&&p.dimensionCSSRules.minHeight.value>p.options.elementHeight.value&&(p.options.elementHeight.value=p.dimensionCSSRules.minHeight.value);break;case"hyperlink":for(b=d.DOM.children(t[m]),o=b.length,g="#",h=t[m].attributes["r:id"]?this._getRelation({relationId:t[m].attributes["r:id"].value,documentData:a.documentData}):null,e={options:{isLink:!0},css:{color:"#0000EE"},attributes:{},elements:[]},f=0;o>f;f++)c=this._parseRunNode({node:b[f],cssRules:p.options.childrenCSSRules,documentData:a.documentData}),c.css.color="",c.dimensionCSSRules.fontSize&&c.dimensionCSSRules.fontSize.value>s&&(s=c.dimensionCSSRules.fontSize.value),u+=c.properties.textContent?c.properties.textContent.length*(c.dimensionCSSRules.fontSize?c.dimensionCSSRules.fontSize.value/q.value:1):0,e.elements.push(c);h?(g=h.target,e.attributes.target="_blank"):g+=t[m].attributes["w:anchor"]&&t[m].attributes["w:anchor"].value||"",e.attributes.href=g,p.elements.push(e);break;case"r":j=this._parseRunNode({node:t[m],cssRules:p.options.childrenCSSRules,documentData:a.documentData}),u+=j.properties.textContent?j.properties.textContent.length*(j.dimensionCSSRules.fontSize?j.dimensionCSSRules.fontSize.value/q.value:1):0,j.options.elementHeight.value>p.options.elementHeight.value&&(p.options.elementHeight.value=j.options.elementHeight.value),j.dimensionCSSRules.fontSize&&j.dimensionCSSRules.fontSize.value>s&&(s=j.dimensionCSSRules.fontSize.value),p.elements.push(j)}return p.elements[0]&&p.elements[0].options.isImage&&!p.elements[1]&&!p.css.textAlign&&(p.css.textAlign="center"),l=Math.ceil((u*r.value+(p.dimensionCSSRules.textIndent?p.dimensionCSSRules.textIndent.value:0))/(a.documentData.styles.defaults.options.pageContentWidth.value-(p.dimensionCSSRules.paddingLeft?p.dimensionCSSRules.paddingLeft.value:0)-(p.dimensionCSSRules.paddingRight?p.dimensionCSSRules.paddingRight.value:0))),i=p.css.lineHeight?p.css.lineHeight:1,s*=i,1==l&&s>p.options.elementHeight.value?p.options.elementHeight.value=s:(k=l*q.value*i,k>p.options.elementHeight.value&&(p.options.elementHeight.value=k)),p.dimensionCSSRules.marginTop&&(p.options.elementHeight.value+=p.dimensionCSSRules.marginTop.value),p.dimensionCSSRules.marginBottom&&(p.options.elementHeight.value+=p.dimensionCSSRules.marginBottom.value),p.dimensionCSSRules.paddingTop&&(p.options.elementHeight.value+=p.dimensionCSSRules.paddingTop.value),p.dimensionCSSRules.paddingBottom&&(p.options.elementHeight.value+=p.dimensionCSSRules.paddingBottom.value),p},_parseTextDocumentReferenceStyle:function(a){var b={css:{},dimensionCSSRules:{}};return a=a?a.toLowerCase():a,"strong"===a&&(b.css.fontWeight="bold"),b},_parseTextDocumentSettings:function(a){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q={zoom:100,compat:{},rsids:{rsidRoot:"",values:[]},mathProperties:{},shapeDefaults:{defaults:{},layout:{}},colorSchemeMapping:{}},r=0,s=this,t=d.DOM.children(a),u=t.length,v=null;for(b=u-1;b>=0;b--)switch(t[b].localName){case"zoom":q.zoom=!t[b].attributes["w:percent"]||isNaN(t[b].attributes["w:percent"].value)?100:+t[b].attributes["w:percent"].value;break;case"proofState":q.checkSpelling=t[b].attributes["w:spelling"]&&"clean"==t[b].attributes["w:spelling"].value,q.checkGrammar=t[b].attributes["w:grammar"]&&"clean"==t[b].attributes["w:grammar"].value;break;case"defaultTabStop":q.defaultTabStop=t[b].attributes["w:val"]&&!isNaN(t[b].attributes["w:val"].value)?+t[b].attributes["w:val"].value:1;break;case"characterSpacingControl":q.controlCharacterSpacing=!(!t[b].attributes["w:val"]||"doNotCompress"==t[b].children[b].attributes["w:val"].value);break;case"compat":for(e=t[b].querySelectorAll("compatSetting"),r=e.length,b=0;r>b;b++)g=e[b].attributes["w:name"],h=e[b].attributes["w:uri"],o=e[b].attributes["w:val"],g&&g.value&&(q.compat[g.value]={uri:h?h.value||"":"",value:!o||isNaN(o.value)?0:+o.value});break;case"shapeDefaults":n=t[b].querySelector("shapedefaults"),p=t[b].querySelector("shapelayout"),n&&(v=n.attributes["v:ext"],i=n.attributes.spidmax,j=n.attributes.style,q.shapeDefaults.defaults.ext=v?v.value||"":"",q.shapeDefaults.defaults.style=j?j.value||"":"",q.shapeDefaults.defaults.spidMax=!i||isNaN(i.value)?0:+i.value),p&&(v=p.attributes["v:ext"],f=p.querySelector("idmap"),q.shapeDefaults.layout.ext=v?v.value||"":"",q.shapeDefaults.layout.idMap={},f&&(v=f.attributes["v:ext"],k=f.attributes.data,q.shapeDefaults.layout.idMap.ext=v?v.value||"":"",q.shapeDefaults.layout.idMap.data=!k||isNaN(k.value)?0:+k.value));break;case"themeFontLang":q.themeFontLanguage=this._parseLanguageNode(t[b]);break;case"decimalSymbol":q.decimalSymbol=t[b].attributes["w:val"]?t[b].attributes["w:val"].value||"":"";break;case"listSeparator":q.listSeparator=t[b].attributes["w:val"]?t[b].attributes["w:val"].value||"":"";break;case"clrSchemeMapping":for(r=t[b].attributes.length,b=0;r>b;b++)t[b].attributes[b]&&t[b].attributes[b].value&&(q.colorSchemeMapping[s._replaceAttributeNamespace(t[b].attributes[b].name)]=t[b].attributes[b].value);break;case"rsids":for(l=t[b].querySelector("rsidRoot"),m=t[b].querySelectorAll("rsid"),q.rsids.rsidRoot=l.attributes["w:val"]?l.attributes["w:val"].value||"":"",r=m.length,b=0;r>b;b++)o=m[b].attributes["w:val"],o&&o.value&&q.rsids.values.push(o.value);break;case"mathPr":for(c=d.DOM.children(t[b]),r=c.length,q.mathProperties.intLimit="",b=r-1;b>=0;b--)switch(c[b].localName){case"mathFont":q.mathProperties.mathFont=c[b].attributes["m:val"]?c[b].attributes["m:val"].value||"":"";break;case"brkBin":q.mathProperties.breakOnBinary=c[b].attributes["m:val"]?c[b].attributes["m:val"].value||"":"";break;case"brkBinSub":q.mathProperties.breakOnBinarySubtraction=c[b].attributes["m:val"]?c[b].attributes["m:val"].value||"":"";break;case"smallFrac":q.mathProperties.onSmallFraction=!!c[b].attributes["m:val"]&&"0"!=c[b].attributes["m:val"].value;break;case"dispDef":q.mathProperties.displayDefault=!!c[b].attributes["m:val"]&&"0"!=c[b].attributes["m:val"].value;break;case"lMargin":q.mathProperties.leftMargin=c[b].attributes["m:val"]&&!isNaN(c[b].attributes["m:val"].value)?+c[b].attributes["m:val"].value:0;break;case"rMargin":q.mathProperties.rightMargin=c[b].attributes["m:val"]&&!isNaN(c[b].attributes["m:val"].value)?+c[b].attributes["m:val"].value:0;break;case"defJc":q.mathProperties.align=c[b].attributes["m:val"]?c[b].attributes["m:val"].value:"left","centerGroup"==q.mathProperties.align&&(q.mathProperties.align="center");break;case"preSp":q.mathProperties.preSpacing=c[b].attributes["m:val"]&&!isNaN(c[b].attributes["m:val"].value)?+c[b].attributes["m:val"].value:0;break;case"postSp":q.mathProperties.postSpacing=c[b].attributes["m:val"]&&!isNaN(c[b].attributes["m:val"].value)?0:+c[b].attributes["m:val"].value;break;case"interSp":q.mathProperties.interSpacing=c[b].attributes["m:val"]&&!isNaN(c[b].attributes["m:val"].value)?0:+c[b].attributes["m:val"].value;break;case"intraSp":q.mathProperties.intraSpacing=c[b].attributes["m:val"]&&!isNaN(c[b].attributes["m:val"].value)?0:+c[b].attributes["m:val"].value;break;case"wrapIndent":q.mathProperties.wrapIndent=c[b].attributes["m:val"]&&!isNaN(c[b].attributes["m:val"].value)?0:+c[b].attributes["m:val"].value;break;case"wrapRight":q.mathProperties.wrapRight=c[b].attributes["m:val"]&&!isNaN(c[b].attributes["m:val"].value)?0:+c[b].attributes["m:val"].value;break;case"intLim":q.mathProperties.intLimit=c[b].attributes["m:val"]&&"undOvr"==c[b].attributes["m:val"].value?"UnderOverLocation":c[b].attributes["m:val"]&&"subSup"==c[b].attributes["m:val"].value?"SubscriptSuperscriptLocation":"";break;case"naryLim":q.mathProperties.naryLimit=c[b].attributes["m:val"]&&"undOvr"==c[b].attributes["m:val"].value?"UnderOverLocation":c[b].attributes["m:val"]&&"subSup"==c[b].attributes["m:val"].value?"SubscriptSuperscriptLocation":""}}return q},_parseTextDocumentStyles:function(a){var b,c,e,f,g,h,i,j,k,l,m={defaults:{paragraph:{dimensionCSSRules:{margin:{value:0,units:"pt"},padding:{value:0,units:"pt"}},css:{wordWrap:"break-word",wordBreak:"break-all",width:"100%"}},paragraphContent:{},options:{}},latentStyles:{exceptions:{}},preferencedStyles:{}},n=this,o=d.DOM.children(a.querySelector("styles")),p=0,q=0;for(b=o.length-1;b>=0;b--)if("docDefaults"===o[b].localName)k=o[b].querySelector("rPrDefault rPr"),l=o[b].querySelector("pPrDefault pPr"),k&&(m.defaults.paragraphContent=this._getTextDocumentStyleProperties({node:k,documentData:null})),l&&d.deepMerge(m.defaults.paragraph,this._getTextDocumentStyleProperties({node:l,documentData:null}));else if("latentStyles"===o[b].localName){for(j=o[b].querySelectorAll("lsdException")||[],c="",e={},i=o[b].attributes.length,h=0,p=0;i>p;p++)m.latentStyles[n._replaceAttributeNamespace(o[b].attributes[p].name)]=isNaN(o[b].attributes[p].value)?o[b].attributes[p].value||"":+o[b].attributes[p].value;for(i=j.length,p=0;i>p;p++)for(c="",e={},h=j[p].attributes.length,q=0;h>q;q++)"name"==n._replaceAttributeNamespace(j[b].attributes[q].name)&&(c=n._replaceAttributeNamespace(j[b].attributes[q].name),m.latentStyles.exceptions[c]=e),c?m.latentStyles.exceptions[c][n._replaceAttributeNamespace(j[b].attributes[q].name)]=isNaN(j[b].attributes[q].value)?j[b].attributes[q].value||"":+j[b].attributes[q].value:e[n._replaceAttributeNamespace(j[b].attributes[q].name)]=isNaN(j[b].attributes[q].value)?j[b].attributes[q].value||"":+j[b].attributes[q].value}else"style"===o[b].localName&&o[b].attributes["w:styleId"]&&o[b].attributes["w:styleId"].value&&(m.preferencedStyles[o[b].attributes["w:styleId"].value]={contentProperties:{},isDefault:this._attributeToBoolean(o[b].attributes["w:default"])},f=o[b].querySelector("pPr"),f&&(m.preferencedStyles[o[b].attributes["w:styleId"].value].lineStyle=this._getTextDocumentStyleProperties({node:f,documentData:null})),f=o[b].querySelector("rPr"),f&&(m.preferencedStyles[o[b].attributes["w:styleId"].value].contentProperties=this._getTextDocumentStyleProperties({node:f,documentData:null})),f=o[b].querySelector("tblPr"),f&&(m.preferencedStyles[o[b].attributes["w:styleId"].value].tableStyle=this._getTextDocumentStyleProperties({node:f,documentData:null})),m.preferencedStyles[o[b].attributes["w:styleId"].value].type=o[b].attributes["w:type"]&&o[b].attributes["w:type"].value?o[b].attributes["w:type"].value:"",g=o[b].querySelector("name"),g&&g.attributes["w:val"]&&g.attributes["w:val"].value&&(m.preferencedStyles[o[b].attributes["w:styleId"].value].name=g.attributes["w:val"].value),g=o[b].querySelector("rsid"),g&&g.attributes["w:val"]&&g.attributes["w:val"].value&&(m.preferencedStyles[o[b].attributes["w:styleId"].value].rsid=g.attributes["w:val"].value),g=o[b].querySelector("basedOn"),g&&g.attributes["w:val"]&&g.attributes["w:val"].value&&(m.preferencedStyles[o[b].attributes["w:styleId"].value].parentStyleId=g.attributes["w:val"].value),g=o[b].querySelector("next"),g&&g.attributes["w:val"]&&g.attributes["w:val"].value&&(m.preferencedStyles[o[b].attributes["w:styleId"].value].nextElementStyle=g.attributes["w:val"].value),g=o[b].querySelector("uiPriority"),g&&g.attributes["w:val"]&&g.attributes["w:val"].value&&(m.preferencedStyles[o[b].attributes["w:styleId"].value].uiPriority=+g.attributes["w:val"].value),g=o[b].querySelector("link"),g&&g.attributes["w:val"]&&g.attributes["w:val"].value&&(m.preferencedStyles[o[b].attributes["w:styleId"].value].linkedStyle=g.attributes["w:val"].value),g=o[b].querySelector("unhideWhenUsed"),m.preferencedStyles[o[b].attributes["w:styleId"].value].unHideWhenUsed=g?this._attributeToBoolean(g.attributes["w:val"]):!1,g=o[b].querySelector("qFormat"),m.preferencedStyles[o[b].attributes["w:styleId"].value].isPrimary=g?this._attributeToBoolean(g.attributes["w:val"]):!1);return m},_parseTextDocumentTableNode:function(a,b){var c,e,f,g,h,i,j,k,l={options:{isTable:!0,elementHeight:{value:0,units:"pt"}},header:{rows:[]},body:{rows:[]},footer:{rows:[]},attributes:{},dimensionCSSRules:{},css:{}},m=0,n=0,o=0,p=d.DOM.children(a.tableNode),q=0,r=0,s=null,t=[],u=0,v=null,w=null,x=null,y=null;for(e=0;e<p.length;e++)switch(y=d.DOM.children(p[e]),p[e].localName){case"tr":for(i=v?this._parseTableBorderProperties(v):null,j=w?this._parseTableBorderProperties(w):null,g={cells:[],css:{},options:{colsWidth:[]},dimensionCSSRules:{}},o=y.length,m=0;o>m;m++)if(x=d.DOM.children(y[m]),"tc"===y[m].localName){for(h={css:{},dimensionCSSRules:{},options:{},elements:[]},t=y[m].querySelectorAll("p"),u=x.length,c&&c.tableStyle&&c.tableStyle.cellsStyleProperties&&d.deepMerge(l,c.tableStyle.cellsStyleProperties),j&&(h.dimensionCSSRules.borderRightWidth=j.width,h.css.borderRightColor=j.color,h.css.borderRightStyle=j.style),i&&(h.dimensionCSSRules.borderBottomWidth=i.width,h.css.borderBottomColor=i.color,h.css.borderBottomStyle=i.style),n=0;u>n;n++)"tcPr"==x[n].localName?(r=x[n].querySelector("tcW"),s=x[n].querySelector("shd"),r&&(h.dimensionCSSRules.width=this._parseTableElementWidth(r)),s&&s.attributes["w:fill"]&&s.attributes["w:fill"].value&&"auto"!=s.attributes["w:fill"].value&&(h.css.backgroundColor=this._normalizeColorValue(s.attributes["w:fill"].value))):"p"==x[n].localName&&h.elements.push(this._parseTextDocumentParagraphNode({node:x[n],documentData:a.documentData}));g.cells.push(h)}else if("trPr"===y[m].localName)for(k=x.length,n=0;k>n;n++)"trHeight"===x[n].localName&&x[n].attributes["w:val"]&&!isNaN(x[n].attributes["w:val"].value)&&(g.dimensionCSSRules.height={value:x[n].attributes["w:val"].value/20,units:"pt"});l.body.rows.push(g);break;case"tblGrid":for(q=y.length,m=0;q>m;m++)"gridCol"===y[m]&&y[m].attributes["w:w"]&&!isNaN(y[m].attributes["w:w"].value)&&l.options.colsWidth.push({value:y[m].attributes["w:w"].value,units:"pt"});break;case"tblPr":var z=p[e].querySelector("tblW"),A=p[e].querySelector("tblStyle");A&&A.attributes["w:val"]&&A.attributes["w:val"].value&&a.documentData.styles.preferencedStyles[A.attributes["w:val"].value]&&(c=a.documentData.styles.preferencedStyles[A.attributes["w:val"].value],c&&c.tableStyle&&d.deepMerge(l,c.tableStyle));var B=p[e].querySelector("tblBorders");z&&(l.dimensionCSSRules.width=this._parseTableElementWidth(z)),B&&(d.deepMerge(l,this._parseTableBorderStyle({node:B})),v=B.querySelector("insideH"),w=B.querySelector("insideV"))}if(o=l.body.rows.length,g=l.body.rows[o-1])for(f=g.cells.length,m=0;f>m;m++)g.cells[m].dimensionCSSRules.borderBottomWidth="",g.cells[m].css.borderBottomStyle="",g.cells[m].css.borderBottomColor="";for(m=0;o>m;m++)f=l.body.rows[m].cells.length,h=l.body.rows[m].cells[f-1],h&&(h.dimensionCSSRules.borderRightWidth="",h.css.borderRightStyle="",h.css.borderRightColor="");return"function"==typeof b&&b(l),!0},_parseWebSettings:function(a){var b,c=d.DOM.children(a),e={optimizeForBrowser:!1,allowPNG:!1};for(b=c.length-1;b>=0;b--)"optimizeForBrowser"===c[b].localName?e.optimizeForBrowser=!(!c[b].attributes["w:val"]||!this._attributeToBoolean(c[b].attributes["w:val"].value)):"allowPNG"===c[b].localName&&(e.allowPNG=!(!c[b].attributes["w:val"]||!this._attributeToBoolean(c[b].attributes["w:val"].value)));return e},_prepareShapeType:function(a){var b="";if("string"!=typeof a)return"";switch(a){case"line":case"lineInv":b="line";break;case"triangle":case"rtTriangle":b="triangle";break;case"rect":b="rectangle";break;case"diamond":b="diamond";break;case"parallelogram":b="parallelogram";break;case"pentagon":b="pentagon";break;case"hexagon":b="hexagon";break;case"heptagon":b="heptagon";break;case"octagon":b="octagon";break;case"ellipse":b="ellipse";break;case"decagon":b="decagon";break;case"dodecagon":b="dodecagon";break;case"plaque":b="plaque";break;case"trapezoid":case"nonIsoscelesTrapezoid":b="trapezoid";break;default:b="rectangle"}return b}}),d.Engines.Simple=d.Engine.extend({_createParsedFile:function(a,b){var c,e,f,g,h,i,j=!1,k=[];for(g=a.split(/\s/),f=g.length,e=0;f>e;e++)g[e]&&(j=d.validateURL(g[e]),i={options:{},css:{},attributes:{},properties:{textContent:g[e]+" "}},j&&(h=g[e].replace(/\S+/g,"")+" ",c=g[e].replace(/\s+/,""),i.isLink=!0,i.href=c,i.properties.textContent=c,i.after=h),k.push(i));"function"==typeof b&&b(new d.ParsedFile({pages:[{options:{},css:{},elements:[{options:{isParagraph:!0},css:{},elements:[{options:{},css:{},elements:k}]}]}]}))},_fileTypeParsers:[{extension:["txt"],mime:["text/plain"],isTextDocument:!0}],parse:function(a){var b,c;return"function"==typeof a.start&&a.start(),this.validate()?(b=new FileReader,c=this,b.onload=function(b){c._createParsedFile(b.target.result,function(b){"function"==typeof a.success&&a.success(b),"function"==typeof a.complete&&a.complete()})},b.readAsText(this.file)):("function"==typeof a.error&&a.error(this._errors.invalidFileType),"function"==typeof a.complete&&a.complete()),null}}),a.jDoc=d}(window,document);